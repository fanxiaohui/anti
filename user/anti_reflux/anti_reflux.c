/******************************************************************************           
* name:             anti_reflux.c           
* introduce:        anti-reflux 
* author:           Luee                                     
******************************************************************************/ 
#include "fibo_opencpu.h"
#include "r_memory.h"
#include "r_stdlib.h"
#include "Swap.h"

#include "utility.h"
#include "Debug.h"
#include "run_log.h"
#include "SysPara_File.h"
#include "data_collector_parameter_table.h"

#include "grid_tool.h"
#include "anti_reflux.h"
#include "Modbus.h"
#include "ModbusDevice.h"
#include "Protocol.h"
#include "_0409.h"
#include "_040B.h"
#include "MosoAdj.h"
#include "CRC.h"
#include "appTask.h"
#include "ieee754_float.h"
#include "Protocol.h"
#include "char2negative.h"
#include "DeviceIO.h"

#define REALTIME_METER_READ_COUNTER 60     //1m
#define REALTIME_METER_READ_COUNTER_REFLUX 5     //5S anti reflux running
#define METER_OVERTIME  120          //2M


static u8 device_addr=1;
static u8 anti_reflux_en=0;         //=1 anti reflux enables
static u8 anti_refluxing=0;         //=1 anti reflux running
static float anti_threshold=0;      //anti reflux threshold
static u16 counter=REALTIME_METER_READ_COUNTER_REFLUX;

typedef struct {
  u8_t addr;
  u8_t fun;
  u16_t st_addr;
  u16_t num;
  u8_t bytes;
  u16_t payload[];
} modbus_wr2_t;

#pragma pack(1)
typedef struct {
  u8_t addr;
  u8_t fun;
  u16_t st_addr;
  u16_t num;
  u8_t bytes;
  u16_t apowerl;
  u16_t apowerh;
  u16_t bpowerl;
  u16_t bpowerh;
  u16_t cpowerl;
  u16_t cpowerh;
  u16_t totall;
  u16_t totalh;
  u16_t crc16;
} modbus_wr_t;
#pragma pack()

typedef struct {
  u8_t addr;
  u8_t fun;
  u16_t st_addr;
  u16_t num;
  u16_t crc16;
} modbus_wr_response_t;

#pragma pack(1)
typedef struct {
  u8_t addr;
  u8_t fun;
  u16_t st_addr;
  u16_t num;
  u16_t crc16;
} modbus_rd_t;
#pragma pack()

typedef struct {
  u8_t addr;
  u8_t fun;
  u8_t bytes;
  u16_t apowerl;
  u16_t apowerh;
  u16_t bpowerl;
  u16_t bpowerh;
  u16_t cpowerl;
  u16_t cpowerh;
  u16_t totall;
  u16_t totalh;
  u16_t crc16;
} modbus_rd_response_t;

typedef struct {
  u8_t addr;
  u8_t fun;
  u8_t err;
  u16_t crc16;
} modbus_err_t;

//u8_t anti_data[64]={0};
//buf_t *anti_buf=(buf_t *)anti_data;


//////////////////////////////////////
typedef struct
{
    Device_t *dev;
}InvertList_t;

static MeterValue_t meterPower;
static ListHandler_t invertDevice;
static buf_t anti_ack_buf={0};
static u8 online_dev_count=0;
static u8 addr_index=0xff;
static u8 online_dev_addr_tab[64];
static u8 meter_data_sent=0;      //=1 meter data have sent
static u16 meter_overtime=0;


static void Anti_reflux_init(void);
static u8_t checkDeviceOnline(void);
static u8_t ArtiReflux_InvDataAck(Device_t *dev);
static u8_t invterLockStatus(void *load, void *val);
static u8_t invterUnlock(void *load, void *val);
static u8_t ArtiReflux_meterDataAck(Device_t *dev);
static u8_t invterAdd(void *load, void *val);
static u8_t invterRemove(void *load, void *val);
static void deviceDel(Device_t *dev);
static void anti_relex_data_process(void);
void meter_read(void);
static void realtime_meter_read(void);
static u8_t anti_ack(Device_t *dev);
static u8_t anti_trans(u8 *data_ptr ,u8 data_len);
static u8_t meter_trans(u8 *data_ptr ,u8 data_len);
static u8 get_online_count(void);

static const AntiReflux_t *deviceTab[] = {
//static const AntiReflux_t deviceTab[] = {
     &MOSO_0211,
     &MOSO_0212,
     &Device_0409,
     &Device_040B
};



/*******************************************************************************            
* introduce:        
* parameter:                       
* return:                 
* author:           Luee                                                    
*******************************************************************************/
void proc_anti_reflux_task(s32_t taskId)
{
    ST_MSG msg;

    APP_DEBUG("anti-reflux task run!!\r\n");
    Anti_reflux_init();

    while(1){
        //fibo_taskSleep(500);
        fibo_queue_get(ANTI_REFLUX_TASK, (void *)&msg, 0);
        switch (msg.message) {
        case ANTI_REFLUX_DATA_PROCESS:
            anti_relex_data_process();
        break;
        case ANTI_REFLUX_TIMER_ID:
            APP_DEBUG("anti reflux time running\r\n");
            get_online_count();
            //para 96=1,enable anti reflux
            if(anti_reflux_en)
                realtime_meter_read();          
        break;
        }   
    }
    fibo_thread_delete();
}

/*******************************************************************************            
* introduce:        
* parameter:                       
* return:                 
* author:           Luee                                                    
*******************************************************************************/
static u8_t anti_ack(Device_t *dev)
{

    DeviceCmd_t *cmd;
	uint8_t len = 0;
    cmd = (DeviceCmd_t *)dev->cmdList.node->payload;
    APP_DEBUG("anti ack buf:\r\n");
    APP_DEBUG("cmd->ack.payload[0]=%d",cmd->ack.payload[0]);
    //print_buf(cmd->ack.payload, cmd->ack.lenght);
    
    if(cmd->ack.payload[0]==METER_ADDR){
        //闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧湱鈧懓瀚崳纾嬨亹閹烘垹鍊炲銈嗗坊閸嬫挻娼诲┑瀣拺闂侇偆鍋涢懟顖涙櫠閹绢喗鐓涢悘鐐插⒔閵嗘帡鏌嶈閸撱劎绱為崱娑樼；闁告侗鍘鹃弳锔锯偓鍏夊亾闁告洦鍓涢崢闈涱渻閵堝棙顥嗛柛瀣姉缁棃鎼归崗澶婁壕閻熸瑥瀚径鍕煕鐎ｎ亷宸ラ柣锝囧厴閹垻鍠婃潏銊︽珜濠电偠鎻徊鎸庣仚婵犮垻鎳撶粔鐟邦潖婵犳艾纾兼繛鍡樺笒閸橈紕绱撴笟鍥ф珮闁搞劌鐖奸悰顕€骞囬弶璺啇婵炶揪绲介幗婊堟晬濞嗘挻鈷戠紒澶婃鐎氬嘲鈻撻弮鍫熺參闁告劦浜滈弸娑㈡煛鐏炶濡奸柍瑙勫灴瀹曢亶鍩￠崒銈傚亾閸℃瑧纾介柛灞炬皑鏍￠梺缁橆殕椤ㄥ﹥淇婇悽绋跨妞ゆ牗姘ㄩ鎺楁煟閻樼儤顏犳繛鎻掓嚇婵＄兘鍩￠崒婊冨妇闂備礁澹婇崑渚€宕硅ぐ鎺戝偍閻庢稒蓱閸欏繐鈹戦悩鎻掓殲闁靛洦绻冩穱濠囶敃閵忕姵娈梺瀹犳椤︻垶鍩㈡惔鈭ョ喎煤缂佹﹫绱橀梻鍌氬€搁崐椋庣矆娓氣偓楠炴饪伴崼婵堢崶闂佸綊鍋婇崜锕傛倿閼恒儳绠鹃柛鈩兩戠亸浼存煕鐎Ｑ勬珚闁哄矉缍侀獮瀣晲閸♀晜顥夐梻鍌欑瀹曨剙煤椤撱垹钃熼柨鐔哄Т閻愬﹪鏌嶆潪鎵妽闁诲骸顭峰娲焻閻愯尪瀚板褍鐡ㄩ妵鍕Ψ閿旇棄纾抽梺绯曟杹閸嬫挸顪冮妶鍡楃瑨闁稿﹤缍婂畷鐢稿焵椤掍胶绡€闁靛繈鍨洪崵鈧梺鎸庢处娴滄粓鎮鹃悜钘夌骇婵炲棛鍋撶€靛矂姊洪崨濠冨瘷闁告洦鍓﹀锟�
        APP_DEBUG("get meter return");
#ifdef GETANTIBUF_FROMACK
        get_antibuf(cmd->ack.payload,cmd->ack.lenght); 
#endif  
    }
    else{
        //anti replay
        if(cmd->ack.payload[1]==0x10){
            modbus_wr_response_t *anti_ack_buf=(modbus_wr_response_t *)cmd->ack.payload;
            anti_ack_buf->st_addr=ENDIAN_BIG_LITTLE_16(anti_ack_buf->st_addr);
            APP_DEBUG("anti_ack_buf->st_addr=%d",anti_ack_buf->st_addr);
            if(anti_ack_buf->st_addr==ANTI_REFLUX_REG_ADDR){
                meter_data_sent=0;
                APP_DEBUG("anti replay\r\n");
            }
        }
        
    }	
    Device_remove(dev);
    //list_nodeDelete(&dev->cmdList, cmd);
    return 0;
}

/*******************************************************************************            
* introduce:        
* parameter:                       
* return:                 
* author:           Luee                                                    
*******************************************************************************/
static u8_t anti_trans(u8 *data_ptr ,u8 data_len)
{
    Device_t *dev;
    DeviceCmd_t *cmd;

    APP_DEBUG("anti reflux trans\r\n");

    dev = list_nodeApply(sizeof(Device_t));
    cmd = list_nodeApply(sizeof(DeviceCmd_t));

    cmd->waitTime = 6000;     // 1500=1.5 sec
    cmd->state = 0;

    cmd->ack.size = 64;     //DEVICE_ACK_SIZE;
    cmd->ack.payload = memory_apply(cmd->ack.size);
    cmd->ack.lenght = 0;
    cmd->cmd.size = data_len;
    cmd->cmd.lenght = cmd->cmd.size;
    cmd->cmd.payload = memory_apply(cmd->cmd.size);  // 闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁炬儳缍婇弻锝夊箣閿濆憛鎾绘煕婵犲倹鍋ラ柡灞诲姂瀵潙顫濋懜娈库偓鏍ㄧ箾鐎涙鐭婄紓宥咃躬瀵鈽夐姀鐘电杸闂佺ǹ绻愰幗婊堝极閺嶎厽鈷戞繛鑼额嚙楠炴鏌熼悷鐗堝枠鐎殿喖顭烽弫鎰緞婵犲孩缍傞梻浣芥珪閸庣厧鈻斿☉姘辩濠电姴娲ょ粻顖炴煙鏉堥箖妾柛瀣閹ǹ绠涙惔锝呭闂佸搫鍊甸崑鎾绘⒒閸屾瑨鍏岀紒顕呭灦閺佸鎮楀▓鍨灕闁糕晜鐗曢銉╁礋椤栨氨顦板銈嗙墬缁嬫捇宕㈤柆宥嗙厽閹兼惌鍨崇粊鐑芥煕閺傛寧婀伴柟渚垮姂瀹曟帡鎮欑€电ǹ骞嶆俊鐐€栧濠氭偤閺傚簱鏋旀繝濠傛噳閸嬫挾鎲撮崟顒傤槶闂佺ǹ绻戦敃銏ゅΥ娴ｅ壊娼ㄩ柍褜鍓熼獮鍐ㄢ堪閸繂鑰块棅顐㈡处閹搁攱绔熼弴銏″€甸柛蹇擃槸娴滈箖姊洪崨濠冨闁告挻鐩畷銏ゆ焼瀹ュ棌鎷洪梻鍌氱墛缁嬫挻鏅堕弴鐔虹閻忕偛鍊搁埀顒佺墱缁骞掑Δ浣哄姸閻庡箍鍎卞Λ娑㈠储闂堟侗娓婚柕鍫濇閳锋帡鏌ｉ埄鍐╃叆闁崇粯鎹囧顕€宕奸悢鍝勫笚闂備浇濮ら敋妞わ箒妫勫嵄闁归棿鐒﹂悡鍐偣閸ヮ亜鐨洪弫鍫ユ⒑閸︻厼甯剁紓宥咃躬閵嗕線寮撮姀鐙€娼婂銈庡亽閸樺墽绮堟径鎰拺閻犲洦褰冮銏°亜閺冣偓閻楃姴鐣烽幎绛嬫晪闁逞屽墮閻ｅ嘲饪伴崘鐐兊闁荤娀缂氬▍锝夘敊閸℃稒鈷戦柛娑橈梗缁堕亶鏌涢妸鈺€鎲剧€规洑鍗冲畷鍗炩槈濞嗘垵骞堥梻浣告惈濞层垽宕濆畝鍕祦婵せ鍋撻柟铏墵瀵粙顢橀悢鍙夊闂備胶枪閺堫剟鎮烽敂鍓х焾闁绘鐗勬禍婊勩亜閹扳晛鐒烘俊顖楀亾闁诲氦顫夊ú妯好洪悢鑲╁祦閹兼番鍔嶇€电姴顭跨捄鐑樻拱闁绘帡绠栧缁樻媴缁嬫妫岄梺缁樻尭閻楁挸鐣烽幎绛嬫晪闁逞屽墮閻ｇ兘鎮界粙鍨祮闂侀潧楠忕槐鏇㈠储閻㈠憡鈷戦悹鍥ｂ偓宕囦画濠电姰鍨烘灙妞わ絽娼″缁樻媴閾忕懓绗￠梺鍦归…鐑藉箖閻ゎ垼妲惧┑鈥冲级閸旀瑩鐛幒妤€妫橀柛婵嗗婢规洟姊洪幐搴ｇ畵濡ょ姴鎲＄粋宥呪堪閸曗晙绨婚梺鍝勬川閸犳捇鎯岄幒妤佺厸鐎光偓鐎ｎ剛袦濡炪們鍨洪敃銏ゅ箖閵堝棙濯撮柛锔诲幗濠㈡帡姊婚崒娆戭槮闁圭⒈鍋婇幆澶嬬附缁嬭法鐛ラ梺鍝勭▉閸樹粙宕戦崒娑栦簻闁圭儤鍨甸鈺冪磼閻樺灚鏆柡宀€鍠栧畷顐﹀礋椤掑顥ｅ┑鐐茬摠缁酣宕戦幘鑸靛床婵犻潧顑嗛ˉ鍫熺箾閹存繂鑸归柛鎾村缁辨挻鎷呴崫鍕戯絿鈧厜鍋撻柟闂寸閽冪喐绻涢幋娆忕仼缂佺姵鐩濠氬醇閻旇　濮囬梺璇茬箰閻楀繒妲愰幘瀛樺闁圭粯甯婃竟鏇㈡⒑鐠囨彃鍤辩紓宥呮瀹曟垶鎷呴崷顓ф锤濠电姴锕ら悧濠囨偂濞嗘挻鐓欏ù锝呭暞閻濐亝绻涢崨顓熷殗闁哄矉缍€缁犳盯鏁愰崟顖氫粣闂備礁鎼惌澶屾崲濠靛棛鏆﹂梺顒€绉寸粻娑欍亜閹哄棗浜炬繝娈垮櫙缁犳挸顫忓ú顏勪紶闁告洦鍘鹃崝鍦磽娴ｅ湱鍙€缂佺姵鐗犻悰顕€宕卞☉妯肩潉闂佸壊鍋呯换宥咁焽婵犲洦鈷戠紓浣光棨椤忓嫷鍤曢柛顐ｆ礃閸婂爼鏌涢埄鍐姇闁抽攱甯掗湁闁挎繂娲ら崝瀣煕閵堝倸浜鹃梻鍌欑劍閹爼宕愰弽顓熷亱闁绘ǹ宕靛畵渚€鐓崶銊р姇闁哄懏鎮傞弻銊╂偆閸屾稑顏�
    r_memcpy(cmd->cmd.payload, data_ptr, cmd->cmd.size);

    APP_PRINT("cmd.payload:");
    print_buf(cmd->cmd.payload,cmd->cmd.size);

    //dev->cfg = null;  // 闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁炬儳缍婇弻锝夊箣閿濆憛鎾绘煕婵犲倹鍋ラ柡灞诲姂瀵潙螖閳ь剚绂嶉幆褜娓婚柕鍫濋楠炴牠鏌ｈ箛鏃傜畾闁诲繑甯″娲礂閼测斂鍋為梺鍝勬噺缁诲牓骞冮敍鍕ㄥ亾閿濆骸鏋熼柍閿嬪灴閺屾盯骞橀弶鎴犵シ婵炲瓨绮嶇换鍐崲濞戙垹鐭楀鑸电閳ь剝娉曢埀顒冾潐濞叉﹢宕归崸妞尖偓渚€寮崼婵嬪敹闂佺粯鏌ㄩ幖顐︾嵁閸儲鈷掑ù锝堫潐閻忛亶鏌￠崨顔炬创鐎规洘婢橀～婵嬫嚋闂堟稈鍋撻崹顔氬綊鎮╁顔煎壉闂佺粯鎸搁崯鎵閹惧瓨濯撮柤娴嬪墲閸ㄨ儻妫㈤梺鍓插亖閸庢煡鎮″☉銏″€堕柣鎰仛濞呮洟宕粙娆炬富闁靛洤宕崐鑽ょ玻閺冨牊鐓涢悘鐐插⒔濞插瓨顨ラ悙鎼劷闁逞屽墯缁嬫帡鈥﹂崶褉鏋旈柕鍫濇川绾捐棄銆掑顒佹悙闁哄鍠栭弻锝夋偆閸屾粎鏆犲銈嗘磸閸庨潧鐣烽悢纰辨晬婵ǹ浜弶鎼佹⒒娴ｇǹ顥忛柣鎾崇墦瀹曟垿宕ㄩ娑欑€洪梺绯曞墲缁嬫帡鍩涢幒鎳ㄥ綊鏁愰崨顔兼殘闂佸摜鍠撻崑娑㈠Υ閹烘埈娼╂い鎾楀嫮鏉归柣搴ゎ潐濞插繘宕规禒瀣祦闁哄秲鍔嶆刊鎾煕濠靛嫬鍔撮柛鐐茬埣濮婄粯鎷呴崨濠傛殘闂佸憡妫戠粻鎾崇暦閺夎鏃堝川椤旈棿绨甸梻浣虹帛閺屻劑宕ョ€ｎ喗鍋傞柣鏂垮悑閻撴瑩姊洪銊х暠濠⒀冾煼閺屾盯濡堕崶褎鐏堥梺鍝勮嫰缁夊綊骞愭繝鍐ㄧ窞婵☆垳鍎甸弸鍛存⒒娴ｅ憡鎯堥柣顓烆槺缁辩偞绗熼埀顒勫Υ娴ｈ倽鐔烘偘閳╁啯鏉搁梻浣稿閸嬩線宕圭拠鑼殾闁告瑥顦换鍡涙煟閹板吀绨婚柍褜鍓氶崹鍨暦閻熸噴娲敂閸涱厽鐤勫┑掳鍊х徊浠嬪窗濞戞氨绀婇柡宥冨妿缁♀偓闂傚倸鐗婄粙鎾存櫠濞戞埃鍋撶憴鍕妞わ妇鏁诲鏄忣樁缂佺姵绋戦～婵嬫偂鎼淬垻鏆熼梻鍌欑閹芥粓宕戝☉銏″亯闁绘挸瀵掑鏍磽娴ｈ偂鎴炲垔閹绢喗鍋℃繛鍡楃箰椤忊晛霉閻橆偅娅婃慨濠呮缁瑩宕稿Δ濞惧亾濡や降浜滄い鎾跺仜濡茬粯銇勯銏㈢缂佸倹甯為埀顒婄秵娴滅偤藝閺夋娓婚柕鍫濇缁楀倻绱掗埀顒佹媴閸撴彃娈ㄩ梺绉嗗嫷娈曢柍閿嬪灴濮婂宕奸悢鎭掆偓鎺旂磼閻橀潧浠遍柡灞剧⊕缁绘繈宕橀鍕ㄦ嫲闂備浇顕栭崳顖滄崲濠靛绠栭柕蹇嬪€曠粈鍌炴煠濞村娅呴悽顖涘劤閳规垿鎮╅崹顐ｆ瘎闂佺ǹ顑嗛惄顖炲箖濡　鏀介悗锝庝簽椤︻喖鈹戦鏂や緵闁告ǹ顫夌粋宥呪堪閸垹褰勯梺鎼炲劦椤ユ捇宕氶弶娆剧唵鐟滄粓宕归崼鏇炶摕闁哄洢鍨归悙濠勬喐瀹ュ鏁傛い鎾跺Л閸嬫挸鈻撻崹顔界彯闂侀潻缍囩紞浣哥暦濞差亜鐒垫い鎺嶉檷娴滄粓鏌熼崫鍕棞濞存粓绠栭弻锝夊箻閸楃偐鍋撻弽銊р攳濠电姴娴傞弫宥嗙箾閸℃ê淇柛鏂挎嚇濮婃椽骞栭悙娴嬪亾閺嶎厹鈧啯绻濋崶褑鎽曞┑鐐村灟閸ㄥ綊宕￠幎鑺ョ厪濠电偛鐏濋崝銈吤归悪鈧崣鍐潖濞差亜浼犻柛鏇ㄥ墮濞呫倝姊虹拠鈥虫灈闁稿﹤鐏濋锝嗙節濮橆儵鈺呮煃閸濆嫬鈧憡绂嶉悙鐑樷拺缂佸瀵у﹢鎵磼鐎ｎ偄鐏存い銏℃閺佹捇鏁撻敓锟�
    if (ModbusDevice.cfg == null) {
          dev->cfg = (ST_UARTDCB *)ModbusDevice.head->hardCfg;
        } else {
          dev->cfg = ModbusDevice.cfg;
        }
    
    
    dev->callBack = anti_ack;  // 闂傚倸鍊搁崐鎼佸磹閹间礁纾圭€瑰嫭鍣磋ぐ鎺戠倞鐟滃繘寮抽敃鍌涚厱妞ゎ厽鍨垫禍婵嬫煕濞嗗繒绠抽柍褜鍓濋～澶娒洪弽顬℃椽濡搁埡鍌氬壒闂佺硶鍓濋ˇ楦裤亹閹烘挻娅滈梺鍓插亽閸嬪懐绱為崼婵冩斀闁绘劕寮堕崳钘夆攽椤旇姤灏︽繝鈧笟鈧铏圭磼濡浚浜滆灒濠电姴娲ょ壕鍧楁煙閹殿喖顣奸柣鎾存礋閹鏁愰崨顓熷€庨梻渚囧弾閸ㄥ爼寮婚敍鍕勃闁告挆鍕灡闂備胶纭堕弲娑氣偓姘緲閻ｅ嘲顫滈埀顒勩€侀弮鈧幏鍛村礈閸欏绉奸梻鍌氬€搁崐鐑芥嚄閸撲礁鍨濇い鏍ㄧ矋閺嗘粓鏌熼悜妯镐粶闁逞屽墾缁犳捇骞冨⿰鍫熷殟闁靛鍎扮花鍨繆閻愵亜鈧牠宕濊缁骞嬮敂钘夆偓宄扳攽閻樻彃顏柛鐘冲姍楠炴牕菐椤掆偓婵¤偐绱掗悩宕囧弨闁哄被鍔岄埞鎴﹀幢閳哄倐褔姊虹紒妯诲暗闁哥姵鐗犲濠氭偄閸忚偐鍔烽梺鎸庢磵閸嬫挸顭胯缁犳牕螞閸涙惌鏁嗗璺猴工閳峰姊洪崫鍕伇闁哥姵鐗犻妴浣糕枎韫囧﹥鐎婚梺缁樺姦閸撴稓绮旈悜鑺モ拻濞达絿鍎ら崵鈧梺鎼炲灪閻擄繝鐛繝鍌ゆ建闁逞屽墴閻涱噣宕橀钘夆偓濠氭煢濡警妲哄Δ鐘叉喘濮婃椽宕滈懠顒€甯ラ梺鍝ュ暱閺呯娀鐛€ｎ喗鍊烽柟娈垮枤閻ｉ箖姊绘担铏瑰笡闁告棑闄勭粋宥呪堪閸繄鍔﹀銈嗗焾閸撴瑩骞婃径鎰；闁瑰墽绮ˉ鍫熺箾閹寸偞鐨戦柛鏃戝灦閹鎲撮崟顒傤槰缂備緡鍠楅幑鍥嵁閸愵喖顫呴柕鍫濇濞堟劙姊虹紒妯虹仸妞ゎ厼娲崺濠囧即閻樼數锛滃┑掳鍊曢崯顐﹀几濞戙垺鐓曢柍瑙勫劤娴滅偓淇婇悙顏勨偓鏍暜閹烘柡鍋撳鐓庡⒋鐎殿喕鍗虫俊鐑藉煛閸屾粌甯楅柣鐔哥矋缁挸鐣峰⿰鍐炬僵閻犺桨缍嶉敃鍌涚厱闁哄洢鍔岄悘鐘电磼閻樺啿鈻曢柡宀€鍠撻埀顒佺⊕椤洦淇婇崶顒佺厱閻庯綆鍋呭畷鍕煏閸ャ劌濮嶆鐐村浮楠炲鎮╁畷鍥уЪ闂傚倸鍊风粈渚€骞夐敍鍕床闁稿本绋撶粻鎯р攽閻樺弶鍣峰ù婊冪秺閺岀喖鎮滃Ο璇查瀺濠电偛鎳忕划鎾愁潖濞差亜绠归柣鎰絻婵⊙囨⒑閸涘﹤濮﹂柣鎾崇墦閹鏌嗗鍡忔嫽闂佺ǹ鏈悷锕偹囨搴ｇ＜濡插本鐗曢弸銈囩磼鏉堚晛浠﹂柟宄版嚇瀹曠兘顢樿闁裤倝姊洪懡銈呅俊妞煎妿閹峰啴鏁冮崒姘優闂佸搫娲㈤崹娲偂閺囩喆浜滈柟鏉垮缁嬭崵绱掗埀顒勫焵椤掑嫭鈷戠紓浣股戠亸浼存煟閳哄﹤鐏︾€殿喛顕ч埥澶婎潩椤愶絽濯伴梻浣告啞閹稿棙鎷呴幓鎺嶅闂佸湱鍎ら〃鍡涙偂閺囩喓绠鹃柛鈩冾殘缁犲弶銇勯妷锔剧煉闁哄苯绉堕幉鎾礋椤愩倓绱濋梻浣筋嚃閸犳鎮烽埡鍛祦闁规崘顕х粻鎶芥煛閸愩劎澧㈢€规洘绮撳濠氬磼濞嗘帒鍘＄紓渚囧櫘閸ㄥ爼濡撮崘顔奸唶闁绘梻枪瀵潡姊洪崷顓℃闁哥姵顨婂畷鎴﹀煛閸愶絽浜鹃柣鐔告緲椤忣亜顭块悷閭﹀剶鐎殿喖鎲￠幆鏃堝Ω閿旀儳骞嶉梻浣虹帛閸旓箓宕滃杈╃闁瑰鍋熺粻楣冩煕椤愮姴鐏╅柡瀣⊕閹便劍绻濋崘鈹夸虎濠碘槅鍋勯崯顐﹀煡婢跺缍囨い顓熷灍閸嬫捇宕卞☉娆屾嫽闂佺ǹ鏈懝楣冾敂閳哄懏鍊垫慨姗嗗亜瀹撳棝鏌曢崱鏇狀槮闁宠閰ｉ獮妯尖偓娑櫳戦鐔兼⒒娴ｈ姤纭堕柛锝忕畵楠炲繘鏁撻敓锟�
   // dev->callBack = NULL;  
    //dev->explain = esp;   // 闂傚倸鍊搁崐鎼佸磹閹间礁纾圭€瑰嫭鍣磋ぐ鎺戠倞鐟滃繘寮抽敃鍌涚厱妞ゎ厽鍨垫禍婵嬫煕濞嗗繒绠婚柡宀€鍠栭獮鍡涘级閸熷啯鎹囬弻娑欑節閸屾稑浠撮梺鍝勮閸旀垵顕ｉ幘顔藉€锋繛鏉戭儏娴滈箖鏌涘┑鍕姎妞ゃ儲宀搁弻娑滎槼妞ゃ劌妫濋幃鈥斥枎閹炬潙浠梺鍛婄箓鐎氼參骞嗛崼鐔翠簻闁靛／鍐ф闂佸搫鏈惄顖涗繆閻戠瓔鏁婇柣鎾崇岸閹峰姊绘担鑺ャ€冪紒鈧担鑲濇稑鈹戠€ｎ亣鎽曞┑鐐村灟閸ㄥ綊宕￠幎鑺ョ厪濠电偛鐏濋崝娆戠磼閵娿劍顥夋い顏勫暣婵″爼宕卞Ο閿嬪闂備礁鎲″褰掓偡閵夆晪缍栭煫鍥ㄦ媼濞差亶鏁傞柛鏇ㄥ亞閻涒晛鈹戦悩鍨毄濠殿喖顕埀顒佸嚬閸ｏ綁骞冩ィ鍐╁仺闁告稑锕﹂崢浠嬫煙閸忚偐鏆橀柛銊ョ秺瀹曠敻顢楅崟顒傚幈闂佹寧绻傜换鎺楀礆閻楀牄浜滈柡鍥朵簽缁夘喗銇勯姀鈩冪闁轰礁鍟撮崺鈧い鎺嶇閸旀棃姊婚崒娆戭槮闁哥喎娼￠獮鏍敃閿曗偓绾剧懓鈹戦悩瀹犲闁稿被鍔戦弻锝夊閵忊剝姣勭紒鐐礃濡嫰婀侀梺鎸庣箓閹冲酣藟韫囨稒鐓曢幖娣灩婵秹鏌熼绛嬫畼缂侇噮鍘奸埥澶娢熺拠宸П闂備胶枪鐎涒晠銆冮崱妯尖攳濠电姴娲ゅ洿闂佸憡渚楅崰鏍р枍閵堝鈷戠紓浣股戠亸浼存煟閻斿弶娅呴摶鐐烘煕濞戞瑦鍎楅柡浣告闇夐柨婵嗘噺閹插摜绱掓担鍝勫幋婵﹥妞介弻鍛存倷閼艰泛顏繝鈷€灞界仯缂佽鲸甯為幏鐘绘嚑椤掆偓閳敻姊虹紒妯圭繁闁哥姵顨堥幑銏犫攽鐎ｎ亞鍊為梺闈浨归崕顕€宕戦幘缁樺€婚柤鎭掑劤閸樺崬鈹戦悩缁樻锭婵☆偅顨婇、鏃堫敃閿旂晫鍙嗗┑鐐村灦閻熝囨儗婵犲洦鐓冮悷娆忓閻忔挳鏌熼瑙勬珖闁归濮鹃ˇ鎻捗归崗鐓庡婵﹥妞藉畷顐﹀Ψ閵夛附鐦ｉ梻浣告惈閹虫劖鎱ㄩ幘顔藉仼闁绘垼濮ら崑鎰磽娴ｈ偂鎴濃枍閵忋倖鈷戦悹鎭掑妼濞呮劙鏌熼崙銈嗗
    dev->type = DEVICE_ARTI;       //DEVICE_TRANS;

    list_init(&dev->cmdList);
    list_bottomInsert(&dev->cmdList, cmd);
    Device_inset(dev);    // insert to head,realtime send
    //Device_add(dev);
    
    return 1;
}

static u8_t meter_trans(u8 *data_ptr ,u8 data_len)
{
    Device_t *dev;
    DeviceCmd_t *cmd;

    APP_DEBUG("anti reflux trans\r\n");

    dev = list_nodeApply(sizeof(Device_t));
    cmd = list_nodeApply(sizeof(DeviceCmd_t));

    cmd->waitTime = 6000;     // 1500=1.5 sec
    cmd->state = 0;

    cmd->ack.size = 64;     //DEVICE_ACK_SIZE;
    cmd->ack.payload = memory_apply(cmd->ack.size);
    cmd->ack.lenght = 0;
    cmd->cmd.size = data_len;
    cmd->cmd.lenght = cmd->cmd.size;
    cmd->cmd.payload = memory_apply(cmd->cmd.size);  // 闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁炬儳缍婇弻锝夊箣閿濆憛鎾绘煕婵犲倹鍋ラ柡灞诲姂瀵潙顫濋懜娈库偓鏍ㄧ箾鐎涙鐭婄紓宥咃躬瀵鈽夐姀鐘电杸闂佺ǹ绻愰幗婊堝极閺嶎厽鈷戞繛鑼额嚙楠炴鏌熼悷鐗堝枠鐎殿喖顭烽弫鎰緞婵犲孩缍傞梻浣芥珪閸庣厧鈻斿☉姘辩濠电姴娲ょ粻顖炴煙鏉堥箖妾柛瀣閹ǹ绠涙惔锝呭闂佸搫鍊甸崑鎾绘⒒閸屾瑨鍏岀紒顕呭灦閺佸鎮楀▓鍨灕闁糕晜鐗曢銉╁礋椤栨氨顦板銈嗙墬缁嬫捇宕㈤柆宥嗙厽閹兼惌鍨崇粊鐑芥煕閺傛寧婀伴柟渚垮姂瀹曟帡鎮欑€电ǹ骞嶆俊鐐€栧濠氭偤閺傚簱鏋旀繝濠傛噳閸嬫挾鎲撮崟顒傤槶闂佺ǹ绻戦敃銏ゅΥ娴ｅ壊娼ㄩ柍褜鍓熼獮鍐ㄢ堪閸繂鑰块棅顐㈡处閹搁攱绔熼弴銏″€甸柛蹇擃槸娴滈箖姊洪崨濠冨闁告挻鐩畷銏ゆ焼瀹ュ棌鎷洪梻鍌氱墛缁嬫挻鏅堕弴鐔虹閻忕偛鍊搁埀顒佺墱缁骞掑Δ浣哄姸閻庡箍鍎卞Λ娑㈠储闂堟侗娓婚柕鍫濇閳锋帡鏌ｉ埄鍐╃叆闁崇粯鎹囧顕€宕奸悢鍝勫笚闂備浇濮ら敋妞わ箒妫勫嵄闁归棿鐒﹂悡鍐偣閸ヮ亜鐨洪弫鍫ユ⒑閸︻厼甯剁紓宥咃躬閵嗕線寮撮姀鐙€娼婂銈庡亽閸樺墽绮堟径鎰拺閻犲洦褰冮銏°亜閺冣偓閻楃姴鐣烽幎绛嬫晪闁逞屽墮閻ｅ嘲饪伴崘鐐兊闁荤娀缂氬▍锝夘敊閸℃稒鈷戦柛娑橈梗缁堕亶鏌涢妸鈺€鎲剧€规洑鍗冲畷鍗炩槈濞嗘垵骞堥梻浣告惈濞层垽宕濆畝鍕祦婵せ鍋撻柟铏墵瀵粙顢橀悢鍙夊闂備胶枪閺堫剟鎮烽敂鍓х焾闁绘鐗勬禍婊勩亜閹扳晛鐒烘俊顖楀亾闁诲氦顫夊ú妯好洪悢鑲╁祦閹兼番鍔嶇€电姴顭跨捄鐑樻拱闁绘帡绠栧缁樻媴缁嬫妫岄梺缁樻尭閻楁挸鐣烽幎绛嬫晪闁逞屽墮閻ｇ兘鎮界粙鍨祮闂侀潧楠忕槐鏇㈠储閻㈠憡鈷戦悹鍥ｂ偓宕囦画濠电姰鍨烘灙妞わ絽娼″缁樻媴閾忕懓绗￠梺鍦归…鐑藉箖閻ゎ垼妲惧┑鈥冲级閸旀瑩鐛幒妤€妫橀柛婵嗗婢规洟姊洪幐搴ｇ畵濡ょ姴鎲＄粋宥呪堪閸曗晙绨婚梺鍝勬川閸犳捇鎯岄幒妤佺厸鐎光偓鐎ｎ剛袦濡炪們鍨洪敃銏ゅ箖閵堝棙濯撮柛锔诲幗濠㈡帡姊婚崒娆戭槮闁圭⒈鍋婇幆澶嬬附缁嬭法鐛ラ梺鍝勭▉閸樹粙宕戦崒娑栦簻闁圭儤鍨甸鈺冪磼閻樺灚鏆柡宀€鍠栧畷顐﹀礋椤掑顥ｅ┑鐐茬摠缁酣宕戦幘鑸靛床婵犻潧顑嗛ˉ鍫熺箾閹存繂鑸归柛鎾村缁辨挻鎷呴崫鍕戯絿鈧厜鍋撻柟闂寸閽冪喐绻涢幋娆忕仼缂佺姵鐩濠氬醇閻旇　濮囬梺璇茬箰閻楀繒妲愰幘瀛樺闁圭粯甯婃竟鏇㈡⒑鐠囨彃鍤辩紓宥呮瀹曟垶鎷呴崷顓ф锤濠电姴锕ら悧濠囨偂濞嗘挻鐓欏ù锝呭暞閻濐亝绻涢崨顓熷殗闁哄矉缍€缁犳盯鏁愰崟顖氫粣闂備礁鎼惌澶屾崲濠靛棛鏆﹂梺顒€绉寸粻娑欍亜閹哄棗浜炬繝娈垮櫙缁犳挸顫忓ú顏勪紶闁告洦鍘鹃崝鍦磽娴ｅ湱鍙€缂佺姵鐗犻悰顕€宕卞☉妯肩潉闂佸壊鍋呯换宥咁焽婵犲洦鈷戠紓浣光棨椤忓嫷鍤曢柛顐ｆ礃閸婂爼鏌涢埄鍐姇闁抽攱甯掗湁闁挎繂娲ら崝瀣煕閵堝倸浜鹃梻鍌欑劍閹爼宕愰弽顓熷亱闁绘ǹ宕靛畵渚€鐓崶銊р姇闁哄懏鎮傞弻銊╂偆閸屾稑顏�
    r_memcpy(cmd->cmd.payload, data_ptr, cmd->cmd.size);

    APP_PRINT("cmd.payload:");
    print_buf(cmd->cmd.payload,cmd->cmd.size);

    dev->cfg = (ST_UARTDCB *)&UART_9600_N1;  
       
    dev->callBack = anti_ack;  // 闂傚倸鍊搁崐鎼佸磹閹间礁纾圭€瑰嫭鍣磋ぐ鎺戠倞鐟滃繘寮抽敃鍌涚厱妞ゎ厽鍨垫禍婵嬫煕濞嗗繒绠抽柍褜鍓濋～澶娒洪弽顬℃椽濡搁埡鍌氬壒闂佺硶鍓濋ˇ楦裤亹閹烘挻娅滈梺鍓插亽閸嬪懐绱為崼婵冩斀闁绘劕寮堕崳钘夆攽椤旇姤灏︽繝鈧笟鈧铏圭磼濡浚浜滆灒濠电姴娲ょ壕鍧楁煙閹殿喖顣奸柣鎾存礋閹鏁愰崨顓熷€庨梻渚囧弾閸ㄥ爼寮婚敍鍕勃闁告挆鍕灡闂備胶纭堕弲娑氣偓姘緲閻ｅ嘲顫滈埀顒勩€侀弮鈧幏鍛村礈閸欏绉奸梻鍌氬€搁崐鐑芥嚄閸撲礁鍨濇い鏍ㄧ矋閺嗘粓鏌熼悜妯镐粶闁逞屽墾缁犳捇骞冨⿰鍫熷殟闁靛鍎扮花鍨繆閻愵亜鈧牠宕濊缁骞嬮敂钘夆偓宄扳攽閻樻彃顏柛鐘冲姍楠炴牕菐椤掆偓婵¤偐绱掗悩宕囧弨闁哄被鍔岄埞鎴﹀幢閳哄倐褔姊虹紒妯诲暗闁哥姵鐗犲濠氭偄閸忚偐鍔烽梺鎸庢磵閸嬫挸顭胯缁犳牕螞閸涙惌鏁嗗璺猴工閳峰姊洪崫鍕伇闁哥姵鐗犻妴浣糕枎韫囧﹥鐎婚梺缁樺姦閸撴稓绮旈悜鑺モ拻濞达絿鍎ら崵鈧梺鎼炲灪閻擄繝鐛繝鍌ゆ建闁逞屽墴閻涱噣宕橀钘夆偓濠氭煢濡警妲哄Δ鐘叉喘濮婃椽宕滈懠顒€甯ラ梺鍝ュ暱閺呯娀鐛€ｎ喗鍊烽柟娈垮枤閻ｉ箖姊绘担铏瑰笡闁告棑闄勭粋宥呪堪閸繄鍔﹀銈嗗焾閸撴瑩骞婃径鎰；闁瑰墽绮ˉ鍫熺箾閹寸偞鐨戦柛鏃戝灦閹鎲撮崟顒傤槰缂備緡鍠楅幑鍥嵁閸愵喖顫呴柕鍫濇濞堟劙姊虹紒妯虹仸妞ゎ厼娲崺濠囧即閻樼數锛滃┑掳鍊曢崯顐﹀几濞戙垺鐓曢柍瑙勫劤娴滅偓淇婇悙顏勨偓鏍暜閹烘柡鍋撳鐓庡⒋鐎殿喕鍗虫俊鐑藉煛閸屾粌甯楅柣鐔哥矋缁挸鐣峰⿰鍐炬僵閻犺桨缍嶉敃鍌涚厱闁哄洢鍔岄悘鐘电磼閻樺啿鈻曢柡宀€鍠撻埀顒佺⊕椤洦淇婇崶顒佺厱閻庯綆鍋呭畷鍕煏閸ャ劌濮嶆鐐村浮楠炲鎮╁畷鍥уЪ闂傚倸鍊风粈渚€骞夐敍鍕床闁稿本绋撶粻鎯р攽閻樺弶鍣峰ù婊冪秺閺岀喖鎮滃Ο璇查瀺濠电偛鎳忕划鎾愁潖濞差亜绠归柣鎰絻婵⊙囨⒑閸涘﹤濮﹂柣鎾崇墦閹鏌嗗鍡忔嫽闂佺ǹ鏈悷锕偹囨搴ｇ＜濡插本鐗曢弸銈囩磼鏉堚晛浠﹂柟宄版嚇瀹曠兘顢樿闁裤倝姊洪懡銈呅俊妞煎妿閹峰啴鏁冮崒姘優闂佸搫娲㈤崹娲偂閺囩喆浜滈柟鏉垮缁嬭崵绱掗埀顒勫焵椤掑嫭鈷戠紓浣股戠亸浼存煟閳哄﹤鐏︾€殿喛顕ч埥澶婎潩椤愶絽濯伴梻浣告啞閹稿棙鎷呴幓鎺嶅闂佸湱鍎ら〃鍡涙偂閺囩喓绠鹃柛鈩冾殘缁犲弶銇勯妷锔剧煉闁哄苯绉堕幉鎾礋椤愩倓绱濋梻浣筋嚃閸犳鎮烽埡鍛祦闁规崘顕х粻鎶芥煛閸愩劎澧㈢€规洘绮撳濠氬磼濞嗘帒鍘＄紓渚囧櫘閸ㄥ爼濡撮崘顔奸唶闁绘梻枪瀵潡姊洪崷顓℃闁哥姵顨婂畷鎴﹀煛閸愶絽浜鹃柣鐔告緲椤忣亜顭块悷閭﹀剶鐎殿喖鎲￠幆鏃堝Ω閿旀儳骞嶉梻浣虹帛閸旓箓宕滃杈╃闁瑰鍋熺粻楣冩煕椤愮姴鐏╅柡瀣⊕閹便劍绻濋崘鈹夸虎濠碘槅鍋勯崯顐﹀煡婢跺缍囨い顓熷灍閸嬫捇宕卞☉娆屾嫽闂佺ǹ鏈懝楣冾敂閳哄懏鍊垫慨姗嗗亜瀹撳棝鏌曢崱鏇狀槮闁宠閰ｉ獮妯尖偓娑櫳戦鐔兼⒒娴ｈ姤纭堕柛锝忕畵楠炲繘鏁撻敓锟�
   // dev->callBack = NULL;  
    //dev->explain = esp;   // 闂傚倸鍊搁崐鎼佸磹閹间礁纾圭€瑰嫭鍣磋ぐ鎺戠倞鐟滃繘寮抽敃鍌涚厱妞ゎ厽鍨垫禍婵嬫煕濞嗗繒绠婚柡宀€鍠栭獮鍡涘级閸熷啯鎹囬弻娑欑節閸屾稑浠撮梺鍝勮閸旀垵顕ｉ幘顔藉€锋繛鏉戭儏娴滈箖鏌涘┑鍕姎妞ゃ儲宀搁弻娑滎槼妞ゃ劌妫濋幃鈥斥枎閹炬潙浠梺鍛婄箓鐎氼參骞嗛崼鐔翠簻闁靛／鍐ф闂佸搫鏈惄顖涗繆閻戠瓔鏁婇柣鎾崇岸閹峰姊绘担鑺ャ€冪紒鈧担鑲濇稑鈹戠€ｎ亣鎽曞┑鐐村灟閸ㄥ綊宕￠幎鑺ョ厪濠电偛鐏濋崝娆戠磼閵娿劍顥夋い顏勫暣婵″爼宕卞Ο閿嬪闂備礁鎲″褰掓偡閵夆晪缍栭煫鍥ㄦ媼濞差亶鏁傞柛鏇ㄥ亞閻涒晛鈹戦悩鍨毄濠殿喖顕埀顒佸嚬閸ｏ綁骞冩ィ鍐╁仺闁告稑锕﹂崢浠嬫煙閸忚偐鏆橀柛銊ョ秺瀹曠敻顢楅崟顒傚幈闂佹寧绻傜换鎺楀礆閻楀牄浜滈柡鍥朵簽缁夘喗銇勯姀鈩冪闁轰礁鍟撮崺鈧い鎺嶇閸旀棃姊婚崒娆戭槮闁哥喎娼￠獮鏍敃閿曗偓绾剧懓鈹戦悩瀹犲闁稿被鍔戦弻锝夊閵忊剝姣勭紒鐐礃濡嫰婀侀梺鎸庣箓閹冲酣藟韫囨稒鐓曢幖娣灩婵秹鏌熼绛嬫畼缂侇噮鍘奸埥澶娢熺拠宸П闂備胶枪鐎涒晠銆冮崱妯尖攳濠电姴娲ゅ洿闂佸憡渚楅崰鏍р枍閵堝鈷戠紓浣股戠亸浼存煟閻斿弶娅呴摶鐐烘煕濞戞瑦鍎楅柡浣告闇夐柨婵嗘噺閹插摜绱掓担鍝勫幋婵﹥妞介弻鍛存倷閼艰泛顏繝鈷€灞界仯缂佽鲸甯為幏鐘绘嚑椤掆偓閳敻姊虹紒妯圭繁闁哥姵顨堥幑銏犫攽鐎ｎ亞鍊為梺闈浨归崕顕€宕戦幘缁樺€婚柤鎭掑劤閸樺崬鈹戦悩缁樻锭婵☆偅顨婇、鏃堫敃閿旂晫鍙嗗┑鐐村灦閻熝囨儗婵犲洦鐓冮悷娆忓閻忔挳鏌熼瑙勬珖闁归濮鹃ˇ鎻捗归崗鐓庡婵﹥妞藉畷顐﹀Ψ閵夛附鐦ｉ梻浣告惈閹虫劖鎱ㄩ幘顔藉仼闁绘垼濮ら崑鎰磽娴ｈ偂鎴濃枍閵忋倖鈷戦悹鎭掑妼濞呮劙鏌熼崙銈嗗
    dev->type = DEVICE_ARTI;       //DEVICE_TRANS;

    list_init(&dev->cmdList);
    list_bottomInsert(&dev->cmdList, cmd);
    
    //anti reflux running 
    if(anti_refluxing){
        Device_inset(dev);    // insert to head,realtime send
    }
    else{
        Device_add(dev);        //add to tail
    }

    return 1;
}
/*******************************************************************************            
* introduce:        
* parameter:                       
* return:                 
* author:           Luee                                                    
*******************************************************************************/
static u8 get_online_count(void)
{
    DeviceOnlineHead_t *online = null;
    u8 i;

    i=0;
    if(onlineDeviceList.count==0){
        r_memset(online_dev_addr_tab,0,64);
        online_dev_count=0;
        return online_dev_count;
    }
    if (onlineDeviceList.count==online_dev_count){
        return online_dev_count;
    }
    online_dev_count=onlineDeviceList.count;
    r_memset(online_dev_addr_tab,0,64);
    do{
        online = list_nextData(&onlineDeviceList, online);
        if(online!=null){
            online_dev_addr_tab[i]=online->addr;
            i++;
        }  
    }while(online!=null && i<64); 
    APP_DEBUG("online_dev_addr_tab:\r\n");
    print_buf(online_dev_addr_tab,sizeof(online_dev_addr_tab));  
    return online_dev_count;
}


/*******************************************************************************            
* introduce:   闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁炬儳缍婇弻鐔兼⒒鐎靛壊妲紒鐐劤缂嶅﹪寮婚悢鍏尖拻閻庨潧澹婂Σ顔剧磼閻愵剙鍔ょ紓宥咃躬瀵鎮㈤崗灏栨嫽闁诲酣娼ф竟濠偽ｉ鍓х＜闁诡垎鍐ｆ寖闂佺娅曢幑鍥灳閺冨牆绀冩い蹇庣娴滈箖鏌ㄥ┑鍡欏嚬缂併劎绮妵鍕箳鐎ｎ亞浠鹃梺闈涙搐鐎氫即鐛崶顒夋晜闁糕剝鐟ч崢顖炴⒒娴ｅ憡鎯堥悶姘煎亰瀹曟繈骞嬮敃鈧粻鏍煏韫囧鈧洘瀵奸悩缁樼厱闁哄洨鍠庨悘鐔兼煕閵娿儺鐓奸柟顖楀亾濡炪倕绻愰悧鍡欑不濮樿鲸鍠愭繝濠傜墛閸嬪倸鈹戦崒姘暈闁绘挻鐩幃姗€鎮欓幓鎺嗘寖濠电偞褰冮顓㈠焵椤掍緡鍟忛柛鐘愁殜楠炴劙鎼归锛勭畾闂佸綊妫跨粈浣告暜闂備線娼х换鎺撴叏閾忣偆鐝堕柡鍥ュ灪閳锋垹绱撴担骞库偓鐐哄箣閻樼數鐒鹃梺鍝勵槹閸わ箓鏁愭径濠囧敹闂佺粯鏌ㄦ晶搴ｇ不濮橆剦娓婚柕鍫濇婢ь剛绱掔€ｎ偅宕岄柟顖氱灱閳ь剨缍嗛崑鍌滄崲閸℃ǜ浜滈柟鎵虫櫅閻忊晠鏌￠崱妯兼噰闁哄矉缍侀弫鎰板炊瑜嶉獮瀣⒑鐠団€虫灁闁搞劋绮欓獮鍐焺閸愨晛鍔呴梺鎸庣箓閹冲海绮绘导瀛樷拻闁稿本鐟х粣鏃堟煃瑜滈崜娑㈠磻濞戙垺鍤愭い鏍ㄧ⊕濞呯姵銇勯弴妤€浜鹃悗娈垮櫘閸嬪﹤鐣锋總鍛婂亜闁告挷鑳堕悾楣冩⒒娓氣偓濞佳囨偋閸℃瑢鍋撳鐓庣仸鐎规洘顨呴悾婵嬪焵椤掑倹顫曢柟鐑橆殔閻撱垽鏌嶈閸撶喎鐣烽幋锕€绠荤紓浣骨氶幏缁樼箾閹炬潙鐒归柛瀣尰缁绘稒鎷呴崘鎻掝伌婵炲牅绮欓悡顐﹀炊閵婏妇顦ョ紓浣界堪閸婃繈寮诲☉銏犵婵°倐鍋撻悗姘煎墴瀹曘垼銇愰幒鎾嫼缂傚倷鐒﹂敋濠殿噯绠撻弻娑滅疀閺冨倹鍣紓浣稿€哥粔鎾偑娴兼潙閱囬柣鏂挎惈楠炲秹姊虹拠鎻掝劉缂佸甯￠垾锕傚炊閳哄啩绗夐梺鍝勭Р閸斿﹥绂嶅⿰鍫熺厪濠㈣鍨伴崯鈺呭箣妞嬪海纾藉ù锝勭矙閸濇椽鎮介妞诲亾瀹曞洦娈鹃梺鍦劋閸╁牆顭囬埡鍌涘弿闁挎繂妫导鏇㈡煕閹板墎绋婚柡鍌楀亾闂傚倸鍊哥€氼剙煤椤撶偟鏆︽繛宸簻閸愨偓閻熸粍绮撳畷闈浳旈崨顔惧幈闂佸搫娲㈤崝宀勭嵁閹扮増鐓曢悗锝庡亝瀹曞矂鏌℃担鐟板闁诡垱妫冮崹楣冨箛娴ｉ€涙唉婵犲痉鏉库偓妤佹叏閻戣棄纾婚柣鎰惈缁€澶嬬箾閸℃绂嬫繛鍏肩墱缁辨挻鎷呴懖鈩冨灦閸掑﹪骞橀鐣屽幈濠电偞鍨崹鍝勨槈瑜忕槐鎾愁吋閸滃啫浼愬銈嗘穿缂嶄線骞冩禒瀣闁告瑥顦板▍宀勬⒒娴ｅ懙褰掑嫉椤掑倸鍨濋幖娣妽閸嬪倿鏌熼崜褏甯涢柍閿嬪灩閻ヮ亪顢橀悙鏉戞閻熸粍濡搁崶銊モ偓鐢告⒒閸喓銆掗柣鎺戞憸閳ь剚顔栭崳顕€宕戦崱娑樼劦妞ゆ帒锕︾粔鐢告煕鐎ｎ亝顥犵€殿啫鍥х劦妞ゆ帊鑳剁弧鈧梺姹囧灲濞佳冪摥闂備胶枪閿曘倗绱炴繝鍌滄殾闁规儼濮ら崑鈺冣偓鍏夊亾闁逞屽墮铻炴い鏍仦閻撴瑦銇勯弽褎顥欑紒鈧担鍦浄妞ゆ洍鍋撴慨濠冩そ瀹曨偊宕熼纰变純缂傚倷绀侀ˇ閬嶅礂濡偐妲靛┑鐐存尰閸╁啴宕戦幘缁樼厸閻忕偛澧藉ú瀛橆殽閻愭惌鐒介柟鐟板閹粌螣闂傛挳鍋楅梻浣筋嚙濮橈箓锝炴径濞掑搫螣娓氼垱瀵屾繛瀵稿Т椤戝懘寮伴妷鈺傜厓鐟滄粓宕滃璺何﹂柛鏇ㄥ灠缁犲磭鈧箍鍎遍ˇ浼搭敁閺嶃劎绠鹃悗娑欘焽閻绱掗鑺ュ磳鐎殿喖顭烽幃銏ゅ礂閻撳簶鍋撶紒妯圭箚妞ゆ牗绻冮鐘裁归悩铏稇妞ゎ亜鍟存俊鍫曞川椤旂虎娲跺┑鐐茬摠缁姵绂嶉鍕靛殨閻犲洤妯婇崥瀣熆鐠轰警鍎戦柛娆忔閺岋絾鎯旈婊呅ｆ繛瀛樼矌閸嬬偟鈧數鍘ч悾婵嬪礋椤掆偓閳ь剙鐏氱换娑㈠醇濠靛牅铏庨梺鍝勵儐閻╊垶寮婚敐澶婂唨鐟滃宕戦姀鈽嗘闁绘劖褰冮弳娆撴煃鐠囨煡鍙勬鐐疵悾鐑藉炊椤掑倸绀堥梻鍌氬€峰ù鍥綖婢舵劕绠氱€光偓閸曨偄鍋嶉梺褰掓？缁€浣哄婵犳碍鐓欓柣鎰靛墯閻忛亶鏌涢顐￠偗闁哄本鐩、鏇㈠Χ閸涱喚浜栭梻浣告啞閿曘垺绂嶇捄浣曟盯宕ㄩ幖顓熸櫇闂侀潧绻嗛埀顒佸墯濡查亶姊绘担鍝ョШ闁逞屽墯缁嬫牠宕楀畝鍕厓鐟滄粓宕滃顒夋僵闁靛⿵闄勫▍鐘充繆閵堝懏鍣瑰鍛存⒑閸涘﹥澶勯柛銊ャ偢瀵偊宕堕浣哄帗闂侀潧顦崕閬嶅汲閸楃偐鏀芥い鏃傚帶濡茬粯銇勯鍕殻濠碘剝鍎肩粻娑㈠即閻樿櫕顔戝┑鐘垫暩閸嬫盯骞婅箛鎾佹椽鎮㈤梹鎰畾闂佹眹鍨绘灙缂佲偓鐎ｎ偁浜滈柡宥庣厛閸ゃ倝鏌嶉崫鍕櫤闁绘挸绻愰…鍧楁嚋閻㈢偣鈧帡鏌ｉ敐鍫ュ摵缂佺粯鐩畷濂告偆娴ｅ湱鏉规繝娈垮枛閿曘劌鈻嶉敐澶婄闁绘ǹ顕ч悘鎶芥煣韫囷絽浜炵憸鏉挎捣缁辨捇宕掑▎鎺戝帯婵犳鍠氶弫濠氬箖瑜斿鎾閳ュ厖鎮ｉ梻浣圭湽閸娿倝宕归浣侯洸鐟滅増甯楅悡娆撴煟閹寸儐鐒界紒鐘崇墵閺岋繝宕ㄩ鍓х杽濠殿喖锕ュ浠嬬嵁閹邦厽鍎熼柨婵嗘川閺嗐倝姊绘担鐑樺殌闁搞垺鐓￠、鏍ㄥ緞閹邦剚妲梺閫炲苯澧柕鍥у楠炴帒顓奸崶褍顬夐柣搴ゎ潐濞叉牠寮甸鍕疄闁靛⿵濡囩弧鈧梺鍛婂姀閺傚倹绂掗姀銈嗏拺闁革富鍙庨崝婊呯磼缂佹绠栧ǎ鍥э躬瀹曞ジ寮撮悙鑼崺婵＄偑鍊栧Λ鍐极椤曗偓瀹曟垿骞樼紒妯衡偓閿嬨亜閹烘垵鈧鎯侀崼銉︹拺闂傚牊绋撶粻鐐烘煕閵婏附銇濈€规洜鏁婚崺鈧い鎺嗗亾闁宠鍨块崺銉╁幢濡炲墽鍑圭紓鍌欑椤戝棝骞戦崶褏鏆︽慨妯挎硾缁犺櫕淇婇妶鍕妽婵炲懏绮嶇换婵嬪閿濆棛銆愬銈嗗灥閹虫﹢宕洪埀顒併亜閹烘垵鈧悂宕㈤幘顔界厸鐎光偓鐎ｎ剛袦濡ょ姷鍋涢澶愬箖濞嗘挸绀冮柍杞扮閹介潧螖閻橀潧浠滅紒缁樺姉閸欏懎顪冮妶鍛闁瑰啿顦甸獮蹇撁洪鍛嫼闂佸憡绋戦敃锕傚煡婢舵劖鐓ラ柡鍥朵簽閻ｇ敻鏌涢埞鍨姕鐎垫澘瀚伴獮鍥敇閻樻彃姹查梻鍌欑閹碱偄煤閿曞倹鏅梻浣告啞濮婂湱鍒掓惔銊ョ劦妞ゆ巻鍋撻柣蹇旇壘椤灝螣鐏忔牕浜炬慨姗嗗幗缁舵煡鏌ｉ敐鍥у幋闁诡喓鍨婚崰濠冩綇閵婏附鐝┑鐘垫暩閸嬬偤宕归崼鏇熷殞濡わ絽鍟板畵渚€鏌涢銈呮灁缂佲檧鍋撶紓浣稿⒔婢ф鎽銈庡亜閿曨亪寮诲☉銏犖╅柨鏃傛櫕閸戯繝姊洪幐搴㈢８闁搞劋绮欏濠氬幢濡ゅ﹤鎮戦梺绯曞墲椤ㄥ懏绔熼幒鎾剁瘈闁汇垽娼ф禒婊勪繆椤愶絿鎳囩€规洖缍婇幃銏ゆ偂鎼达綇绱遍梻浣筋潐瀹曟﹢宕洪弽顓炵獥闁糕剝绋掗悡鏇㈡煛閸ャ儱濡煎褏澧楅妵鍕晜閸濆嫬顫囧┑顔硷攻濡炶棄鐣烽妸锔剧瘈闁告劧绲剧€氬姊绘担钘夊惞闁哥喎娼″鎻掆槈閵忊晜鏅梺鎸庣箓椤︿粙寮崘顔界叆闁哄洦顨呮禍鍓х磽娴ｅ搫鞋鐎规洜鏁稿Σ鎰板箻鐎涙ê顎撻梺鍏肩ゴ閸撴繈宕归悽绋跨厺鐎广儱顦～鍛存煏閸繃顥戦柟閿嬫そ閺岋綁鎮╅崗鍛板焻闂佸憡鏌ㄩ懟顖炲煝瀹ュ绠涢柣妤€鐗忛崢鐢告⒑閸涘﹤鐏熼柛濠冪墱閳ь剚鐔幏锟�     
* parameter:                       
* return:                 
* author:           Luee                                                    
*******************************************************************************/
static void anti_relex_data_process(void)
{
    static Device_t *currentDevice = NULL;
    static DeviceCmd_t *currentCmd = NULL;

    DeviceOnlineHead_t *online = null;

    static u8 online_count=0;
 
    //no meter rec data ,or no online device
    //if(rcveBuf.payload[0]!=METER_ADDR){  
    if(antibuf.payload[0]!=METER_ADDR){    
        return;
    }

    if(online_dev_count==0)
        return;
    else{
        if(++addr_index>=online_dev_count)
            addr_index=0;
        device_addr=online_dev_addr_tab[addr_index];    //闂傚倸鍊搁崐鎼佸磹瀹勬噴褰掑炊椤掑鏅悷婊冪Ч濠€渚€姊虹紒妯虹伇婵☆偄瀚板鍛婄瑹閳ь剟寮诲☉妯锋婵鐗婇弫鎯р攽閻愬弶鍣藉┑顔肩仛缁岃鲸绻濋崶顬囨煕濞戝崬鏋涙繛鍜冪節濮婃椽鏌呴悙鑼跺濠⒀屽櫍閺屾盯鎮㈤崨濠勭▏闂佷紮绲块崗妯讳繆閹间礁鐓涘ù锝嗘そ閻涙捇姊绘担鐑樺殌妞ゆ洦鍙冨畷鎴︽倷閸ㄦ稑褰氶梻鍌氬€峰ù鍥敋瑜庨〃銉╁箹娴ｇǹ鍋嶅┑鐘诧工閻楀棛澹曟繝姘厵闁告挆鍛闂佺粯鎸搁崯浼村箟缁嬪簱鍫柛顐ｇ箘椤︻參姊虹紒妯活梿闁稿鍔曢悾鍨媴閸撹尙鍞甸梺鍏兼倐濞佳勬叏閸儲鐓曢悗锝庝憾閸庢棃鏌＄仦鍓ф创妞ゃ垺娲熸俊鍫曞川椤旈敮鍋撶拠宸富闁靛牆鎳庨銏ゆ煙缁嬪灝鈷旀俊鍙夊姍楠炴鈧稒锚椤庢捇姊洪崨濠冨鞍鐟滄澘鍟村畷婊堟濞戞帗鏂€闂佺粯鍔曞Ο濠偽ｇ憴鍕闁告瑥顦辨晶鐢告煙椤旇棄鍔ら柍瑙勫灴瀹曡精绠涢弮鎴炵秾闂傚倷绶氬褏鎹㈤崱妤婄€剁憸鏃堢嵁韫囨洜纾兼俊顖濆亹椤旀洟姊洪悷鏉库挃妞ゃ儲鍔栫粩鐔肺熼懡銈囶啎闁诲繒鍋涢崐鎼佸焵椤掍胶澧辩紒顔碱儏椤撳ジ宕ㄩ崒娑欘棃鐎规洏鍔戦、娆撳箚瑜嶇粻濠氭⒒娴ｇ瓔鍤欏Δ鐘登归敃銏℃綇閵婏箑寮块梺姹囧灩閻忔岸宕楀⿰鍏炬棃鏁愰崨顓熸闂佺粯鎸搁崯鎵閹惧瓨濯撮柤娴嬪墲閸ㄧ敻鎮炬搴濇勃缂備降鍨洪鏃堟⒑缂佹ê濮囨俊顖氾躬瀹曟洟寮崼鐔哄幐婵炶揪绲挎灙闁逞屽墮濞硷繝鐛崘顔肩鐟滃苯鈻介鍫熺參婵☆垳灏ㄧ槐鐐烘煏婢跺棙娅嗛柍閿嬪浮閺屾稓浠﹂崜褎鍣梺绋跨箰閻ジ鎯€椤忓牜鏁囬柣鎰版涧閻撶喖鎮楃憴鍕缂侇喖鐭傞崺鐐哄箣閻橆偄浜鹃柨婵嗗暙婵＄兘鏌涚€ｎ偅宕岀€规洘锕㈤、娆撴偂鎼达絿宕哄┑锛勫亼閸婃牠鎮уΔ鍐ㄥ灊閹兼番鍓崶顒夋晬婵炴垶姘ㄩ鏇㈡⒑閸︻厼浜炬繛鍏肩懇閹偠銇愰幒鎾跺幈闁诲函缍嗛崑鍛暦瀹€鍕厸鐎光偓鐎ｎ剛锛熸繛瀵稿缁犳挸鐣峰⿰鍡╂Ъ闂佸憡甯楅惄顖氼潖閻戞ɑ濮滈柟娈垮枛婵′粙姊洪崨濠冣拹闁荤喆鍎甸幃鎯х暋闁附寤洪梺閫炲苯澧ǎ鍥э躬楠炴牗鎷呴懖婵勫妽閵囧嫰寮崼鐔告闂佺ǹ顑嗛幑鍥箹瑜版帩鏁冮柕鍫濇川濡插洭姊绘担鍦菇闁搞劏妫勯…鍥樁闁愁亝鎸冲缁樻媴閸涢潧缍婇、鏍幢濞戞顔夐梺鎼炲労閸撴瑩鎷戦悢鍏肩厽闁哄啫娲﹂鐘电棯閹佸仮闁哄本娲濈粻娑㈠即閻愭劧缍侀弻锝堢疀閹捐泛鈪靛┑顔硷功缁垶骞忛崨鏉戞闁靛牆顦卞畷顏堟⒒娴ｅ懙褰掓晝閵壯勫床闁割偅绻嶉崵鏇㈡偣閸パ勨枙闁告艾顑夐弻娑㈩敃椤愵澀绨煎銈呴椤﹂潧顫忕紒妯诲闁绘垶锚濞堝矂姊洪幖鐐测偓鏍偋閻樿崵宓侀煫鍥ㄧ⊕閺呮悂鏌ㄩ悤鍌涘
    }
	       
    APP_DEBUG("MODBUS_DATA_GET\r\n");
    //print_buf(antibuf.payload,antibuf.lenght);         
    modbus_wr2_t *modbus_buf=(modbus_wr2_t *)antibuf.payload;
    APP_DEBUG("modbus_buf->fun=%d modbus_buf->addr=%d \r\n",modbus_buf->fun,modbus_buf->addr);

    modbus_rd_response_t *meter_rec_buf=(modbus_rd_response_t *)antibuf.payload;
    u8 *send_buf=memory_apply(25);
    r_memset(send_buf,'\0',25);
    modbus_wr_t *anti_send_buf=(modbus_wr_t *)send_buf;
    APP_DEBUG("meter_rec_buf->fun=%d meter_rec_buf->addr=%d meter_rec_buf->bytes=%d \r\n",meter_rec_buf->fun,meter_rec_buf->addr,meter_rec_buf->bytes);

    //send_buf =(u8 *)anti_send_buf+7;
    //antibuf.payload =(u8 *)meter_rec_buf+3;
    //r_memcpy(send_buf,antibuf.payload,meter_rec_buf->bytes);    //闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁炬儳缍婇弻鐔兼⒒鐎靛壊妲紒鐐劤濠€閬嶅焵椤掑倹鍤€閻庢凹鍙冨畷宕囧鐎ｃ劋姹楅梺鍦劋閸ㄥ綊宕愰悙宸富闁靛牆妫楃粭鎺撱亜閿斿灝宓嗙€殿喗鐓￠、鏃堝醇閻旇渹鐢绘繝鐢靛Т閿曘倝宕悧鍫熸珡濠电姷鏁告慨顓㈠磻閹剧偨鈧帒顫濋敐鍛婵犳鍠栭敃銊モ枍閿濆洦顫曢柟鐑樺殾閻斿吋鎯為梺顐ｇ〒缁€鍐ㄢ攽閻樻鏆俊鎻掓嚇瀹曟垿宕熼娑樹壕婵﹩鍘界欢鍙夈亜閺囶亞绉€规洏鍔嶇换婵嬪礋椤撶喎娈為梻鍌欑窔閳ь剛鍋涢懟顖涙櫠鐎电硶鍋撳▓鍨灕妞ゆ泦鍥х叀濠㈣泛谩閻斿吋鐓ラ悗锝呯仛缂嶅苯鈹戦悩鎰佸晱闁哥姵顨婇妴鍐川鐎涙ê浜辨繝鐢靛Т濞层倝寮告笟鈧弻鐔碱敍閸″繐浜鹃梺琛″亾濞寸姴顑嗛悡鐔兼煙闁箑澧紒鐙欏洦鐓曢柨婵嗙墛椤ュ鏌嶇憴鍕伌妞ゃ垺鐟╅幊鏍煛閳ь剛鍒掗悽鐢电＝濞达絽鎽滈悞宄邦渻閺夋垶鎲搁柟骞垮灩閳规垹鈧綆浜為崐鐐差渻閵堝骸澧婚柛搴㈡倐瀹曞爼濡歌楠炲牊绻濋悽闈涗沪闁搞劑娼ч悾鐑筋敆閸曨偄鍤戝┑鐐村灦閻熝呯不妤ｅ啯鐓曟繝濠傚暙閺嗙喓绱掗埦鈧崑鎾寸節濞堝灝鏋涢柨鏇樺劚椤啯绂掔€ｎ亣鎽曢梺鍛婄☉閻°劑宕愰悜鑺ョ厾闁煎湱澧楃涵鐐亜韫囷絽骞楃紒缁樼箞閸╂盯鍩€椤掑倷娌柤鎭掑劤瑜板酣姊绘担鍛婃儓闁哄牜鍓熼幆鍕敍閻愯尙鐣洪梺闈涚箞閸婃洖顔忓┑鍡忔斀闁绘ɑ褰冮顐︽煃鐠囪尙绠绘慨濠勭帛閹峰懏顦版惔婵婎洬缂傚倷鐒﹁ぐ鍐焽閳ュ磭鏆︽俊銈傚亾閾伙綁鎮规担鍝ワ紞缂佺姵宀稿楦裤亹閹烘搫绱电紓浣插亾濞撴埃鍋撻柟顔光偓鏂ユ婵☆垰绻愮紞濠囧极閹版澘骞㈡俊顖炴櫜閾忓酣姊绘担铏瑰笡缂佸甯￠獮鎴﹀炊瑜滃鏍磽娴ｈ偂鎴炲垔閹绢喗鐓熼柟瀵镐紳椤忓嫧鏋旈悘鐐电摂濞撳鏌曢崼婵囶棡濠㈣泛瀚伴弻娑樷枎韫囨挻娈梺浼欑悼閸忔﹢鐛€ｎ喗鏅滈柦妯侯槴閸嬫捇鎮滈懞銉у幈闂侀潧饪垫俊鍥煡婢跺本鍠愰柣妤€鐗嗛崫鐑樻叏婵犲偆鐓肩€规洘甯掗～婵嬵敄閽樺澹曢悗鐟板閸ｇ銇愰幒鎴犲€炲銈嗗笒椤︿即寮查鍫熷仭婵犲﹤鍟撮崣鍕煏閸℃鏆ｅ┑锛勫厴閸┾剝鎷呮笟顖氭櫍婵犵數鍋犻幓顏嗗緤閹稿海浠氶梻浣呵归鍛矓閹绢喖鐓橀柟杈鹃檮閸嬫劙鎮归崶鍥у暕缁憋綁姊绘担铏瑰笡妞ゃ劌鎳庤灋婵炴垶鐟ч悵鍫曟煛閸モ晛鏋旂紒鈾€鍋撴繝娈垮枟閿曗晠宕㈡ィ鍐ㄥ偍闁汇垹鎲￠埛鎴︽煕濞戞﹫鏀婚悗鍨懇閺屾稑鈽夐崡鐐茬濡炪倖鍔曢妶绋款潖缂佹ɑ濯撮柧蹇曟嚀缁楋繝姊虹憴鍕憙妞ゆ泦鍛疾闂備胶绮濠氬储瑜旈幏鎴︽偄閸忚偐鍙嗛梺缁樻煥閹碱偄鐡梻浣虹帛閸旀洟鏁冮鍫濊摕闁哄洨鍠庣欢鐐烘煕椤愶絿绠撳┑顔奸椤啴濡舵惔鈥愁潻闂佺粯顨呴敃锕傚箲閵忕姭鏀介悗锝庝簽閸橀亶姊洪柅鐐茶嫰婢ф澘霉閻欏懐鐣甸柟宕囧仱婵＄柉顦遍梺顓у灦濮婂宕掑顑藉亾缁嬫５娲Χ婢癸箑娲幃鐣岀矙閼愁垱鎲伴梻浣瑰缁诲倿骞忕€ｎ亶鐒介柕濞炬櫆閻撳啰鎲稿⿰鍫濈婵炲棙鎸撮埀顒婄畵瀹曞爼顢斿鍡忔瀸闂佽姘﹂～澶娒哄Ο鍏煎床闁告洦鍨伴悞鍨亜閹烘埊鍔熺紒澶屾暬閺屾盯骞樼€垫悶鈧帒顭跨憴鍕闁硅櫕鐗犻崺锟犲礃椤忓海闂繝鐢靛仩閹活亞绱為埀顒併亜閺囩喓澧甸柟顔惧仦缁傛帞鈧綆鍋嗛崢鎾愁渻閵堝棛澧紒瀣笧缁牓宕橀鍡欙紲缂傚倷鐒﹂…鍥洪幘顔界厵妞ゆ梻鎳撴晶鏌ユ煙椤栨稒顥堥柡浣瑰姍瀹曞墎鎹勯悜妯荤彣闂傚倷娴囬褍顫濋敃鍌︾稏濠㈣泛鈯曢崫鍕庣喖鎮℃惔锛勪喊闂傚⿴鍋勫ú锕傛憘鐎ｎ喖鐐婃い鎺嗗亾闁藉啰鍠栭弻鏇熷緞濞戞﹩娲梺鍛婏耿娴滆泛顫忛搹鍏夊亾閸︻厼校闁靛棗鍟撮弻銈夊礃閼碱剙鐓熼梺璇″枤閸嬨倕鐣烽妸锔剧瘈闁告劑鍔屾导搴♀攽閻樺灚鏆╁┑顔芥尦瀹曨垶顢涢悙鍙傦附绻濋棃娑氬闁稿鎸鹃幉鎾礋椤掆偓椤︹晠姊虹粙娆惧剰闁挎洏鍎茬粚杈ㄧ節閸ャ劌鈧鏌﹀Ο鐚寸礆闁靛ň鏅滈悡銉╂煛閸愩劎澧涢柡鍡樼矒閺屾稓鈧綆鍋呭畷灞俱亜閵忊槄鑰垮┑顔瑰亾闂佹娊鏁崑鎾绘煙闁垮銇濇慨濠冩そ瀹曘劍绻濋崟銊︻潔闂備焦瀵уú蹇涘磿閻㈢ǹ鏄ユ繛鎴欏灩缁犳盯鏌ｅΔ鈧悧蹇涘储闁秵鈷戦梻鍫熻儐瑜版帒纾块柧蹇ｅ亞椤╃兘鏌曡箛瀣偓鏍偂閻斿吋鐓ユ繝闈涙閸ｈ淇婇幓鎺濈吋闁诡噯绻濇俊鍫曞幢閹邦亞鐩庨梻濠庡亜濞诧箓骞愰幖渚囨晜妞ゆ劧闄勯悡鏇㈡煛閸愨晜灏甸柣锝堥哺閵囧嫰顢旈崟顐ｆ婵犵鈧磭鍩ｇ€规洖宕灃闁告劦浜濋崯浼存⒒閸屾艾鈧悂宕愰崫銉㈠亾濮樼厧澧扮紒顔芥閹粙鎮介悽鐢靛姽闁诲骸绠嶉崕閬嶅箠婢舵劕閱囨い蹇撶墛閻撴洘銇勯幇鈺佲偓鏇㈠几閺冨牊鐓曟俊顖氬悑閺嗩剚鎱ㄦ繝鍐┿仢鐎规洏鍔嶇换婵嬪礋椤撶姵娈奸梻浣筋嚙鐎涒晠宕欒ぐ鎺戠煑闁告劦鍘介敍鍌涚節閻㈤潧孝闁挎洏鍊濆畷銏°偅閸愨晛浠梺褰掓涧閸熷潡鎮у鑸碘拺闁告挻褰冩禍鏍煕閵娿儺鐓肩€殿喗濞婇、鏇㈠煑閳哄倹鏉告俊鐐€栧濠氬Υ鐎ｎ喖缁╃紓浣姑肩换鍡涙煟閹邦垰鐓愭い銉ヮ樀閺岋綁鏁愰崶褍骞嬪銈冨灪濞茬喖寮崘顔肩劦妞ゆ巻鍋撻柡渚囧櫍濮婄粯绗熼埀顒€顭囪绡撻柍褜鍓欓埞鎴﹀灳閾忣偄鏋犻梺绯曟杹閸嬫挸顪冮妶鍡楃瑐缂佲偓娓氣偓瀹曟繈濡舵径瀣帗闁荤喐鐟ョ€氼剟鎮橀幘顔界厵妞ゆ梻鏅幊鍥殽閻愬瓨宕屾鐐村浮楠炴﹢寮妷銉ゅ濡炪倖鐗滈崑鐐哄煕閹达附鐓犲┑顔藉姇閳ь剚娲熷鎶芥焼瀹ュ棛鍘搁梺鍛婁緱閸ㄤ即鍩㈤崼婵冩斀闁炽儱纾幗鐘绘煙瀹勭増鍤囩€规洘绮撳畷锝嗗緞婵犲倸甯梻鍌氬€峰ù鍥磻閹邦厾浠氶梻浣筋嚙缁绘垿鎳濇ィ鍐ㄧ厺鐎广儱鎳夐崼顏堟煕閺囥劌骞橀柣锕€鐗撳娲濞戙垻宕紓浣藉紦缁瑩骞冮敓鐘茬疀闁绘鐗嗛悵鏃堟⒒娓氬洤澧紒澶屾暬閹€斥槈閵忥紕鍘卞┑鐐村灥瀹曨剟寮搁妶鍥╃＜闁绘﹢娼ф禒锕傛煙娓氬灝濡界紒缁樼箞瀹曟﹢鍩炴径姝屾濠德板€楁慨鐑藉磻閻愬搫绀夐柡宥庡幖缁犳岸鏌￠崘銊у妞ゎ偄鎳橀弻宥夊传閸曨偀鍋撻悽绋跨闁告侗鍘搁弨浠嬫煟濡椿鍟忛柡鍡╁灡娣囧﹪骞撻幒鎾虫畻閻庤娲橀崹鍨暦閻旂⒈鏁囨繛鎴灻兼竟鏇炩攽椤旂瓔鐒介柛妯犲洨宓佹俊顖濆亹绾惧吋銇勯弮鍌楁嫛闁稿骸绻戦妵鍕箻閸愬弶鍊悗鍨緲鐎氼噣鍩€椤掑﹦绉甸柛鎾寸懄閹便劑骞栨担鍦幗闁硅壈鎻槐鏇㈡偩椤撱垺鐓曢幖绮光偓瀹犲煘闁捐崵鍋熼埀顒€鍘滈崑鎾绘煕閺囥劌浜炴い鏂挎閳规垿鎮欓崣澶嗘灆婵炲瓨绮嶇换鍫ュ春濞戙垹绠ｉ柨鏃傛櫕閸樺崬鈹戦悙鏉戠仸闁挎洦鍋婂銊︾節濮橆厼鈧爼鐓崶銊︾叆妞ゃ儱顑夐弻鐔煎矗婢跺鈧劗鈧鍠栭悥鐓庣暦瑜版帩鏁婇柤鎭掑労閸炲湱绱撻崒姘偓椋庣矆娓氣偓瀹曟劙宕妷褏鐓嬮梺鍦檸閸犳牠鎮″鈧弻鐔告綇閸撗呮殸闂備礁宕ú顓㈠蓟閺囷紕鐤€闁挎繂妫涚粣娆戠磽娴ｄ粙鍝洪柣鎾偓鎰佹綎婵炲樊浜濋崵鎺楁煏閸繃鍟楅柕蹇ョ磿缁犻箖鎮归崶鍥ф噽閺嗐垽姊洪棃娑欏闁告梹鐟ラ悾宄邦潨閳ь剟銆佸璺哄窛妞ゆ棁濮ら悵鏇炩攽閿涘嫬浜奸柛濠冪墵楠炴劖銈ｉ崘銊э紱闂佸湱澧楀妯肩磼閳轰急褰掓偐瀹割喖鍓遍梺缁樻尭閸熸挳寮婚弴鐔风窞闁割偅绻傛慨銏ゆ⒑閹稿海鈽夌紒澶婄秺瀵鈽夐姀鐘靛幐闁诲函缍嗛崜娑溾叺闂傚倷绀侀幖顐ｅ緞閸ヮ剙绀堟繝闈涱儏缁狀垶鏌涘☉鍗炵仭闁哥姴妫濋弻娑㈠即閵娿儰绨介梺鎸庣⊕閹瑰洤顫忕紒妯诲闁兼亽鍎埀顒€鍟撮弻锝夊箳閻愮數鏆ゅΔ鐘靛仦閸ㄥ灝鐣烽崼鏇ㄦ晢闁逞屽墴瀵憡绗熼埀顒勫蓟閻旂厧绀堢憸蹇曟暜濞戙垺鐓涢柛娑卞枟閸婃劙鏌＄仦璇插闁诡喓鍊濆畷鎺戔槈濮楀棔绱�
    r_memcpy(&anti_send_buf->bytes+1,&meter_rec_buf->bytes+1,meter_rec_buf->bytes);
    
    float a=IEEE754_to_Float(&anti_send_buf->bytes+1);
    float b=IEEE754_to_Float(&anti_send_buf->bytes+5);
    float c=IEEE754_to_Float(&anti_send_buf->bytes+9);
    float t=IEEE754_to_Float(&anti_send_buf->bytes+13);
    APP_DEBUG("A POWER=%f KW\r\n",a);
    APP_DEBUG("B POWER=%f KW\r\n",b);
    APP_DEBUG("C POWER=%f KW\r\n",c);
    APP_DEBUG("T POWER=%f KW\r\n",t);

    //any one >=anti_threshold
    if(a>anti_threshold && b>anti_threshold && c>anti_threshold && t>anti_threshold){
        meter_data_sent=0;
        anti_refluxing=0;       //turn off anti refulx running
        APP_DEBUG("no over anti reflux threshold\r\n")
        return;
    }

    //turn on anti reflux running
    if(anti_refluxing==0){
        anti_refluxing=1;
        counter=REALTIME_METER_READ_COUNTER_REFLUX;
    }
    
    anti_send_buf->addr=device_addr;          
    anti_send_buf->fun=MODBUS_RTU_FUN_WR;
    anti_send_buf->st_addr=ENDIAN_BIG_LITTLE_16(ANTI_REFLUX_REG_ADDR);
    anti_send_buf->num= ENDIAN_BIG_LITTLE_16(8);
    anti_send_buf->bytes=meter_rec_buf->bytes;
    anti_send_buf->crc16=crc16_standard(CRC_RTU,(u8_t *)anti_send_buf,sizeof(modbus_wr_t)-sizeof(anti_send_buf->crc16));
    //Uart_write((u8_t *)send_buf, sizeof(modbus_wr_t));
    
    anti_trans((u8_t *)send_buf, sizeof(modbus_wr_t));
    r_memset(antibuf.payload,0,sizeof(modbus_rd_response_t));
    APP_DEBUG("send anti reflux data\r\n");
    memory_release(send_buf);
}

 /*          
            if((modbus_buf->fun & MODBUS_RTU_FUN_ER) == MODBUS_RTU_FUN_ER){
                //闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁炬儳缍婇弻鐔兼⒒鐎靛壊妲紒鐐劤缂嶅﹪寮婚悢鍏尖拻閻庨潧澹婂Σ顔剧磼閻愵剙鍔ょ紓宥咃躬瀵鎮㈤崗灏栨嫽闁诲酣娼ф竟濠偽ｉ鍓х＜闁绘劦鍓欓崝銈嗙節閳ь剟鏌嗗鍛姦濡炪倖甯掗崐褰掑吹閳ь剟鏌ｆ惔銏犲毈闁告瑥鍟悾宄扮暦閸パ屾闁诲函绲婚崝瀣уΔ鍛拺闁革富鍘奸崝瀣煕閵娿儳绉虹€规洘鍔欓幃娆忣啅椤旇棄鐦滈梻渚€娼ч悧鍡椢涘Δ鍛敜濠电姴娲﹂悡鏇㈡倵閿濆骸浜濋悘蹇曞缁绘盯鎳濋柇锕€娈梺瀹狀潐閸ㄥ綊鍩€椤掑﹦绉甸柛瀣у亾闂佸綊鏀卞钘夘潖缂佹鐟归柛銉戝倻鏁栭梻浣呵归鍡涙儎椤栫偛绠犻柣鏃傗拡閺佸秵绻涢幋鐐垫噭闁绘繄鍏樺娲捶椤撯剝顎楅梺鍝ュУ椤ㄥ﹪骞冮垾鏂ユ闁靛繆鈧枼鍋撻崼鏇熺厽闁归偊鍘肩徊濠氭煃闁垮顥堥柡灞炬礋瀹曞崬螣閻戞ǹ鐧侀梻浣告惈閼活垳绮旈悜閾般劍绗熼埀顒勫蓟濞戙垹绠婚柛妤冨仜椤绱撴担鎴掑惈闁稿鍊曢悾鐑藉础閻愨晜顫嶅┑鈽嗗灣閵嗗妲愰柆宥嗏拻濞达絽鎲￠崯鐐层€掑顓ф疁鐎规洏鍨洪妶锝夊礃閵婏箒绶㈤梻浣瑰濡啴寮鈧畷鎴﹀箻鐠囪尙顦ф繝銏ｆ硾閿曪絾绔熼弴銏♀拻濞达絽鎲￠崯鐐寸箾鐠囇呯暤鐎规洘绮岄埥澶愬閻樻彃浜堕梻鍌氬€搁悧濠冪瑹濡も偓閵嗘帗绻濆顓犲帾闂佸壊鍋呯换鍐夐悙娣簻闁靛鍎查ˉ銏ゆ煛鐏炲墽銆掗柍褜鍓ㄧ紞鍡涘磻閸曨剚鍙忓璺虹灱绾惧吋銇勯弮鍥撴い銉ョ墦閺岀喖鎮℃惔锝囆ㄩ悗瑙勬礃椤ㄥ棗顕ラ崟顒傜瘈濞达絽澹婂Λ婊堟⒒娴ｈ棄鍚归柛鐘冲姍閹兘濡疯閸嬫挸顫濋悡搴＄閻庡灚婢樼€氭澘鐣烽悢纰辨晬婵炴垶鑹鹃獮鍫ユ⒑鐠囨彃鍤辩紓宥呮缁傚秴鐣￠柇锕€鏅犻梺闈涱槴閺呮粓鎮￠悢鍏肩叆婵犻潧妫欓幖鎰版煕濡粯灏﹂柡宀€鍠栭、娆撳传閸曨厺绱曢梻浣告憸婵挳鏁冮妷銉劷闊洦绋戞儫闂佹寧姊婚弲顐ャ亹瀹ュ應鏀介柣妯虹仛閺嗏晠鏌涚€ｎ剙鈻堟鐐存崌椤㈡棃宕卞Δ鍐摌闂備礁婀辨灙婵炴挳鏀辩粋鎺戭潩椤戣姤鏂€闂佺粯锕╅崰鏍倶椤曗偓閺岀喖鎼归锝呮殫缂備緡鍠楀Λ鍐箖閻戣姤鐒介柨鏃傛櫕缁嬩礁鈹戦悩鍨毄濠殿喚鏁婚幊婵嬪礈瑜嶉ˉ姘舵煕韫囨艾浜圭紒鐘荤畺閺屾盯鍩勯崗鐙€浜炵划顓㈠箳濡や胶鍘卞┑顔筋殔閻楀繒澹曠捄銊х＜閺夊牄鍔嶇亸鎵磼濡ゅ啫鏋涚€规洘鍎奸ˇ鎶芥煟濠垫劕娅嶆慨濠冩そ楠炴牠鎮欓幓鎺濈€抽梻浣虹帛閻楁洟濡堕幖浣哥畺濞村吋鎯岄弫瀣煃瑜滈崜鐔兼偘椤曗偓瀹曞爼顢楅埀顒傜棯瑜旈幃瑙勭瑹椤栨粌甯ラ梺鍝ュ枎濞层倝鍩為幋锔藉€烽柤鎼佹涧濞懷呯磽娴ｈ棄绱︾紒顔界懇閻涱喖螖閳ь剟銈导鏉戦唶闁绘柨鎲￠悵顐ｇ節閻㈤潧浠滄俊顐ｇ懇瀹曟繂螖閸愩劌袣闂侀€炲苯澧存慨濠傛惈鏁堥柛銉戝懍绱欐繝鐢靛仒閸栫娀宕熼鐐╁彏闂傚倸鍊搁崐鐑芥嚄閸洖鍌ㄧ憸蹇曟閻愬绡€闁告洦鍘虹粭澶愭⒑閸濆嫮鈻夐柛妯垮亹缁寮介鐔哄幗闂佸綊鍋婇崜姘跺箚閸儲鐓曢柕濞垮劚閳ь剙缍婃俊鐢稿礋椤栨氨鐤€濡炪倖鏌ㄩ妵娆撴晬閸曨厾锛滈梺闈浨归崕娲偂閸忓吋鍙忓┑鐘插暞閵囨繈鏌熼鎯у幋闁诡啫鍥ч唶闁绘柨鍢叉竟宥囩磽閸屾艾鈧绮堟笟鈧棟妞ゆ牗绋掑▍鐘诲箹濞ｎ剙濡肩紒鐙€鍨堕幃宄扳枎韫囨搩浠煎銈嗘礋娴滃爼骞冨Δ鈧埥澶娾枎濡厧濮洪梻浣告啞閿曘垺绂嶇捄渚綎闁惧繐婀辩壕鍏间繆椤栨稒銇熸俊顐㈠暙椤啴濡堕崘銊ュ闂佸湱枪婢т粙宕氶幒鏃傜＜婵☆垵鍋愰惁鍫濃攽椤旀枻渚涢柛姗€绠栧畷銏ゅ箹娴ｅ湱鍘介棅顐㈡处濞叉牗绂掑⿰鍐剧唵鐟滄垵螞閸曨厼寮查梻浣告贡閾忓酣宕板Δ鍛亗婵炲棙鍔戞禍婊堟煛閸愩劍绁╂繛鍏煎姈缁绘盯宕ㄩ鐔锋畻闂佸搫鐭夌紞渚€寮幇鏉跨倞鐟滃秹鐛€ｎ喗鍊甸悷娆忓缁€鍐煕鎼绰板仮閽樻繃銇勯弴妤€浜鹃梺鍝勭灱閸犳牠骞楁惔銊ョ＜婵﹩鍓涢妶顕€姊绘担鍛婃儓闁活厼顦卞濠冦偅閸愩劎鐣鹃梺鍝勫暙閻楀棗娲块梺鐟板悑閻ｎ亪宕归懡銈囩煋闂佸灝顑囩弧鈧梺姹囧灲濞佳勭濠婂應鍋撳▓鍨灈闁绘牕銈稿顐﹀礃椤旂⒈娼婇梺缁樏悘姘枔閹€鏀介柣妯肩帛濞懷勪繆椤愩垻鐒哥€殿喖鎲￠幆鏃堝Ω閿旀儳骞嶉梻浣侯攰椤宕濋弽顐ｅ厹闁告挆鍛紲婵炴挻鑹鹃敃锕傛偩閸偅鍙忓┑鐘插暞閵囨繄鈧娲﹂崑濠傜暦閻旂⒈鏁囧璺鸿嫰閳诲牓鏌＄仦鍓ф创鐎殿噮鍓涢幑鍕Ω閹板墎绉柡灞剧洴楠炴帡骞嬮婵嗘儓婵°倗濮烽崑鐐烘晝閵忋們鈧礁鈻庨幘鏉戜患闁诲繒鍋犲Λ鍕不濞差亝鈷掗柛灞剧懆閸忓瞼绱掗鍛仩妞ゎ偄绻戠换婵嗩潩椤掑倸骞堥梻浣稿閸嬩線宕曢崡鐐愌囧蓟閵夛妇鍘甸梺缁樺灦閿曗晛鈻撻弴銏＄厽闁规儳鐡ㄧ粈瀣煛瀹€鈧崰鎾诲焵椤掍胶鈯曟い顓炴喘閹苯鐣濋崟顒傚幗濡炪倖鎸鹃崰鎾诲箠閸曨垱鐓欏〒姘仢婵＄晫绱掔紒妯肩疄鐎规洜鍠栭、姗€鎮欏▓鍨还闂傚倸鍊烽懗鍫曞箠閹捐搴婇柡灞诲劚缁犵娀鏌熼柇锕€鏋涢柛銊︾箖缁绘盯宕卞Δ鍐暰闂佸搫顑呴柊锝夊蓟閿濆绠涢梻鍫熺☉閳锋帒鈹戦埥鍡椾簻缂佺粯锚椤繑绻濆顒傦紲濠电偛妫欑敮鎺楀储閿熺姵鐓涢悗锝呭悁缁ㄥジ鏌曢崶褍顏鐐差儏閳规垿宕惰閻ｇ粯淇婇妶鍥ラ柛瀣洴閺佸啴濡烽埡浣虹暰闂佸搫鍟悧濠囧疾閺屻儲鐓曟繛鎴濆船楠炴﹢鏌＄仦鐔锋处閳锋帡鏌涚仦鎹愬闁逞屽墴椤ユ挾鍒掗崼鐔虹懝闁逞屽墴閻涱噣寮介褎鏅濋梺闈涚墕濞层劑鎮￠幘瀵哥闁圭偓娼欓悞褰掓煕鐎ｎ偅灏甸柍褜鍓濋～澶娒哄鈧畷褰掑垂椤旂偓娈鹃梺鍛婎殘閸婏綁鎮㈡潪鎵墾闂佸搫绉查崝搴㈢濞嗘挻鈷戦悹鍥ㄧ叀椤庢绱掗悩鑼х€规洘娲熼弻鍡楊吋閸涱垳鏆梻浣稿悑閸撴岸宕归浣侯洸鐟滅増甯楅悡娆撴煟閹寸倖鎴犱焊椤撶伝鐟扳堪閸曞灚鐤侀梺鍝勭灱閸犳牠骞婂┑瀣亱闁割偅绻冮柨顓犵磽閸屾瑧鍔嶉柣鎿勭磿缁寮介鐘茬ウ婵犮垼娉涢鍥⒔閸曨垱鐓曟繛鎴炩槈閸儱绠柧蹇撴贡绾句粙鏌涚仦鍓ф噮闁告柨绉归幏鎴︽焼瀹ュ棗鈧爼鐓崶銊︾妞わ綀鍋愮槐鎺旂磼濡吋鍒涢梺鐟扮－婵炩偓妞ゃ垺顨婇崺鈧い鎺戝閸戠姵绻涢幋鐐茬劰闁稿鎸搁埢鎾诲垂椤旂晫浜俊鐐€ら崢濂稿床閺屻儺鏁嬮柨婵嗩槸缁犵粯銇勯弮鍥棄濞存粍绮嶆穱濠囨倷瀹割喖鍓板┑鐐差嚟閸忔﹢骞冩导鎼晩闁伙絽鐬奸惁鍫㈢磼閸撗冾暭閽冭鲸銇勯顫含闁哄本鐩俊鎼佸煛閸屾盯鏁梻浣哥枃椤曆呯矓瑜版帒鏋侀柟鐗堟緲楠炪垺绻涢崱妯曟垹绮婇銈囩＝闁稿本鐟чˇ锔姐亜閹存繃鍣介柤娲憾閺屽棗顓奸崨顖氭憢濠电偛顕慨鎾敄閸℃稒鍋傞柕澶涘缁犻箖鏌熺€甸晲绱虫い蹇撶墱閺佸倹銇勯幒宥嗩樂缂佽妫濋弻锝夊箛闂堟稑顫梺绋匡攻閸旀瑩寮婚敍鍕勃闁告挆鍕灡闂備浇顕栭崰鎺楀疾濞戙垺鍋╅柣鎴ｆ閻愬﹦鎲告径鎰濞寸厧鐡ㄩ埛鎺懨归敐鍫燁仩闁靛棗锕弻锟犲川椤斿墽鐤勯悗瑙勬礃閸ㄦ寧淇婇懜闈涚窞閻忕偟鏅妶锕傛⒑鐠囨彃鍤辩紓宥呮瀹曟澘螖閸涱厾鏌у┑鐘诧工閹虫劗澹曢挊澹濆綊鏁愰崼婵呯暗闂佺懓鐡ㄧ缓楣冨几瀹ュ鐓涢柛鎰╁妿婢ф盯鏌嶉柨瀣瑨闂囧鏌ㄥ┑鍡欏妞ゅ繒濞€閺屾洟宕卞Δ瀣惈闂佸搫鏈惄顖炵嵁濡皷鍋撻棃娑欐喐闁汇倕瀚板鐑樻姜閹殿噮妲銈嗗灥閹虫﹢鍨鹃弮鍫濈妞ゆ柨妲堣閺屾稑鈽夊鍡楁閻庤娲︽禍顏勵潖濞差亝鍋￠柡澶嬪椤斺偓闂備胶鎳撻崵鏍箯閿燂拷
            }else{
                
                if(modbus_buf->fun==MODBUS_RTU_FUN_RD){
                    modbus_rd_response_t *meter_rec_buf=(modbus_rd_response_t *)antibuf.payload;
                    APP_DEBUG("meter_rec_buf->fun=%d meter_rec_buf->addr=%d meter_rec_buf->bytes=%d \r\n",meter_rec_buf->fun,meter_rec_buf->addr,meter_rec_buf->bytes);
                    //u8 send_buf[25]={0};
                    u8 *send_buf=fibo_malloc(25);
                    modbus_wr_t *anti_send_buf=(modbus_wr_t *)send_buf;
                    if(modbus_buf->addr==METER_ADDR && meter_rec_buf->bytes>=2 && meter_rec_buf->bytes<=16){
                        
                        APP_DEBUG("get meter data success\r\n");
                        //print_buf(antibuf.payload,sizeof(antibuf.payload));

                        send_buf +=7;
                        //meter_rec_buf+=3;
                        antibuf.payload +=3;
                        r_memcpy(send_buf,antibuf.payload,meter_rec_buf->bytes);    //闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁炬儳缍婇弻鐔兼⒒鐎靛壊妲紒鐐劤濠€閬嶅焵椤掑倹鍤€閻庢凹鍙冨畷宕囧鐎ｃ劋姹楅梺鍦劋閸ㄥ綊宕愰悙宸富闁靛牆妫楃粭鎺撱亜閿斿灝宓嗙€殿喗鐓￠、鏃堝醇閻旇渹鐢绘繝鐢靛Т閿曘倝宕悧鍫熸珡濠电姷鏁告慨顓㈠磻閹剧偨鈧帒顫濋敐鍛婵犳鍠栭敃銊モ枍閿濆洦顫曢柟鐑樺殾閻斿吋鎯為梺顐ｇ〒缁€鍐ㄢ攽閻樻鏆俊鎻掓嚇瀹曟垿宕熼娑樹壕婵﹩鍘界欢鍙夈亜閺囶亞绉€规洏鍔嶇换婵嬪礋椤撶喎娈為梻鍌欑窔閳ь剛鍋涢懟顖涙櫠鐎电硶鍋撳▓鍨灕妞ゆ泦鍥х叀濠㈣泛谩閻斿吋鐓ラ悗锝呯仛缂嶅苯鈹戦悩鎰佸晱闁哥姵顨婇妴鍐川鐎涙ê浜辨繝鐢靛Т濞层倝寮告笟鈧弻鐔碱敍閸″繐浜鹃梺琛″亾濞寸姴顑嗛悡鐔兼煙闁箑澧紒鐙欏洦鐓曢柨婵嗙墛椤ュ鏌嶇憴鍕伌妞ゃ垺鐟╅幊鏍煛閳ь剛鍒掗悽鐢电＝濞达絽鎽滈悞宄邦渻閺夋垶鎲搁柟骞垮灩閳规垹鈧綆浜為崐鐐差渻閵堝骸澧婚柛搴㈡倐瀹曞爼濡歌楠炲牊绻濋悽闈涗沪闁搞劑娼ч悾鐑筋敆閸曨偄鍤戝┑鐐村灦閻熝呯不妤ｅ啯鐓曟繝濠傚暙閺嗙喓绱掗埦鈧崑鎾寸節濞堝灝鏋涢柨鏇樺劚椤啯绂掔€ｎ亣鎽曢梺鍛婄☉閻°劑宕愰悜鑺ョ厾闁煎湱澧楃涵鐐亜韫囷絽骞楃紒缁樼箞閸╂盯鍩€椤掑倷娌柤鎭掑劤瑜板酣姊绘担鍛婃儓闁哄牜鍓熼幆鍕敍閻愯尙鐣洪梺闈涚箞閸婃洖顔忓┑鍡忔斀闁绘ɑ褰冮顐︽煃鐠囪尙绠绘慨濠勭帛閹峰懏顦版惔婵婎洬缂傚倷鐒﹁ぐ鍐焽閳ュ磭鏆︽俊銈傚亾閾伙綁鎮规担鍝ワ紞缂佺姵宀稿楦裤亹閹烘搫绱电紓浣插亾濞撴埃鍋撻柟顔光偓鏂ユ婵☆垰绻愮紞濠囧极閹版澘骞㈡俊顖炴櫜閾忓酣姊绘担铏瑰笡缂佸甯￠獮鎴﹀炊瑜滃鏍磽娴ｈ偂鎴炲垔閹绢喗鐓熼柟瀵镐紳椤忓嫧鏋旈悘鐐电摂濞撳鏌曢崼婵囶棡濠㈣泛瀚伴弻娑樷枎韫囨挻娈梺浼欑悼閸忔﹢鐛€ｎ喗鏅滈柦妯侯槴閸嬫捇鎮滈懞銉у幈闂侀潧饪垫俊鍥煡婢跺本鍠愰柣妤€鐗嗛崫鐑樻叏婵犲偆鐓肩€规洘甯掗～婵嬵敄閽樺澹曢悗鐟板閸ｇ銇愰幒鎴犲€炲銈嗗笒椤︿即寮查鍫熷仭婵犲﹤鍟撮崣鍕煏閸℃鏆ｅ┑锛勫厴閸┾剝鎷呮笟顖氭櫍婵犵數鍋犻幓顏嗗緤閹稿海浠氶梻浣呵归鍛矓閹绢喖鐓橀柟杈鹃檮閸嬫劙鎮归崶鍥у暕缁憋綁姊绘担铏瑰笡妞ゃ劌鎳庤灋婵炴垶鐟ч悵鍫曟煛閸モ晛鏋旂紒鈾€鍋撴繝娈垮枟閿曗晠宕㈡ィ鍐ㄥ偍闁汇垹鎲￠埛鎴︽煕濞戞﹫鏀婚悗鍨懇閺屾稑鈽夐崡鐐茬濡炪倖鍔曢妶绋款潖缂佹ɑ濯撮柧蹇曟嚀缁楋繝姊虹憴鍕憙妞ゆ泦鍛疾闂備胶绮濠氬储瑜旈幏鎴︽偄閸忚偐鍙嗛梺缁樻煥閹碱偄鐡梻浣虹帛閸旀洟鏁冮鍫濊摕闁哄洨鍠庣欢鐐烘煕椤愶絿绠撳┑顔奸椤啴濡舵惔鈥愁潻闂佺粯顨呴敃锕傚箲閵忕姭鏀介悗锝庝簽閸橀亶姊洪柅鐐茶嫰婢ф澘霉閻欏懐鐣甸柟宕囧仱婵＄柉顦遍梺顓у灦濮婂宕掑顑藉亾缁嬫５娲Χ婢癸箑娲幃鐣岀矙閼愁垱鎲伴梻浣瑰缁诲倿骞忕€ｎ亶鐒介柕濞炬櫆閻撳啰鎲稿⿰鍫濈婵炲棙鎸撮埀顒婄畵瀹曞爼顢斿鍡忔瀸闂佽姘﹂～澶娒哄Ο鍏煎床闁告洦鍨伴悞鍨亜閹烘埊鍔熺紒澶屾暬閺屾盯骞樼€垫悶鈧帒顭跨憴鍕闁硅櫕鐗犻崺锟犲礃椤忓海闂繝鐢靛仩閹活亞绱為埀顒併亜閺囩喓澧甸柟顔惧仦缁傛帞鈧綆鍋嗛崢鎾愁渻閵堝棛澧紒瀣笧缁牓宕橀鍡欙紲缂傚倷鐒﹂…鍥洪幘顔界厵妞ゆ梻鎳撴晶鏌ユ煙椤栨稒顥堥柡浣瑰姍瀹曞墎鎹勯悜妯荤彣闂傚倷娴囬褍顫濋敃鍌︾稏濠㈣泛鈯曢崫鍕庣喖鎮℃惔锛勪喊闂傚⿴鍋勫ú锕傛憘鐎ｎ喖鐐婃い鎺嗗亾闁藉啰鍠栭弻鏇熷緞濞戞﹩娲梺鍛婏耿娴滆泛顫忛搹鍏夊亾閸︻厼校闁靛棗鍟撮弻銈夊礃閼碱剙鐓熼梺璇″枤閸嬨倕鐣烽妸锔剧瘈闁告劑鍔屾导搴♀攽閻樺灚鏆╁┑顔芥尦瀹曨垶顢涢悙鍙傦附绻濋棃娑氬闁稿鎸鹃幉鎾礋椤掆偓椤︹晠姊虹粙娆惧剰闁挎洏鍎茬粚杈ㄧ節閸ャ劌鈧鏌﹀Ο鐚寸礆闁靛ň鏅滈悡銉╂煛閸愩劎澧涢柡鍡樼矒閺屾稓鈧綆鍋呭畷灞俱亜閵忊槄鑰垮┑顔瑰亾闂佹娊鏁崑鎾绘煙闁垮銇濇慨濠冩そ瀹曘劍绻濋崟銊︻潔闂備焦瀵уú蹇涘磿閻㈢ǹ鏄ユ繛鎴欏灩缁犳盯鏌ｅΔ鈧悧蹇涘储闁秵鈷戦梻鍫熻儐瑜版帒纾块柧蹇ｅ亞椤╃兘鏌曡箛瀣偓鏍偂閻斿吋鐓ユ繝闈涙閸ｈ淇婇幓鎺濈吋闁诡噯绻濇俊鍫曞幢閹邦亞鐩庨梻濠庡亜濞诧箓骞愰幖渚囨晜妞ゆ劧闄勯悡鏇㈡煛閸愨晜灏甸柣锝堥哺閵囧嫰顢旈崟顐ｆ婵犵鈧磭鍩ｇ€规洖宕灃闁告劦浜濋崯浼存⒒閸屾艾鈧悂宕愰崫銉㈠亾濮樼厧澧扮紒顔芥閹粙鎮介悽鐢靛姽闁诲骸绠嶉崕閬嶅箠婢舵劕閱囨い蹇撶墛閻撴洘銇勯幇鈺佲偓鏇㈠几閺冨牊鐓曟俊顖氬悑閺嗩剚鎱ㄦ繝鍐┿仢鐎规洏鍔嶇换婵嬪礋椤撶姵娈奸梻浣筋嚙鐎涒晠宕欒ぐ鎺戠煑闁告劦鍘介敍鍌涚節閻㈤潧孝闁挎洏鍊濆畷銏°偅閸愨晛浠梺褰掓涧閸熷潡鎮у鑸碘拺闁告挻褰冩禍鏍煕閵娿儺鐓肩€殿喗濞婇、鏇㈠煑閳哄倹鏉告俊鐐€栧濠氬Υ鐎ｎ喖缁╃紓浣姑肩换鍡涙煟閹邦垰鐓愭い銉ヮ樀閺岋綁鏁愰崶褍骞嬪銈冨灪濞茬喖寮崘顔肩劦妞ゆ巻鍋撻柡渚囧櫍濮婄粯绗熼埀顒€顭囪绡撻柍褜鍓欓埞鎴﹀灳閾忣偄鏋犻梺绯曟杹閸嬫挸顪冮妶鍡楃瑐缂佲偓娓氣偓瀹曟繈濡舵径瀣帗闁荤喐鐟ョ€氼剟鎮橀幘顔界厵妞ゆ梻鏅幊鍥殽閻愬瓨宕屾鐐村浮楠炴﹢寮妷銉ゅ濡炪倖鐗滈崑鐐哄煕閹达附鐓犲┑顔藉姇閳ь剚娲熷鎶芥焼瀹ュ棛鍘搁梺鍛婁緱閸ㄤ即鍩㈤崼婵冩斀闁炽儱纾幗鐘绘煙瀹勭増鍤囩€规洘绮撳畷锝嗗緞婵犲倸甯梻鍌氬€峰ù鍥磻閹邦厾浠氶梻浣筋嚙缁绘垿鎳濇ィ鍐ㄧ厺鐎广儱鎳夐崼顏堟煕閺囥劌骞橀柣锕€鐗撳娲濞戙垻宕紓浣藉紦缁瑩骞冮敓鐘茬疀闁绘鐗嗛悵鏃堟⒒娓氬洤澧紒澶屾暬閹€斥槈閵忥紕鍘卞┑鐐村灥瀹曨剟寮搁妶鍥╃＜闁绘﹢娼ф禒锕傛煙娓氬灝濡界紒缁樼箞瀹曟﹢鍩炴径姝屾濠德板€楁慨鐑藉磻閻愬搫绀夐柡宥庡幖缁犳岸鏌￠崘銊у妞ゎ偄鎳橀弻宥夊传閸曨偀鍋撻悽绋跨闁告侗鍘搁弨浠嬫煟濡椿鍟忛柡鍡╁灡娣囧﹪骞撻幒鎾虫畻閻庤娲橀崹鍨暦閻旂⒈鏁囨繛鎴灻兼竟鏇炩攽椤旂瓔鐒介柛妯犲洨宓佹俊顖濆亹绾惧吋銇勯弮鍌楁嫛闁稿骸绻戦妵鍕箻閸愬弶鍊悗鍨緲鐎氼噣鍩€椤掑﹦绉甸柛鎾寸懄閹便劑骞栨担鍦幗闁硅壈鎻槐鏇㈡偩椤撱垺鐓曢幖绮光偓瀹犲煘闁捐崵鍋熼埀顒€鍘滈崑鎾绘煕閺囥劌浜炴い鏂挎閳规垿鎮欓崣澶嗘灆婵炲瓨绮嶇换鍫ュ春濞戙垹绠ｉ柨鏃傛櫕閸樺崬鈹戦悙鏉戠仸闁挎洦鍋婂銊︾節濮橆厼鈧爼鐓崶銊︾叆妞ゃ儱顑夐弻鐔煎矗婢跺鈧劗鈧鍠栭悥鐓庣暦瑜版帩鏁婇柤鎭掑労閸炲湱绱撻崒姘偓椋庣矆娓氣偓瀹曟劙宕妷褏鐓嬮梺鍦檸閸犳牠鎮″鈧弻鐔告綇閸撗呮殸闂備礁宕ú顓㈠蓟閺囷紕鐤€闁挎繂妫涚粣娆戠磽娴ｄ粙鍝洪柣鎾偓鎰佹綎婵炲樊浜濋崵鎺楁煏閸繃鍟楅柕蹇ョ磿缁犻箖鎮归崶鍥ф噽閺嗐垽姊洪棃娑欏闁告梹鐟ラ悾宄邦潨閳ь剟銆佸璺哄窛妞ゆ棁濮ら悵鏇炩攽閿涘嫬浜奸柛濠冪墵楠炴劖銈ｉ崘銊э紱闂佸湱澧楀妯肩磼閳轰急褰掓偐瀹割喖鍓遍梺缁樻尭閸熸挳寮婚弴鐔风窞闁割偅绻傛慨銏ゆ⒑閹稿海鈽夌紒澶婄秺瀵鈽夐姀鐘靛幐闁诲函缍嗛崜娑溾叺闂傚倷绀侀幖顐ｅ緞閸ヮ剙绀堟繝闈涱儏缁狀垶鏌涘☉鍗炵仭闁哥姴妫濋弻娑㈠即閵娿儰绨介梺鎸庣⊕閹瑰洤顫忕紒妯诲闁兼亽鍎埀顒€鍟撮弻锝夊箳閻愮數鏆ゅΔ鐘靛仦閸ㄥ灝鐣烽崼鏇ㄦ晢闁逞屽墴瀵憡绗熼埀顒勫蓟閻旂厧绀堢憸蹇曟暜濞戙垺鐓涢柛娑卞枟閸婃劙鏌＄仦璇插闁诡喓鍊濆畷鎺戔槈濮楀棔绱�
                        anti_send_buf->addr=device_addr;          
                        anti_send_buf->fun=MODBUS_RTU_FUN_WR;
                        anti_send_buf->st_addr=ENDIAN_BIG_LITTLE_16(ANTI_REFLUX_REG_ADDR);
                        anti_send_buf->num= ENDIAN_BIG_LITTLE_16(8);
                        anti_send_buf->bytes=meter_rec_buf->bytes;
                        anti_send_buf->crc16=crc16_standard(CRC_RTU,(u8_t *)anti_send_buf,sizeof(modbus_wr_t)-sizeof(anti_send_buf->crc16));
                        Uart_write((u8_t *)send_buf, sizeof(modbus_wr_t));
                        
                        APP_DEBUG("send anti reflux data\r\n");
                        print_buf(send_buf,sizeof(send_buf));
                        fibo_free(send_buf);
                    }
                }
                if(modbus_buf->fun==MODBUS_RTU_FUN_WR){
                    
                    reg_addr=ENDIAN_BIG_LITTLE_16(modbus_buf->st_addr);
                    if(reg_addr==ANTI_REFLUX_REG_ADDR){
                        //濠电姷鏁告慨鐑藉极閸涘﹥鍙忛柣鎴ｆ閺嬩線鏌涘☉姗堟敾闁告瑥绻橀弻锝夊箣閿濆棭妫勯梺鍝勵儎缁舵岸寮诲☉妯锋婵鐗婇弫楣冩⒑閸涘﹦鎳冪紒缁橈耿瀵鏁愭径濠勵吅闂佹寧绻傚Λ顓炍涢崟顖涒拺闁告繂瀚烽崕搴ｇ磼閼搁潧鍝虹€殿喛顕ч埥澶娢熼柨瀣垫綌婵犳鍠楅〃鍛存偋婵犲洤鏋佸Δ锝呭暞閳锋垿鏌涘☉姗堝姛闁瑰啿鍟扮槐鎺旂磼濡搫顫掑┑鐘亾濞撴埃鍋撴慨濠呮缁瑧鎹勯妸褜鍞堕梻浣告啞閼归箖顢栭崶鈺傤潟闁绘劕鎼粻锝夋煥閺冨倹娅曢柛姗€浜跺娲濞淬劌缍婂畷鏇㈡焼瀹ュ懐鍔﹀銈嗗坊閸嬫挻绻涚亸鏍ゅ亾閹颁礁娈ㄦ繝鐢靛У绾板秹寮查幓鎺濈唵閻犺櫣灏ㄩ崝鐔搞亜閺冣偓鐢繝骞冨Δ鍐╁枂闁告洦鍓涢ˇ銉モ攽閻愯尙婀撮柛濠冪箓閻ｇ兘顢曢埛姘そ椤㈡棃宕ㄩ鍛伖闂傚倷绀侀幉锛勬崲閸屾壕鍋撳鍗炲幋鐎规洘娲熼獮鍥偋閸垹骞楁繝寰锋澘鈧挾娆㈤垾鏂ユ灁婵せ鍋撻柡宀€鍠栭悰顕€宕归鍙ユ偅闂備礁鐤囧Λ鍕囬崹顐ｅ弿闁逞屽墴閺岋絽螣濞茶鏅遍梺鍛婅壘閹虫ê顫忕紒妯诲闁惧繒鎳撶粭锟犳⒑閸涘﹥鈷愭い顓炴处缁傚秶绮欐惔鎾寸€婚梺瑙勫劤绾绢參藝椤旂晫绠鹃悗鐢登圭敮鍫曟煟鎺抽崝鎴﹀春濞戙垹绠ｉ柣妯兼暩閿涙粓鏌ｆ惔顖滅У闁稿甯″畷鏇㈠Ψ閳哄倻鍘遍柟鍏肩暘閸ㄨ鎱ㄥ澶嬬厸鐎光偓閳ь剟宕伴弽褏鏆﹂柕濠忓缁♀偓闂佸憡鍔戦崝澶愬磻閹捐绠涢柣妤€鐗忛崣鍡椻攽閻樼粯娑ч柣妤€妫欑粋鎺戔堪閸喓鍘撻柣鐔哥懃鐎氼剟鎮橀埡鍛厓鐟滄粓宕滈妸褏绀婇柛鈩冪☉绾惧鏌涢弴銊ュ妞も晛寮舵穱濠囧Χ閸涱喖娅ら梺缁樻尰閻熲晠寮诲☉婊呯杸婵﹩鍏涘Ч妤呮⒑閸濆嫭顥為柨鏇樺灲瀵鈽夐姀鐘栤晠鏌ㄩ弮鍌滄憘婵炵》绻濆娲濞戞瑥顦╅梺鍛婃⒐閻楃娀鐛崱娑樼睄闁割偒鍓涚粙蹇擃渻閵堝棙灏靛┑顔惧厴閹偓銈ｉ崘鈹炬嫽婵炴挻鍩冮崑鎾寸箾娴ｅ啿娲﹂崑瀣煕閳╁喚妯呮繛宸簻鍥撮梺鍛婁緱閸犳鎯佹惔銊︹拻闁稿本鑹鹃埀顒傚厴閹虫鎳滈悽鍏哥泊濠碉紕鍋戦崐鏍垂闂堟党娑樷攽鐎ｎ亞鐣鹃梺鍛婃处閸ㄥジ寮鍡樺弿婵☆垰娼￠崫鐑樼箾閸喎鍔ゆい顏勫暣婵″爼宕卞▎蹇婃嫛闂備胶枪鐎涒晠宕濆▎蹇ｅ殨妞ゆ劑鍩勯崥瀣煕閳╁啰鎳呴柣锕€鐗婄换婵嬫偨闂堟刀銏ゆ煕婵犲啯鍊愭い銏℃閸╋繝宕ㄩ鐙€鍟囬梻浣告惈椤︿即宕烘繝鍌ゅ晠闁靛鏅滈悡鍐偡濞嗗繐顏╅柣蹇旀尦閺岀喖顢欑憴鍕彇缂備浇椴哥敮鎺曠亽婵犵數濮电喊宥夊汲濡　鏀介柨娑樺娴滃ジ鏌涙繝鍐⒌鐎规洖缍婇幃鐣岀矙鐠恒劎鏋冩繝娈垮枟閵囨盯宕戦幘鎼闁绘劖褰冮弳娆撴煃鐠囨煡鍙勬鐐叉喘椤㈡瑩宕滆椤矂姊婚崒娆戝妽闁诡喖鐖煎畷鏇㈩敍閻愯尙顦柟鍏肩暘閸斿矂宕掗妸锔轰簻闊洦鎸婚崳鐣岀磼閳锯偓閸嬫捇姊绘担鍦菇闁搞劏妫勯…鍥樄闁糕斁鍋撳銈嗗笒椤︻垶鎮橀敂閿亾鐟欏嫭绀冮柨鏇樺灪娣囧﹪骞栨担瑙勬珕缂備焦绋戦鍛村极閹惰姤鈷掗柛灞剧懅椤︼箓鏌熼懞銉х煉鐎规洑鍗抽獮鍥级鐠恒劎鏆梻浣呵归張顒勫礄閻熼偊鐒介柡宓偓閺€浠嬫煟濡櫣鏋冨瑙勵焽閻ヮ亪骞嗚閹垿鏌熸笟鍨妞ゎ偅绮撳畷鍗炍旈埀顒勭嵁鐎ｎ喗鈷戠紒瀣儥閸庢劙鏌熼悷鐗堝枠妤犵偛鍟オ浼村醇閻旈攱鐤呴梻渚€娼чˇ顓㈠磿閺屻儲鍋╅梺顒€绉甸埛鎺懨归敐鍛暈闁哥喓鍋ら弻鐔煎传閵夈儱骞嬮梺璇″枤閸嬨倝寮崘顔肩＜婵﹢纭稿Σ顖涚節閻㈤潧孝闁挎洏鍊濋幃褎绻濋崶銊ヤ簵闂佸搫娲ㄩ崰鍡樼濠婂牊鐓欓柡澶婄仢椤ｅ磭绱掔€ｎ厼鍚圭紒杈ㄥ浮閸┾偓妞ゆ帒瀚悞鍨亜閹烘垵鈧崵澹曢挊澹濆綊鏁愰崱妤冪シ婵炲瓨绮撶粻鏍ь潖濞差亜绀堥柟缁樺笂缁ㄤ粙姊洪崫銉バｉ柟鍛婂劤椤曪綀顦归柛鈹惧亾濡炪倖甯掔€氼參鍩涢幒妤佺厱閻忕偟鍋撻惃鎴濐熆瑜庣粙鎴﹀Υ閹烘埈娼╂い鎾楀嫮鏉归柣搴ゎ潐濞叉ê煤閺嶎収鏁囬柛蹇曞帶缁剁偤鎮楅敐搴″閻㈩垱顨婇弻锝夋偄閸濄儳鐓佺紓渚囧枟閹告悂鎮惧畡鎵冲牚闁告劧绲鹃悗濠氭⒑鐟欏嫬鍔ょ痪缁㈠弮瀵宕奸妷锔规嫼闂佸憡绻傜€氬嘲危瑜版帗鐓曢柕濞垮劤缁夎櫣鈧鍠楁繛濠囧极閸愵喖纾兼繛鎴炶壘鐢儳鈹戦悩鍨毄闁稿鍠栧畷鎴﹀箻閺傘儲鐎洪梺鐟板⒔缁垶鎮″☉妯忓綊鏁愰崨顔藉枑闁哄稄绱曠槐鎾存媴閾忕懓绗＄紓浣筋嚙閸熶即骞戦姀鐘斀閻庯綆浜為敍婊冣攽閻愭潙鐏﹂柨鏇楁櫊閸┾偓妞ゆ帊鑳堕埥澶愭煃鐟欏嫬鐏存俊楣冧憾閹ǹ绠涢弮鍌涘櫗闂佽绻戦悷鈺侇潖閾忓厜鍋撻崷顓烆€屾繛鍏煎姍閺屾盯濡搁妷锕€浠村Δ鐘靛仜閸燁偊鍩㈡惔銊ョ闁哄倸銇樻竟鏇炩攽閻愭潙鐏︽い蹇ｄ邯椤㈡棃宕奸悤浣诡棄闁诲骸绠嶉崕閬嵥囨导鏉戠厱闁瑰濮风壕鍏笺亜閺嶃劎鈯曠紒鈧崘鈺冪闁告侗鍘介崵鍥煛鐏炲墽娲撮柟顔哄灲瀹曘劍绻濋崟顓涙瀼闂傚倷妞掔槐顔惧緤閸ф绀傛慨妞诲亾闁绘侗鍠氶埀顒婄秵閸犳寮插┑瀣厓鐟滄粓宕滃☉姘灊濠电姵纰嶉崵鎺楁煏閸繃宸濋柨娑欑箖缁绘稒娼忛崜褏袣濡炪倖娲橀悧鐘诲箖閻愬顩烽悗锝庡亞閸樺崬鈹戦埥鍡楃仯缂侇噮鍨跺畷鎰板箛閻楀牏鍘搁悗鍏夊亾閻庯綆鍓涜ⅲ缂傚倷鑳舵慨鐢告儎椤栨凹鍤曢柟缁㈠枟閸婄兘鏌熷▓鍨灍鐎规洜鍠愮换婵嬫偨闂堟刀娑㈡煙瀹勬澘鏆ｇ€规洖宕～婊堝幢濮楀棙顥夐梻鍌欒兌缁垶骞愰崼鏇炵９婵犻潧顑呴拑鐔兼煟閺冨洦顏犵痪鎯с偢閺屾洝绠涢弴鐐愶綁鏌ｈ箛鎾缎ф慨濠呮缁辨帒螣鐠囨煡鐎虹紓鍌欑椤戝棝宕归崹顕嗚€垮〒姘ｅ亾婵﹥妞介獮鎰償閿濆洨鏆ゆ繝鐢靛仩椤曟粎绮婚幘宕囨殾闁汇垻枪閻掑灚銇勯幒宥堝厡缂佲檧鍋撴繝鐢靛仜閻楀棝鎮樺┑瀣嚑婵炴垶姘ㄧ壕鐓庮熆鐠虹尨鍔熼柛鈺嬬秮閺屾盯鍩為幆褌澹曞┑锛勫亼閸婃牜鏁幒妤€绐楁慨姗嗗墻閻掍粙鏌熼柇锕€骞樼紒鐘荤畺閺屾稑鈻庤箛锝嗩€嗛梺鍏兼緲濞硷繝寮婚埄鍐╁缂佸瀵у▓缁樼節濞堝灝鏋撻柛瀣崌濮婃椽鎮欓挊澶婂Г闁诲繐绻戦悷褏鍒掔拠宸僵闁煎摜顣介幏娲偡濠婂懎顣奸悽顖涱殜閺佸秹鎮㈤搹鍦紲闂侀€炲苯澧柟宄版嚇瀹曘劍绻濋崘鈺婂敹婵犵數濮烽。顔炬閺囥垹纾婚柟杈剧畱绾惧綊鏌″搴ｄ粶婵炴垯鍨圭粈鍐┿亜閺傚灝鎮戦柣搴墮椤啴濡堕崱妯硷紩闂佺ǹ顑嗛幐楣冨焵椤掑喚娼愭繛鍙夛耿瀹曞綊宕稿Δ鍐ㄧウ濠碘槅鍨伴崥瀣偓姘哺閺屻倗鍠婇崡鐐测拻闂佸摜鍠庨鍡樼┍婵犲洦鍊锋い蹇撳閸嬫捇寮介‖顒佺⊕閹峰懐绮电€ｎ偅鐦為梻鍌氬€烽懗鍫曞箠閹捐搴婇柡灞诲劚缁犺銇勯幇鍓佺暠闁绘挻锕㈤弻鐔告綇閹呮В闂佽桨绀侀敃顏堝蓟閿濆绠涢梻鍫熺☉椤晛鈹戦悙鑼闁兼椿鍨堕崺鐐哄箣閿旇棄鈧兘鏌ょ喊鍗炲闁告洟绠栧铏圭矙閸栤剝鏁剧紓浣筋嚙閻楁捇鎮伴鈧畷姗€顢欓挊澶嗗亾閻戣姤鍋″ù锝夘棑閸斿秵淇婇悙鎵煓闁靛棔绶氬顕€宕煎┑鍡欑崺婵＄偑鍊栭悧妤呮嚌閸撗呬笉闁绘劗鍎ら埛鎺楁煕鐏炲墽鎳呯紒鎰⒐缁绘稒鎷呴崘鍙夘棞妞ゃ倕鍊垮缁樻媴閸涘﹥鍎撻梺鐟板暱缁绘﹢骞冮悜钘夌厸闁告侗鍨扮粊锔界節閵忥絽鐓愰柛鏃€鐗犲畷鎰版煥鐎ｃ劋绨婚梺鍦劋閸╁牆危鐟欏嫨浜滈柡鍐ｅ亾婵☆偄鍟～蹇涙惞閸︻厾锛滃┑鈽嗗灠閹碱偊锝炲鍛斀闁绘劖褰冮幃鎴︽煟閻曞倻鐣垫鐐茬墦婵℃悂濡烽鍏煎€梻浣规偠閸庤崵寰婇懞銉ь洸濡わ絽鍟崑鈩冪箾閸℃绠版い蹇ｄ簽缁辨帡鍩€椤掑嫬绀冩い鏃傛櫕閸欏棗鈹戦鏂や緵闁告ǹ顫夌粋宥呪堪閸喓鍘搁梺绋挎湰缁诲啰娑甸崜浣虹＜闁绘鏁哥敮娑㈡煏閸パ冾伃濠殿喒鍋撻梺鎸庣☉鐎氼參宕虫导瀛樺€甸悷娆忓缁€鍐┿亜閵娿儳澧︾€规洜澧楃换婵嬪炊瑜忛、鍛存⒑缂佹ê濮堟繛鍏肩懄缁傚秵绺介崨濞炬嫽闂佺ǹ鏈懝楣冨焵椤掍焦鍊愮€规洘鍔欓獮鏍ㄦ媴閸濄儻绱┑锛勫仜椤戝懐鈧稈鏅犻、鏇㈡嚍閵夛箑寮垮┑顔筋殔濡鏅舵繝姘厽闁圭儤姊瑰▍鏇㈡煙閸欏鍊愭鐐差儔閹瑧鈧稒顭囪ぐ鎸庣節閻㈤潧鈻堟繛浣冲浂鏁勯柛鈩冪☉閻撴洟鏌熸潏楣冩闁绘挻娲樼换婵嬫濞戞瑯妫炲銈呮禋娴滎亪寮诲☉銏℃櫜闁割偆鍣ユ禒鈺冪磽娴ｄ粙鍝洪悽顖ょ節閵嗕礁鈻庨幘鏉戞疅闂侀潧顦崕鎶姐€傞弻銉︹拻濞达綁顥撴稉鑼磼閹绘帗鍋ョ€规洘顨呴～婊堝焵椤掑嫮宓侀柛鎰靛枟閸嬧晠鎮橀悙璺盒撻柣搴″暱閳规垿鍩ラ崱妤冧淮濠碘剝銇滈崝宥囩博閻旂厧鍗抽柕蹇婃閹锋椽姊洪崷顓€鐟懊规搴ｄ笉闁圭偓绶為弮鍫熷亹闁惧浚鍋勯埀顒佸姉閳ь剚顔栭崰妤呭箖閸岀偛绠栭柕蹇嬪€曠粈鍌炴煠濞村娅呮鐐搭殜濮婄粯鎷呯粵瀣秷闂佺ǹ瀛╂繛濠囧箖濞差亜惟鐟滃繘鎯岄崱娑欑厱闁逛即娼ч弸鐔兼煟閹惧磭绠婚柡灞剧洴婵＄兘骞嬪┑鍡樼亾婵炲鍘ч崯顐︹€旈崘顔嘉ч柛鎰╁妿娴犻箖姊洪幐搴㈢８闁搞劋绮欓悰顕€宕橀纰辨綂闂佸疇妫勫Λ娆愭櫏闂備礁婀遍崢褔鎮洪妸褎宕查柛鎰╁壆閻斿摜绡€闁告劦浜為惁鍫ユ⒑濮瑰洤鐏叉繛浣冲嫮顩锋繝濠傜墛閻撶喖骞掗幎钘夌閹兼番鍔岀粈鍡涙煙閻戞ê鐒鹃柛姘儔閺屾盯濡烽敐鍛瀳闁瑰吋娼欓敃顏勵潖濞差亜宸濆┑鐘插€歌闂備礁鎽滄慨鐢告偋濡ゅ懌鈧焦绻濋崶銊㈡嫽婵炶揪绲介幉锟犲疮閻愬绠鹃悹鍥囧懐鏆ら悗瑙勬礀缂嶅﹤顕ｉ崜浣瑰珰闁绘劦鍓涢埥澶嬨亜椤愶絿鐭掗柛鈹惧亾濡炪倖甯掔€氼剛绮婚弽顐ｅ枑闁绘鐗嗙粭鎺旂磼閻樺啿娴柡宀€鍠栭幃婊兾熼搹閫涙樊婵＄偑鍊戦崕閬嶆煀閿濆绠栫€瑰嫭澹嬮崼顏堟煕閹伴潧鏋涚€殿喗婢樿灃闁绘﹢娼ф禒婊堟煟濡や焦灏板ǎ鍥э躬楠炴牗鎷呯憴鍕彆闂備礁鎲￠幐鍡涘川椤曞懏缍嬮梻鍌氬€搁崐椋庣矆娓氣偓楠炲鏁撻悩鑼槷闂婎偄娲︾粙鎴澪涘鈧弻娑氫沪閸撗佲偓鎺撱亜閳哄啫鍘撮柡灞炬礉缁犳稓鈧綆浜栭崑鎾诲冀椤撶偟锛欓梺姹囧灩閹诧繝宕戦埄鍐闁糕剝顨堢粻鐗堛亜韫囷絼绨界紒杈ㄥ浮閸┾偓妞ゆ帒瀚柋鍥煏婢舵稑顩柛姗€浜跺Λ鍛搭敃閵忊€愁槱濠碘槅鍋呴崹鍧楀箠閹捐閿ゆ俊銈勮兌閸橆亪姊虹化鏇炲⒉婵炲弶绮撹棟闁挎柨顫曟禍婊勩亜閹板墎鎮奸柣顓熷浮閺屾盯鍩為幆褌澹曞┑锛勫亼閸婃牜鏁幒鏂哄亾濮樼厧澧扮紒顔碱煼瀵粙顢橀悢鍝勫妇闂備礁澹婇崑鍛崲閸愵啟澶愭倷濞村鏂€濡炪倖鐗楃粙鎺斾焊閿旇姤鍙忓┑鐘插暞閵囨繄鈧娲栫紞濠囥€佸璺哄窛妞ゆ挾鍋涢ˉ宥夋⒒閸屾瑨鍏岀紒顕呭灦楠炴劗鎷犵憗浣规そ閹垺绺芥径瀣▉濠电姷鏁告慨鐢告嚌閸撗冾棜闁稿繐鍚嬮崣蹇旀叏濡も偓濡宕㈤幘顔界厱閻庯綆鍋呭畷宀勬煙椤旂晫鐭掗柟宕囧仱婵＄兘濡烽敂鐐闂傚倸鍊风粈浣圭珶婵犲洤纾婚柛娑卞姸濞差亜鍐€妞ゆ劑鍊撶粭澶愭⒑缂佹﹩鐒界紒顕呭灦閹€斥枎閹惧鍘甸柣鐔哥懃鐎氼剚鎱ㄩ敃鍌涚厱闁靛牆妫涢幊鍥煛鐏炲墽鈽夋い顐ｇ箞椤㈡宕掑┃鐐姂濮婃椽宕崟顐У闂侀€炲苯澧柛鎾村哺瀹曘儳鈧綆鍠栫粻鍦磼椤旂厧甯ㄩ柛瀣尭閻ｇ兘宕剁捄鐑樻珝缂傚倸鍊搁崐鎼佸磹閻戣姤鍤勯柤鎼佹涧閸ㄦ梹銇勯幘鍗炵仼闁搞劌鍊块弻娑㈩敃閿濆棛顦ラ梺钘夊暟閸犳牠寮婚弴鐔虹闁绘劦鍓氶悵鏇㈡⒑缁嬫鍎忔俊顐ｇ箞瀵鈽夊顐ｅ媰闂佸憡鎸嗛埀顒€危閸繍娓婚柕鍫濇嚇閻涙粓鏌熼崙銈嗗
                        
                    }
                }
            }   //else
 //       }   //if(NULL != currentCmd)
 //   }   //if(NULL != currentDevice)
}   //static void anti_relex_data_process(void)
*/

/*
static void anti_relex_data_process(void)
{
    static Device_t *currentDevice = NULL;
    static DeviceCmd_t *currentCmd = NULL;
    u16 reg_addr;
    //s_device->buf->payload        
    APP_DEBUG("MODBUS_DATA_GET\r\n");
    currentDevice = list_nextData(&DeviceList, currentDevice);      //闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁炬儳缍婇弻鐔兼⒒鐎靛壊妲紒鐐劤濠€閬嶅焵椤掑倹鍤€閻庢凹鍙冨畷宕囧鐎ｃ劋姹楅梺鍦劋閸ㄥ綊宕愰悙宸富闁靛牆妫楃粭鎺撱亜閿斿灝宓嗙€殿喗鐓￠、鏃堝醇閻旇渹鐢绘繝鐢靛Т閿曘倝宕悧鍫熸珡濠电姷鏁告慨顓㈠磻閹剧偨鈧帒顫濋敐鍛婵犳鍠栭敃銊モ枍閿濆洦顫曢柟鐑樺殾閻斿吋鎯為梺顐ｇ〒缁€鍐ㄢ攽閻樻鏆俊鎻掓嚇瀹曟垿宕熼娑樹壕婵﹩鍘界欢鍙夈亜閺囶亞绉€规洏鍔嶇换婵嬪礋椤撶喎娈為梻鍌欑窔閳ь剛鍋涢懟顖涙櫠鐎电硶鍋撳▓鍨灕妞ゆ泦鍥х叀濠㈣泛谩閻斿吋鐓ラ悗锝呯仛缂嶅苯鈹戦悩鎰佸晱闁哥姵顨婇妴鍐川鐎涙ê浜辨繝鐢靛Т濞层倝寮告笟鈧弻鐔碱敍閸″繐浜鹃梺琛″亾濞寸姴顑嗛悡鐔兼煙闁箑澧紒鐙欏洦鐓曢柨婵嗙墛椤ュ鏌嶇憴鍕伌妞ゃ垺鐟╅幊鏍煛閳ь剛鍒掗悽鐢电＝濞达絽鎽滈悞宄邦渻閺夋垶鎲搁柟骞垮灩閳规垹鈧綆浜為崐鐐差渻閵堝骸澧婚柛搴㈡倐瀹曞爼濡歌楠炲牊绻濋悽闈涗沪闁搞劑娼ч悾鐑筋敆閸曨偄鍤戝┑鐐村灦閻熝呯不妤ｅ啯鐓曟繝濠傚暙閺嗙喓绱掗埦鈧崑鎾寸節濞堝灝鏋涢柨鏇樺劚椤啯绂掔€ｎ亣鎽曢梺鍛婄☉閻°劑宕愰悜鑺ョ厾闁煎湱澧楃涵鐐亜韫囷絽骞楃紒缁樼箞閸╂盯鍩€椤掑倷娌柤鎭掑劤瑜板酣姊绘担鍛婃儓闁哄牜鍓熼幆鍕敍閻愯尙鐣洪梺闈涚箞閸婃洖顔忓┑鍡忔斀闁绘ɑ褰冮顐︽煃鐠囪尙绠绘慨濠勭帛閹峰懏顦版惔婵婎洬缂傚倷鐒﹁ぐ鍐焽閳ュ磭鏆︽俊銈傚亾閾伙綁鎮规担鍝ワ紞缂佺姵宀稿楦裤亹閹烘搫绱电紓浣插亾濞撴埃鍋撻柟顔光偓鏂ユ婵☆垰绻愮紞濠囧极閹版澘骞㈡俊顖炴櫜閾忓酣姊绘担铏瑰笡缂佸甯￠獮鎴﹀炊瑜滃鏍磽娴ｈ偂鎴炲垔閹绢喗鐓熼柟瀵镐紳椤忓嫧鏋旈悘鐐电摂濞撳鏌曢崼婵囶棡濠㈣泛瀚伴弻娑樷枎韫囨挻娈梺浼欑悼閸忔﹢鐛€ｎ喗鏅滈柦妯侯槴閸嬫捇鎮滈懞銉у幈闂侀潧饪垫俊鍥煡婢跺本鍠愰柣妤€鐗嗛崫鐑樻叏婵犲偆鐓肩€规洘甯掗～婵嬵敄閽樺澹曢悗鐟板閸ｇ銇愰幒鎴犲€炲銈嗗笒椤︿即寮查鍫熷仭婵犲﹤鍟撮崣鍕煏閸℃鏆ｅ┑锛勫厴閸┾剝鎷呮笟顖氭櫍婵犵數鍋犻幓顏嗗緤閹稿海浠氶梻浣呵归鍛矓閹绢喖鐓橀柟杈鹃檮閸嬫劙鎮归崶鍥у暕缁憋綁姊绘担铏瑰笡妞ゃ劌鎳庤灋婵炴垶鐟ч悵鍫曟煛閸モ晛鏋旂紒鈾€鍋撴繝娈垮枟閿曗晠宕㈡ィ鍐ㄥ偍闁汇垹鎲￠埛鎴︽煕濞戞﹫鏀婚悗鍨懇閺屾稑鈽夐崡鐐茬濡炪倖鍔曢妶绋款潖缂佹ɑ濯撮柧蹇曟嚀缁楋繝姊洪悷鐗堝暈闁诡喖鍊搁悾鐑筋敍濞戞﹩鍤ら梺鍝勵槹閸ㄥ綊鎮块崨顖滅＝濞达絽澹婇崕蹇曠磼閵娾晙鎲剧€规洖銈搁、鏃堝醇閻斿搫骞堟俊鐐€栭崝褏寰婄捄銊т笉婵☆垱鐪规禍婊堟煥閺冨浂鍤欑€殿噮鍠楅幈銊︾節閸涱噮浠╃紓浣介哺鐢帟鐏掑┑鐐跺皺缁垶鍩涢弽顓熲拻濞达絽鎳欒ぐ鎺濇晞闁糕剝绋戠粈澶愭煛閸ャ儱鐏柛瀣ф櫊閺屾盯鈥﹂幋婵呯敖闂佽崵鍠庣紞濠囧蓟瀹ュ牜妾ㄩ梺鍛婃尵閸犳牠鐛崘顔芥櫢闁绘瑢鍋撻柡浣稿暣閺屻劑寮村Δ鈧禍楣冩⒑缂佹ê濮囬柨鏇ㄤ邯瀵寮撮悢铏圭槇闂婎偄娲﹂幖鈺伱洪銏♀拺闁圭ǹ娴烽埊鏇熺箾閼碱剙鏋庢い顐㈢箻閹煎綊宕烽鐘靛幆婵犵數鍋涘Λ娆撳磿閹惰棄绀堥梺顒€绉甸埛鎴︽煕閿旇骞楅柛銈傚亾婵犵數鍋涘Ο濠囧储婵傚壊鏁嬮柨婵嗩樈閺佸啴鏌ㄩ弴妤€浜剧紓浣哄У缁嬫帡濡甸崟顖氱閻犺櫣鍎ら悗濠氭⒑閸涘﹥鐓ラ柟铏～蹇撁洪鍕棟闂侀潧顧€闂勫嫰鎮甸弮鍫熲拺闁告縿鍎遍弸鏂款熆瑜庨〃鍫㈠垝鐎ｎ亶鍚嬪鑸瞪戦弲婊堟⒑缁洖澧查柣鐔濆洦鏅繝闈涱儐閳锋垹绱掔€ｎ偄顕滄繝鈧导瀛樼厽闁绘梹娼欐慨鍌溾偓瑙勬礃椤ㄥ牊绂掗敂鐐枂闁挎繂妫欓弶鍛婁繆閻愵亜鈧牕煤瀹ュ纾婚柟鎯ь嚟缁犳儳霉閿濆懎鏆辨繛鏉戝缁辩偤寮介妸褏鐦堥梻鍌氱墛娓氭宕曡箛娑樼畾闁绘柨鍚嬮埛鎴︽倵閸︻厼校闁靛棗鍟撮弻銈夊礃閼碱剙鐓熼梺璇″枛濞尖€崇暦閵娾晩鏁嶆繝濠傛嫅缁卞啿鈹戦悙鑸靛涧缂佽尪濮ょ粩鐔哥節閸パ咃紵闂婎偄娲﹀ú婊呭婵傚憡鐓忓┑鐐靛亾濞呭啴鏌熼幓鎺戔挃闁逞屽墲椤煤閺嶎厼围闁归棿闄嶉埀顑跨窔瀵噣宕煎┑瀣暪闂備胶绮弻銊╁箹椤愶妇宓侀柛顐犲劜閳锋帒鈹戦悩鏌ヮ€楀ù婊勭矋缁绘稓鎷犺閻ｈ鲸銇勯銏㈢鐎规洜鍏橀、妯衡槈濡懓顥氭繝娈垮枟閿曗晠宕㈤悾宀€鐭嗛柛顐犲灮绾惧ジ寮堕崼娑樺閻忓浚鍘介妵鍕箻閻愯棄浠悗瑙勬礈閸犳牠銆佸鈧幃鈺呮濞戞鍝庡┑鐘茬棄閺夊簱鍋撳Δ浣瑰弿闁绘垼妫勭壕缁樼箾閹存瑥鐏╅柣銈庡枟閵囧嫰寮介妸褏鐓傞梺娲诲幖椤︾敻寮婚悢鍏煎€绘俊顖濆吹閸樻悂姊虹粙娆惧剱闁圭懓娲顐﹀箛椤撶喎鍔呭┑鐘绘涧閻楀繐鈻旂捄銊х＝闁稿本鐟ч崝宥夋煕閺冣偓閻楁粎鍒掑▎鎾崇闁哄啠鍋撶€规洖寮剁换婵嬫濞戝崬鍓遍梺绋款儍閸旀垵顫忔繝姘唶闁绘柨鍢查悗顒勬⒑闂堟稓绠為柛濠冪墵瀹曟劙宕归锝呭伎濠碘槅鍨抽崢褏鏁捄渚唵鐟滃酣骞愰幎钘夎摕闁挎繂鎳夊Σ鍫ユ煕濡ゅ啫浠﹂柣蹇撶墕椤啴濡舵惔鈥茬凹缂備緡鍠楅幑鍥х暦濞差亜鐒垫い鎺嶉檷娴滄粓鏌熼崫鍕棞濞存粍鍎抽—鍐Χ鎼粹€茬盎缂備胶绮敮鐐参ｉ幇鏉跨闁瑰啿纾崰鎾诲箯閻樺樊鍟呮い鏃傛嚀娴滈箖鏌熼崜褏甯涢柍閿嬪灴閺屾稑鈽夊鍫濆闂佸疇妫勯ˇ鐢稿蓟閵娾晛鍗虫俊顖濄€€閸嬫挸鈹戦崱鈺佹闂佽鍎煎Λ鍕煁閸ヮ剚鐓忛煫鍥ь儏閻忣噣鏌ㄥ☉娆戠畺缂佺粯绋掑蹇涘礈瑜庨崑褔姊洪悜鈺佸⒉婵☆偄鍟悾鐑芥濞戞帗鐎婚梺瑙勫劤椤曨參宕㈡潏銊х瘈闁汇垽娼у瓭闂佺ǹ顑呭Λ婵嬪箖閳╁啰闄勯柛娑橈功閸橀亶姊虹€圭媭娼愰柛搴ゆ珪缁傚秹鎮欓璺ㄧ畾闂佺粯鍔︽禍婊堝焵椤掍胶澧遍柡渚囧枟缁绘繈宕熼鐘靛姸濠电偞鎸婚崺鍐磻閹惧灈鍋撶憴鍕闁轰礁顭烽妴浣肝旈崨顓狀槹濡炪倖甯掗崐鎼佺嵁閸儲鈷掑ù锝囩摂濞兼劗鈧娲橀敋闁崇粯鏌ㄩ埥澶愬閻樻彃娈ゆ繝鐢靛仦閸ㄥ爼宕洪崘顔肩；闁规崘鍩栭崰鍡涙煕閺囥劌澧版い锔哄妼閳规垿鏁嶉崟顐＄钵缂備緡鍠楅悷銉╂偩瀹勬噴娲敂閸曨厼濮︽俊鐐€栫敮濠囨⒔瀹ュ棛顩叉繝濠傜墛閻撴瑩鏌涘┑鍡楊伀閺佸牆鈹戦埄鍐ㄥ姢闁搞垺鐓″﹢浣糕攽閻樿宸ラ悗姘煎櫍閹矂骞掑Δ浣哄幐閻庡厜鍋撻柍褜鍓熷畷浼村冀瑜忛弳锔姐亜閹板墎鐣辩紒鈧€ｎ偁浜滈柟鐑樺焾濡茶銇勯妷顖滃埌闁宠鍨块幃娆撴嚑椤掍焦鍠栫紓鍌欑贰閸犳牜绮旈悷鎵殾闁哄洢鍨圭粻顕€鎮峰▎娆戝矝闁稿鎹囧顕€宕煎┑鍫О婵＄偑鍊栭弻銊ノｉ崼锝庢▌濡ょ姷鍋為悧婊堝礆閹烘绀傚璺猴梗婢规洟鎮楃憴鍕婵炴潙鍊垮畷顖炲炊椤掍讲鎷婚梺绋挎湰閻熝囧礉瀹ュ鐓欐い鏃囧亹閸╋絿鈧娲滈幊鎾跺弲濡炪倕绻愰幊搴㈢濡ゅ懏鈷戦悹鎭掑妼閺嬫柨鈹戦纰卞殶缂侇喖顭峰浠嬧€栭浣诡棃闁轰焦鍔欏畷銊╊敇閻斿壊鍞归梻鍌欒兌鏋柨鏇樺€濋垾锕傛倻閽樺鎽曢梺鎸庢磵閸嬫捇鎽堕敐鍛偓鎺戭潩閻撳海浠俊銈嗘⒐娣囧﹪鎮欓鍕ㄥ亾閺嶎厼绠伴悹鍥ф▕濞撳鏌﹀Ο渚▓婵炲吋鐗楃换娑橆啅椤旇崵鐩庣紓浣哄С閸楁娊鐛弽顬ュ酣顢楅埀顒勬倿閻戞ɑ鍙忓┑鐘插暙椤曟粎绱掔紒妯肩畵闁崇粯鎹囧畷褰掝敊閻ｅ奔绨撮梻鍌欒兌鏋柨鏇樺劚鐓ら柣鏃傚帶閺勩儵鏌曡箛鏇烆€岄柛姘儏椤法鎹勭悰锛勬箙濠电偟鍘ч敃顏勵潖濞差亝顥堟繛鎴炶壘椤ｅ搫鈹戦埥鍡椾簻闁活厼鍊块悰顔跨疀閹句焦妞介、鏃堝川椤栨艾绠洪梻鍌欒兌缁垶鏁嬮梺鍛娚戦悧鐘诲箠濠婂牜鏁傞柛顐ゅ枔閸橀亶姊洪崫鍕偓浠嬪磿閼姐倐鍋撳顐㈠祮闁哄苯绉堕幏鐘绘嚑椤戭値鍕垫闁绘劕寮堕崰姗€鏌熼銊ユ搐闁卞洭鏌曡箛鏇炐㈢紒鐘劦濮婂宕掑▎鎴М闂佺顕滅换婵嗙暦瑜版帩鏁嶉柣鎰皺閿涙瑩姊洪崫鍕枆闁稿鍋撻梺绋款儐閹告悂锝炲┑瀣€锋い鎺嗗亾妞ゅ骏鎷�
    if(NULL != currentDevice){
        currentCmd = list_nextData(&currentDevice->cmdList, currentCmd);    //闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁炬儳缍婇弻鐔兼⒒鐎靛壊妲紒鐐劤濠€閬嶅焵椤掑倹鍤€閻庢凹鍙冨畷宕囧鐎ｃ劋姹楅梺鍦劋閸ㄥ綊宕愰悙宸富闁靛牆妫楃粭鎺撱亜閿斿灝宓嗙€殿喗鐓￠、鏃堝醇閻旇渹鐢绘繝鐢靛Т閿曘倝宕悧鍫熸珡濠电姷鏁告慨顓㈠磻閹剧偨鈧帒顫濋敐鍛婵犳鍠栭敃銊モ枍閿濆洦顫曢柟鐑樺殾閻斿吋鎯為梺顐ｇ〒缁€鍐ㄢ攽閻樻鏆俊鎻掓嚇瀹曟垿宕熼娑樹壕婵﹩鍘界欢鍙夈亜閺囶亞绉€规洏鍔嶇换婵嬪礋椤撶喎娈為梻鍌欑窔閳ь剛鍋涢懟顖涙櫠鐎电硶鍋撳▓鍨灕妞ゆ泦鍥х叀濠㈣泛谩閻斿吋鐓ラ悗锝呯仛缂嶅苯鈹戦悩鎰佸晱闁哥姵顨婇妴鍐川鐎涙ê浜辨繝鐢靛Т濞层倝寮告笟鈧弻鐔碱敍閸″繐浜鹃梺琛″亾濞寸姴顑嗛悡鐔兼煙闁箑澧紒鐙欏洦鐓曢柨婵嗙墛椤ュ鏌嶇憴鍕伌妞ゃ垺鐟╅幊鏍煛閳ь剛鍒掗悽鐢电＝濞达絽鎽滈悞宄邦渻閺夋垶鎲搁柟骞垮灩閳规垹鈧綆浜為崐鐐差渻閵堝骸澧婚柛搴㈡倐瀹曞爼濡歌楠炲牊绻濋悽闈涗沪闁搞劑娼ч悾鐑筋敆閸曨偄鍤戝┑鐐村灦閻熝呯不妤ｅ啯鐓曟繝濠傚暙閺嗙喓绱掗埦鈧崑鎾寸節濞堝灝鏋涢柨鏇樺劚椤啯绂掔€ｎ亣鎽曢梺鍛婄☉閻°劑宕愰悜鑺ョ厾闁煎湱澧楃涵鐐亜韫囷絽骞楃紒缁樼箞閸╂盯鍩€椤掑倷娌柤鎭掑劤瑜板酣姊绘担鍛婃儓闁哄牜鍓熼幆鍕敍閻愯尙鐣洪梺闈涚箞閸婃洖顔忓┑鍡忔斀闁绘ɑ褰冮顐︽煃鐠囪尙绠绘慨濠勭帛閹峰懏顦版惔婵婎洬缂傚倷鐒﹁ぐ鍐焽閳ュ磭鏆︽俊銈傚亾閾伙綁鎮规担鍝ワ紞缂佺姵宀稿楦裤亹閹烘搫绱电紓浣插亾濞撴埃鍋撻柟顔光偓鏂ユ婵☆垰绻愮紞濠囧极閹版澘骞㈡俊顖炴櫜閾忓酣姊绘担铏瑰笡缂佸甯￠獮鎴﹀炊瑜滃鏍磽娴ｈ偂鎴炲垔閹绢喗鐓熼柟瀵镐紳椤忓嫧鏋旈悘鐐电摂濞撳鏌曢崼婵囶棡濠㈣泛瀚伴弻娑樷枎韫囨挻娈梺浼欑悼閸忔﹢鐛€ｎ喗鏅滈柦妯侯槴閸嬫捇鎮滈懞銉у幈闂侀潧饪垫俊鍥煡婢跺本鍠愰柣妤€鐗嗛崫鐑樻叏婵犲偆鐓肩€规洘甯掗～婵嬵敄閽樺澹曢悗鐟板閸ｇ銇愰幒鎴犲€炲銈嗗笒椤︿即寮查鍫熷仭婵犲﹤鍟撮崣鍕煏閸℃鏆ｅ┑锛勫厴閸┾剝鎷呮笟顖氭櫍婵犵數鍋犻幓顏嗗緤閹稿海浠氶梻浣呵归鍛矓閹绢喖鐓橀柟杈鹃檮閸嬫劙鎮归崶鍥у暕缁憋綁姊绘担铏瑰笡妞ゃ劌鎳庤灋婵炴垶鐟ч悵鍫曟煛閸モ晛鏋旂紒鈾€鍋撴繝娈垮枟閿曗晠宕㈡ィ鍐ㄥ偍闁汇垹鎲￠埛鎴︽煕濞戞﹫鏀婚悗鍨懇閺屾稑鈽夐崡鐐茬濡炪倖鍔曢妶绋款潖缂佹ɑ濯撮柧蹇曟嚀缁楋繝姊虹憴鍕憙妞ゆ泦鍛疾闂備胶绮濠氬储瑜旈幏鎴︽偄閸忚偐鍘介梺鍝勫暙閸婂摜鏁崜浣虹＜闁绘瑦鐟ュú锕傛偂閺囩喆浜滄い鎾跺枎閻忋儲绻涢崨顕嗚€块柡宀嬬節瀹曢亶骞囬鍌欑磿缂傚倷娴囨ご鎼佸箰婵犳艾绠柛娑欐綑缁狅綁鏌熼悜妯虹仸闁稿孩鎸搁埞鎴︽偐椤愶絽顎忛梺鍛婃礀閻忔岸鎮挎担鑲濇棃鎮╅棃娑楃捕闂佺粯顨嗛幐缁樼┍婵犲偆娼扮€光偓婵犲唭顏堟⒒娴ｅ憡鎲稿┑顔芥綑铻炴繝闈涱儏閽冪喐绻涢幋娆忕仼闁告濞婇弻锝夊箛椤掆偓閹胶绱掗鐐毈婵﹤鎼晥闁搞儜鈧崑鎾诲箻閸撲胶鐒兼繛鎾村焹閸嬫捇鏌涢埡鍐ㄤ槐妤犵偛顑夐弫鍌滅磼濡粯鐝︾紓鍌欒兌閾忓酣宕㈡ィ鍐ㄧ婵☆垰鍚嬮浠嬫煛婢跺鐏嶉柡鈧禒瀣厽闁归偊鍓欑痪褔鎮楀顒佸櫧缂佽鲸鎸搁濂稿礋椤撶姷宕查梻浣虹帛娓氭宕板Δ鈧銉╁礋椤栨氨鐤€濡炪倖甯掗崑鍡涘疮鐎ｎ偂绻嗛柣鎰典簻閳ь剚鐗曡灋濞撴埃鍋撶€规洘鍨块獮鍥礂椤愩垺鍠樼€殿喛娉涢埢搴ㄦ倷椤掆偓閻︽粓姊绘笟鈧褔鎮ч崱妞㈡稑螖娴ｇ懓寮块梺绋跨灱閸嬬偤鎮￠弴銏＄厪濠电倯鍐╂拱闁轰緡鍨伴—鍐Χ韫囨洖顕辩紓渚囧枟閻熴儵锝炶箛鏃傜瘈婵﹩鍓涢敍婊冣攽椤旀枻渚涢柛蹇旓耿瀹曟垿骞橀幖顓熜ч柟鑹版彧缁插潡鎮為崗鑲╃闁圭偓娼欓悞褰掓煕鐎ｎ偅灏版い銊ｅ劦閹瑩骞栭鐔烘殽婵°倖顨忔禍娆撳础閸愯尙鏆﹂柣鎾崇岸閺€浠嬫煕椤愮姴鐏╅柣鎰躬濮婄粯鎷呮笟顖涙暞闂佺ǹ顑嗛崝妤呭箖娴兼潙唯闁靛鍑界紞浣哥暦閵娧€鍋撳☉娅亪鍩€椤掆偓閻忔繈婀侀梺缁樏Ο濠囧磿閹扮増鐓冮梺鍨儐椤ュ牓鏌＄仦鍓ф创濠碉紕鍏橀、娆撴偂鎼搭喗娴囬梻鍌欒兌鏋悗娑掓櫊閵嗗啴宕ㄩ幍顔荤胺闂傚倷鐒︾€笛呮崲閸岀偛绠犻幖娣妼濮规煡鏌ｉ幇顔煎妺闁绘挸鍟村娲垂椤曞懎鍓伴梺璇茬箲閹告娊寮婚敍鍕勃闁告挆鈧Σ鍫ユ⒑鐎圭姵顥夋い锔诲灦閿濈偛饪伴崼婵嬪敹濠电娀娼уΛ顓烆焽椤掑嫭鈷掗柛灞剧懅椤︼箓鏌ｉ妶鍛悙閾荤偤鏌涢弴銊ョ€柛銉墯閸嬨劎绱掔€ｎ厼鍔甸柟鑺ユ礋濮婃椽骞愭惔锝囩暤濠碘槅鍋呴〃鍫㈠垝婵犳碍鍋愮紓浣骨氶幏娲⒑閸涘﹦鈽夐柨鏇樺劦閸╂盯骞囬悧鍫㈠幈闂侀潧臎閸曨剚鐦撻梻浣筋嚃閸ｏ絿绮婚弽顓炵畺婵犲﹤鐗婄€电姴顭跨捄铏圭劸闁告艾鎳樺缁樻媴閻熼偊鍤嬪┑鈽嗗亗閻掞箓骞堥妸鈺佄ч柛娑变簼閻庡搫鈹戦悩璇у伐闁绘锕崺娑㈠箣閿旂晫鍘卞┑鐐村灦閿曨偄顔忛妷鈺傜厵闁稿繐鍚嬮崐鎰版煛鐏炲墽鈯曠紒缁樼箞瀹曟﹢鍩￠崘鐐ょ紓鍌氬€峰ù鍥ㄧ椤掑嫬纾婚柣鎰仛瀹曞弶绻濋棃娑卞剰闁绘劕锕﹂幉鍛婃償閵婏箑鈧灚銇勯幒鎴濐仾闁抽攱鍨块弻娑㈡晜鐠囨彃绠瑰銈忕到閸氬鎹㈠┑瀣潊闁宠棄鎳撻埀顒€娼￠弻鐔碱敊閻ｅ本鍣紓浣虹帛缁诲牆鐣烽崼鏇炍╃憸宥囨暜閹€鏀介柣妯虹仛閺嗏晠鏌涚€ｎ偆娲撮柟顔矫埞鎴犫偓锝庝簽椤︻喖鈹戦悩璇у伐闁绘锕幃锟犳偄閸忚偐鍙嗗┑鐘绘涧濡繈顢撳Δ鈧…鑳槻闁宦板姂楠炲牓濡搁敂鍓х槇闂佸憡娲﹂崢鑲╃箔閿熺姵鈷戦柣鐔告緲濡插鏌熼搹顐€顏堟偩閻戣棄惟闁挎柨澧介惁鍫ユ⒑缁嬫寧婀扮紒瀣浮閹偓绺介崨濞炬嫽闂佺ǹ鏈悷褔藝閿曞倹鐓欑痪鏉垮船娴滀即鏌熼姘拱鐎垫澘瀚悾婵嬪焵椤掑倻鐭嗗┑鐘蹭紖瑜版帗鏅查柛娑卞枟閸犳劙姊洪崫鍕紨缂佺姵鎹囧濠氭偄閸忕厧浜遍梺鍓插亞閸犳捇宕欓敓鐘斥拺闁告稑锕ゆ慨鈧梺绋款儐閹哥粯绌辨繝鍥ㄥ€锋い蹇撳閸嬫捇寮介鐐殿唶婵°倧绲介崯顐ゅ瑜版帗鐓ユ繝闈涙－濡插綊鏌￠崨顔剧疄闁哄本绋撴禒锕傚礈瑜嬮埀顒佸浮閺屾稑顫滈埀顒佺鐠轰警娼栨繛宸簻娴肩娀鏌涢弴銊ュ闁稿绉瑰娲川婵犲啰鍙嗛梺娲诲幖閸婂潡鐛崘顭戞建闁逞屽墴瀵偊骞樼紒妯轰汗閻庤娲栧ú銈夌嵁閹扮増鈷掑ù锝呮啞閸熺偛銆掑顓ф疁鐎规洘婢橀～婵嬫嚋闂堟稑澹掗梻浣告贡閸庛倝銆冮崱娑欏亗婵炲棙鍔戞禍婊堟煛閸愩劍鎼愬ù婊冩贡缁辨帗寰勬惔銏╀哗闂侀€炲苯澧叉い顐㈩槸鐓ら柡宥庡幗閸嬪鏌涜箛娑欙紵缂佽妫濋弻鐔兼⒒鐎靛壊妲柛鐑嗗灦閹嘲饪伴崘顏嗩啋婵犵鈧磭鍩ｉ柟顔界矒閹崇偤濡烽姀鈥愁伜婵犵數鍋犻幓顏嗗緤閹稿海浠氶梻浣告惈濡繃绂嶉崼鏇炶摕婵炴垯鍨归～鍛存煥濞戞ê顏╃€殿喓鍔岄—鍐Χ閸愩劎浠鹃梺缁橆殕椤ㄥ懘顢氶妷鈺佺妞ゆ帒鍊婚惁鍫ユ煙閸忚偐鏆橀柛銊ㄥ吹缁瑦绗熼埀顒€顫忕紒妯诲闁荤喐婢樻慨銏㈢磽娴ｈ櫣甯涙い銊ワ躬閺佹劙鎮欓弶鎴犵獮闁诲繒鍋熸灙濞存粎鍋撻幈銊ヮ潨閸℃绠归梺鍛婄箖濡炰粙寮婚敍鍕勃闁伙絽鐫楄閳规垿鏁嶉崟顐㈠箣婵犵绱曢弻澶惵ㄩ崒婊呯＜閺夊牃鏅涙禒锔剧磼缂佹銆掗柍褜鍓涢弫鍛婄仚閻炴哎鍎靛娲传閸曨剙娅ф繝鐢靛亹閸嬫捇鎮楀▓鍨灈妞ゎ厾鍏樺顐﹀箛閺夊灝鑰垮┑鈽嗗灠閹碱偅淇婇幎鑺モ拻濞撴埃鍋撴繛浣冲懏宕查柟鐑樻尰閸欏繘鏌℃径瀣瘎闁圭儤顨呴柋鍥煏婢舵稖鍚傞柟閿嬫そ濮婃椽宕ㄦ繝鍕窗闂佺ǹ姘︽ご鎼佹偋鎼淬劍鐓熼幖绮光偓鍐茶緟闂佺ǹ顑嗛幐鍓ф閹烘柡鍋撻敐搴″箺缁绢厼鐖奸弻锟犲幢椤撱垺顎嶉梺閫涚┒閸斿矁鐏掗梺鍦瑰ù鐑藉Υ閹邦喚纾藉ù锝呮惈鏍℃繝鐢靛仜閿曨亜顕ｆ繝姘亜閻炴稈鈧厖澹曞┑鐐村灦椤忎即骞嬮敃鈧悡鏇㈡煙閹殿喖顣奸柣鎾跺枛楠炴牜鍒掔憴鍕垫綉闂佺粯鎸搁崥瀣箞閵婏妇绡€闁告劏鏂傛禒銏ゆ⒑鐠団€虫灓闁稿繑锕㈠濠氬炊椤掍焦娅囬梺閫炲苯澧柍缁樻崌瀹曞ジ寮撮悢鍙夊缂傚倷绀侀鍡涱敄濞嗘挸纾块柟閭﹀枤绾惧ジ鎮楅敐搴′簼閻忓繑澹嗙槐鎺楀籍閸屾碍鐏堥悗娈垮枟閹歌櫕鎱ㄩ埀顒勬煃閸濆嫬鈧懓鈻嶉弽顓熲拻濞达綀娅ｇ敮娑㈡煕閺冣偓椤ㄥ牓骞冩导鏉懳ㄩ柍杞拌兌椤斿棗鈹戦悙鍙夆枙濞存粍绻堥崺娑㈠箳濡や胶鍘遍柣蹇曞仧閸嬫捇鎯冮幋婵愮唵鐟滃酣鎯勯鐐茶摕闁靛牆顦粈鍐煕濞嗗浚妯堟俊顐犲劦濮婃椽妫冨☉娆忣槱闂佸憡姊归悷鈺呮偘椤曗偓楠炴帒螖閳ь剛绮婚敐澶嬬厽婵炲棗绻戦崳浠嬫煕濮橆剛绉烘慨濠傤煼瀹曟帒鈻庨幇顔哄仒婵＄偑鍊ら崑鍕囬棃娑氭殾闁哄洢鍨洪崑鍌涱殽閻戝棗澧柣鈺婂灠閻ｇ兘鎮㈢喊杈ㄦ櫇閻庤鎼╅崰鏍洪妶澶嬪珔闁绘柨鍚嬮悡蹇擃熆閼哥數鈽夋い鈺婂墴閺屾稑螣缂佹ê鈧劖鎱ㄦ繝鍐┿仢鐎规洏鍔嶇换婵嬪磼濮樺吋缍嗛梻鍌欑閹诧繝寮婚妸褉鍋撳☉鎺撴珚鐎殿喛灏欓幑鍕偘閳╁喚娼旈梻渚€娼ф蹇曟閺囥垹鍌ㄩ柟鍓х帛閳锋帒霉閿濆懏鎲稿ù鐘灪閵囧嫰骞嬪┑鍥ф缂備緡鍣崣鍐嵁閹烘嚦鏃€绗熼崶銊㈡寘婵犵數濮伴崹濂稿春閺嶎厼绀夐柡宥庡幗閸嬪倿鏌曟径娑橆洭缂佲檧鍋撻梻鍌氬€搁悧濠勭矙閹烘澶愭倷閻戞鍘遍梺鎸庣箓濡瑩濡靛┑瀣厵妞ゆ棁鍋愮粔鐑橆殽閻愬弶鍠樺┑鈩冩倐婵＄兘濡烽姀鈥崇彾缂傚倸鍊搁崐鐑芥嚄閸撲礁鍨濇い鏍ㄧ矋瀹曟煡鏌涢鐘插姎闁哄嫨鍎甸弻宥堫檨闁告挻宀告俊鐢稿礋椤栨氨顔婇悗骞垮劚閻楀棝宕㈤垾鎰佹富闁靛牆鍊瑰▍鍥煕韫囨棑鑰挎鐐插暙铻栭柛娑卞枟濞呮粓鏌熼懖鈺勊夐柍褜鍓濈亸娆撳极閺嶎厽鈷掑ù锝呮啞閸熺偤鏌ㄩ弴妯虹仾缂佸倸绉堕幑鍕瑹椤栨稓绋佹繝鐢靛仜濡﹥绂嶅⿰鍕嚤闁绘绮悡鏇㈡煛閸ャ儱濡煎ù婊勫姍閺屾稓鈧綆鍋呭畷宀勬煙缁嬪尅鏀荤€垫澘瀚板畷鍗炍熼梻瀵歌兒闂傚倸鍊风粈渚€骞栭鈷氭椽濮€閵堝懎鐎┑鐐叉▕娴滄粎澹曡ぐ鎺撶厱妞ゆ劧绲剧粈鍐煃闁垮鐏﹂柕鍥у楠炴帡宕卞鎯ь棜缂傚倸鍊风粈渚€藝闁秴鏋佸┑鐘宠壘缁犳牠鏌ㄩ悢鍝勑㈢紒鈧崘鈹夸簻闊洦鎸婚崳褰掓煛鐎ｎ偄鐏ラ柍瑙勫灴閹晝鎷犺娴兼劙姊虹紒姗嗘當婵☆偅绋撻崚鎺楀醇閵夈儵鍞堕梺缁樻⒒鏋€殿喖鐏濋埞鎴﹀煡閸℃浠柣搴ｇ懗閸涱喖鍘归梺鍛婃寙閸涱垽绱查梻渚€鈧偛鑻晶瀵糕偓瑙勬礈閸犳牠銆佸鈧幃銏ゆ煥鐎ｎ兘鍋撴ィ鍐┾拻濞达綀娅ｇ敮娑欍亜閵娿儲鍤囬柟顔ㄥ洤骞㈡繛鍡樺灩閻ｅ爼姊洪崷顓炲妺妞ゃ劌妫濋幃锟犲即閵忊€斥偓鍫曟煟閹伴偊鏉洪柛銈嗙懃閳规垿鍨鹃悙钘変划闂佺妫勯悥鐓庮嚕娴犲鏁囬柣鏂挎惈瀵櫕绻濋悽闈涒枅婵炰匠鍏炬稑鈻庨幘鎶芥７閻熸粎澧楃敮妤呮偂濞戙垺鐓曢柍鈺佸枤閻掍粙鏌熼崘鍙夊枠闁哄备鈧磭鏆嗛悗锝庡墰琚︽俊銈囧Х閸嬬偟鏁敓鐘靛祦閻庯綆鍠楅崑鎰板级閸碍娅婇柍鐟扮箻濮婂宕掑▎鎴犵崲濠电偘鍖犻崗鐘虫そ婵″爼宕堕敐鍛濠殿喗锕╅崑鍕暤閸℃稒鐓熸繛鎴濆船濞呭秵顨ラ悙鏉戠瑨閾绘牠鏌嶈閸撶喖鎮伴鈧慨鈧柍銉ㄥ皺缁犳岸姊虹紒妯哄婵炲吋鐟╁畷婵嬪Χ閸℃劒绨婚梺闈涱檧缁犳垿宕悜妯诲弿濠电姴鍋嗛悡鑲┾偓瑙勬礃鐢帡鍩㈡惔銊ョ疀妞ゆ柨鎼禒鎺戔攽閿涘嫬浜奸柛濠冪墪閳绘棃鏁冮崒姘獩濡炪倖姊婚崢褏鑺遍妷鈺傗拻濞达絿鍎ら崵鈧梺瀹︽澘濡块柟骞垮灩椤撳ジ宕担鍝勫Ш闂備礁鍟块幖顐﹀箠韫囨稒鍋傞煫鍥ㄦ尨閺€浠嬫煟閹扮増娑уù婊呭亾缁绘盯宕ㄩ鐔锋缂備浇椴哥敮锟犵嵁閸ヮ剦鏁囩憸搴ㄦ偩閸洘鈷戦悗鍦濞兼劙鏌涢妸銉﹀仴妤犵偛鍟撮崺锟犲川椤撶媭鍞介梻浣烘嚀閹碱偆绮旈崼鏇炴瀬闁哄稁鍘介埛鎺懨归敐鍛暈闁哥喓鍋ら弻銈堛亹閹烘梻鏆銈冨灪閻楁顕ラ崟顖氱疀妞ゆ帒鍟幉鐗堢節閻㈤潧浠﹂柛顭戝灦瀹曞綊鎮烽悧鍫熸闂傚倸鍊风欢姘焽瑜忛幑銏ゅ幢濞戞顦┑鐘绘涧椤戝棝宕戦悢鍏肩厸鐎广儱楠搁獮妤呮煃闁垮鐏╃紒杈ㄦ尰閹峰懏鎱ㄩ幋顓濈敖缂侇噮鍙冮獮鎺楀箻閸撲緡鍟庨梺璇茬箰缁绘垿鎮ч幋锕€纾婚柟鎹愵嚙缁犳稑霉閿濆懏璐＄紒瀣╃劍缁绘繈鎮介棃娑楃捕濠碘槅鍨伴敃銉х矉瀹ュ應鍫柛顐ｇ箘椤斿姊洪悡搴㈡喐闁稿绲剧粋宥呪堪閸喓鍘甸梺纭咁潐閸旀牜娑甸幆顬″綊鎮╁畷鍥╃厐闂佸疇顫夐崹鍧楀垂妤ｅ啯鎯炴い鎰剁到閸撳灚淇婇悙顏勨偓銈嗙濠婂牆鐤悗娑櫭肩换鍡涙煕椤愶絾绀€缂佲偓閸愵喗鐓忓┑鐐茬仢閸旀挳鏌ｆ惔銈嗙彧缂佺粯绻勯崰濠偽熷ú缁樼秹闂備胶枪椤戝懘骞婇幇鏉跨闁靛繈鍊曠壕濂告煟閹存繃顥為柡鍜佷邯濮婃椽骞愭惔锝囩暤濡炪倧瀵岄崹鍫曞箯閹达附鍋勯柛蹇氬亹閸橆亝绻濋姀锝嗙【闁绘妫濆畷婵嬪Χ閸℃劒绨婚梺鍝勫暊閸嬫捇鏌涢弮鈧悧婊堝箲閵忕姭妲堟繛鍡樺姉缁夊爼姊洪崨濠冨瘷闁告劑鍔庨崢鎺戔攽閻樺灚鏆╁┑顕呭弮瀹曟垿骞樼紒妯锋嫼濡炪倖宸婚崑鎾剁磼婢跺灏﹂柟顖氳嫰铻栭柛娑卞枤閸橀亶姊洪弬銉︽珔闁哥喍鍗抽崺濠囧即閵忥紕鍘撻梻浣哥仢椤戝懘鎮橀埡鍐＜閺夊牄鍔嶇亸浼存煙瀹勭増鍤囬柟铏墵閸╁嫰宕橀妸褌鎮ｇ紓鍌欑贰閸犳牠鎮ч幘璇叉槬闁逞屽墯閵囧嫰骞掗幋婵愪痪闂佹娊鏀遍崹鍦閹烘柡鍋撻敐搴濈盎闁活煉绱曢埀顒冾潐閹爼宕曢懠顒佸床婵犻潧顑呴悞鍨亜閹烘垵顏柣鎺曞亹閳ь剙绠嶉崕閬嶅箠閹版澘绀夐柨鏇楀亾妞ゎ亜鍟存俊鍫曞幢濡ゅ啰鎲梻浣哄帶閸熷潡鎮ラ悡搴ｆ殾妞ゆ牜鍋涢拑鐔兼煏婢舵稑顩柛妯兼暬濮婃椽宕ㄦ繝鍌滀户闂佺ǹ锕ラ悧婊堝焵椤掍胶鍟查柟鍑ゆ嫹  
        if(NULL != currentCmd){
            APP_DEBUG("get device data cmd success\r\n");
            print_buf(currentCmd->cmd.payload,sizeof(currentCmd->cmd.payload));
            
            modbus_wr2_t *modbus_buf=(modbus_wr2_t *)currentCmd->cmd.payload;
            
            if((modbus_buf->fun & MODBUS_RTU_FUN_ER) == MODBUS_RTU_FUN_ER){
                //闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁炬儳缍婇弻鐔兼⒒鐎靛壊妲紒鐐劤缂嶅﹪寮婚悢鍏尖拻閻庨潧澹婂Σ顔剧磼閻愵剙鍔ょ紓宥咃躬瀵鎮㈤崗灏栨嫽闁诲酣娼ф竟濠偽ｉ鍓х＜闁绘劦鍓欓崝銈嗙節閳ь剟鏌嗗鍛姦濡炪倖甯掗崐褰掑吹閳ь剟鏌ｆ惔銏犲毈闁告瑥鍟悾宄扮暦閸パ屾闁诲函绲婚崝瀣уΔ鍛拺闁革富鍘奸崝瀣煕閵娿儳绉虹€规洘鍔欓幃娆忣啅椤旇棄鐦滈梻渚€娼ч悧鍡椢涘Δ鍛敜濠电姴娲﹂悡鏇㈡倵閿濆骸浜濋悘蹇曞缁绘盯鎳濋柇锕€娈梺瀹狀潐閸ㄥ綊鍩€椤掑﹦绉甸柛瀣у亾闂佸綊鏀卞钘夘潖缂佹鐟归柛銉戝倻鏁栭梻浣呵归鍡涙儎椤栫偛绠犻柣鏃傗拡閺佸秵绻涢幋鐐垫噭闁绘繄鍏樺娲捶椤撯剝顎楅梺鍝ュУ椤ㄥ﹪骞冮垾鏂ユ闁靛繆鈧枼鍋撻崼鏇熺厽闁归偊鍘肩徊濠氭煃闁垮顥堥柡灞炬礋瀹曞崬螣閻戞ǹ鐧侀梻浣告惈閼活垳绮旈悜閾般劍绗熼埀顒勫蓟濞戙垹绠婚柛妤冨仜椤绱撴担鎴掑惈闁稿鍊曢悾鐑藉础閻愨晜顫嶅┑鈽嗗灣閵嗗妲愰柆宥嗏拻濞达絽鎲￠崯鐐层€掑顓ф疁鐎规洏鍨洪妶锝夊礃閵婏箒绶㈤梻浣瑰濡啴寮鈧畷鎴﹀箻鐠囪尙顦ф繝銏ｆ硾閿曪絾绔熼弴銏♀拻濞达絽鎲￠崯鐐寸箾鐠囇呯暤鐎规洘绮岄埥澶愬閻樻彃浜堕梻鍌氬€搁悧濠冪瑹濡も偓閵嗘帗绻濆顓犲帾闂佸壊鍋呯换鍐夐悙娣簻闁靛鍎查ˉ銏ゆ煛鐏炲墽銆掗柍褜鍓ㄧ紞鍡涘磻閸曨剚鍙忓璺虹灱绾惧吋銇勯弮鍥撴い銉ョ墦閺岀喖鎮℃惔锝囆ㄩ悗瑙勬礃椤ㄥ棗顕ラ崟顒傜瘈濞达絽澹婂Λ婊堟⒒娴ｈ棄鍚归柛鐘冲姍閹兘濡疯閸嬫挸顫濋悡搴＄閻庡灚婢樼€氭澘鐣烽悢纰辨晬婵炴垶鑹鹃獮鍫ユ⒑鐠囨彃鍤辩紓宥呮缁傚秴鐣￠柇锕€鏅犻梺闈涱槴閺呮粓鎮￠悢鍏肩叆婵犻潧妫欓幖鎰版煕濡粯灏﹂柡宀€鍠栭、娆撳传閸曨厺绱曢梻浣告憸婵挳鏁冮妷銉劷闊洦绋戞儫闂佹寧姊婚弲顐ャ亹瀹ュ應鏀介柣妯虹仛閺嗏晠鏌涚€ｎ剙鈻堟鐐存崌椤㈡棃宕卞Δ鍐摌闂備礁婀辨灙婵炴挳鏀辩粋鎺戭潩椤戣姤鏂€闂佺粯锕╅崰鏍倶椤曗偓閺岀喖鎼归锝呮殫缂備緡鍠楀Λ鍐箖閻戣姤鐒介柨鏃傛櫕缁嬩礁鈹戦悩鍨毄濠殿喚鏁婚幊婵嬪礈瑜嶉ˉ姘舵煕韫囨艾浜圭紒鐘荤畺閺屾盯鍩勯崗鐙€浜炵划顓㈠箳濡や胶鍘卞┑顔筋殔閻楀繒澹曠捄銊х＜閺夊牄鍔嶇亸鎵磼濡ゅ啫鏋涚€规洘鍎奸ˇ鎶芥煟濠垫劕娅嶆慨濠冩そ楠炴牠鎮欓幓鎺濈€抽梻浣虹帛閻楁洟濡堕幖浣哥畺濞村吋鎯岄弫瀣煃瑜滈崜鐔兼偘椤曗偓瀹曞爼顢楅埀顒傜棯瑜旈幃瑙勭瑹椤栨粌甯ラ梺鍝ュ枎濞层倝鍩為幋锔藉€烽柤鎼佹涧濞懷呯磽娴ｈ棄绱︾紒顔界懇閻涱喖螖閳ь剟銈导鏉戦唶闁绘柨鎲￠悵顐ｇ節閻㈤潧浠滄俊顐ｇ懇瀹曟繂螖閸愩劌袣闂侀€炲苯澧存慨濠傛惈鏁堥柛銉戝懍绱欐繝鐢靛仒閸栫娀宕熼鐐╁彏闂傚倸鍊搁崐鐑芥嚄閸洖鍌ㄧ憸蹇曟閻愬绡€闁告洦鍘虹粭澶愭⒑閸濆嫮鈻夐柛妯垮亹缁寮介鐔哄幗闂佸綊鍋婇崜姘跺箚閸儲鐓曢柕濞垮劚閳ь剙缍婃俊鐢稿礋椤栨氨鐤€濡炪倖鏌ㄩ妵娆撴晬閸曨厾锛滈梺闈浨归崕娲偂閸忓吋鍙忓┑鐘插暞閵囨繈鏌熼鎯у幋闁诡啫鍥ч唶闁绘柨鍢叉竟宥囩磽閸屾艾鈧绮堟笟鈧棟妞ゆ牗绋掑▍鐘诲箹濞ｎ剙濡肩紒鐙€鍨堕幃宄扳枎韫囨搩浠煎銈嗘礋娴滃爼骞冨Δ鈧埥澶娾枎濡厧濮洪梻浣告啞閿曘垺绂嶇捄渚綎闁惧繐婀辩壕鍏间繆椤栨稒銇熸俊顐㈠暙椤啴濡堕崘銊ュ闂佸湱枪婢т粙宕氶幒鏃傜＜婵☆垵鍋愰惁鍫濃攽椤旀枻渚涢柛姗€绠栧畷銏ゅ箹娴ｅ湱鍘介棅顐㈡处濞叉牗绂掑⿰鍐剧唵鐟滄垵螞閸曨厼寮查梻浣告贡閾忓酣宕板Δ鍛亗婵炲棙鍔戞禍婊堟煛閸愩劍绁╂繛鍏煎姈缁绘盯宕ㄩ鐔锋畻闂佸搫鐭夌紞渚€寮幇鏉跨倞鐟滃秹鐛€ｎ喗鍊甸悷娆忓缁€鍐煕鎼绰板仮閽樻繃銇勯弴妤€浜鹃梺鍝勭灱閸犳牠骞楁惔銊ョ＜婵﹩鍓涢妶顕€姊绘担鍛婃儓闁活厼顦卞濠冦偅閸愩劎鐣鹃梺鍝勫暙閻楀棗娲块梺鐟板悑閻ｎ亪宕归懡銈囩煋闂佸灝顑囩弧鈧梺姹囧灲濞佳勭濠婂應鍋撳▓鍨灈闁绘牕銈稿顐﹀礃椤旂⒈娼婇梺缁樏悘姘枔閹€鏀介柣妯肩帛濞懷勪繆椤愩垻鐒哥€殿喖鎲￠幆鏃堝Ω閿旀儳骞嶉梻浣侯攰椤宕濋弽顐ｅ厹闁告挆鍛紲婵炴挻鑹鹃敃锕傛偩閸偅鍙忓┑鐘插暞閵囨繄鈧娲﹂崑濠傜暦閻旂⒈鏁囧璺鸿嫰閳诲牓鏌＄仦鍓ф创鐎殿噮鍓涢幑鍕Ω閹板墎绉柡灞剧洴楠炴帡骞嬮婵嗘儓婵°倗濮烽崑鐐烘晝閵忋們鈧礁鈻庨幘鏉戜患闁诲繒鍋犲Λ鍕不濞差亝鈷掗柛灞剧懆閸忓瞼绱掗鍛仩妞ゎ偄绻戠换婵嗩潩椤掑倸骞堥梻浣稿閸嬩線宕曢崡鐐愌囧蓟閵夛妇鍘甸梺缁樺灦閿曗晛鈻撻弴銏＄厽闁规儳鐡ㄧ粈瀣煛瀹€鈧崰鎾诲焵椤掍胶鈯曟い顓炴喘閹苯鐣濋崟顒傚幗濡炪倖鎸鹃崰鎾诲箠閸曨垱鐓欏〒姘仢婵＄晫绱掔紒妯肩疄鐎规洜鍠栭、姗€鎮欏▓鍨还闂傚倸鍊烽懗鍫曞箠閹捐搴婇柡灞诲劚缁犵娀鏌熼柇锕€鏋涢柛銊︾箖缁绘盯宕卞Δ鍐暰闂佸搫顑呴柊锝夊蓟閿濆绠涢梻鍫熺☉閳锋帒鈹戦埥鍡椾簻缂佺粯锚椤繑绻濆顒傦紲濠电偛妫欑敮鎺楀储閿熺姵鐓涢悗锝呭悁缁ㄥジ鏌曢崶褍顏鐐差儏閳规垿宕惰閻ｇ粯淇婇妶鍥ラ柛瀣洴閺佸啴濡烽埡浣虹暰闂佸搫鍟悧濠囧疾閺屻儲鐓曟繛鎴濆船楠炴﹢鏌＄仦鐔锋处閳锋帡鏌涚仦鎹愬闁逞屽墴椤ユ挾鍒掗崼鐔虹懝闁逞屽墴閻涱噣寮介褎鏅濋梺闈涚墕濞层劑鎮￠幘瀵哥闁圭偓娼欓悞褰掓煕鐎ｎ偅灏甸柍褜鍓濋～澶娒哄鈧畷褰掑垂椤旂偓娈鹃梺鍛婎殘閸婏綁鎮㈡潪鎵墾闂佸搫绉查崝搴㈢濞嗘挻鈷戦悹鍥ㄧ叀椤庢绱掗悩鑼х€规洘娲熼弻鍡楊吋閸涱垳鏆梻浣稿悑閸撴岸宕归浣侯洸鐟滅増甯楅悡娆撴煟閹寸倖鎴犱焊椤撶伝鐟扳堪閸曞灚鐤侀梺鍝勭灱閸犳牠骞婂┑瀣亱闁割偅绻冮柨顓犵磽閸屾瑧鍔嶉柣鎿勭磿缁寮介鐘茬ウ婵犮垼娉涢鍥⒔閸曨垱鐓曟繛鎴炩槈閸儱绠柧蹇撴贡绾句粙鏌涚仦鍓ф噮闁告柨绉归幏鎴︽焼瀹ュ棗鈧爼鐓崶銊︾妞わ綀鍋愮槐鎺旂磼濡吋鍒涢梺鐟扮－婵炩偓妞ゃ垺顨婇崺鈧い鎺戝閸戠姵绻涢幋鐐茬劰闁稿鎸搁埢鎾诲垂椤旂晫浜俊鐐€ら崢濂稿床閺屻儺鏁嬮柨婵嗩槸缁犵粯銇勯弮鍥棄濞存粍绮嶆穱濠囨倷瀹割喖鍓板┑鐐差嚟閸忔﹢骞冩导鎼晩闁伙絽鐬奸惁鍫㈢磼閸撗冾暭閽冭鲸銇勯顫含闁哄本鐩俊鎼佸煛閸屾盯鏁梻浣哥枃椤曆呯矓瑜版帒鏋侀柟鐗堟緲楠炪垺绻涢崱妯曟垹绮婇銈囩＝闁稿本鐟чˇ锔姐亜閹存繃鍣介柤娲憾閺屽棗顓奸崨顖氭憢濠电偛顕慨鎾敄閸℃稒鍋傞柕澶涘缁犻箖鏌熺€甸晲绱虫い蹇撶墱閺佸倹銇勯幒宥嗩樂缂佽妫濋弻锝夊箛闂堟稑顫梺绋匡攻閸旀瑩寮婚敍鍕勃闁告挆鍕灡闂備浇顕栭崰鎺楀疾濞戙垺鍋╅柣鎴ｆ閻愬﹦鎲告径鎰濞寸厧鐡ㄩ埛鎺懨归敐鍫燁仩闁靛棗锕弻锟犲川椤斿墽鐤勯悗瑙勬礃閸ㄦ寧淇婇懜闈涚窞閻忕偟鏅妶锕傛⒑鐠囨彃鍤辩紓宥呮瀹曟澘螖閸涱厾鏌у┑鐘诧工閹虫劗澹曢挊澹濆綊鏁愰崼婵呯暗闂佺懓鐡ㄧ缓楣冨几瀹ュ鐓涢柛鎰╁妿婢ф盯鏌嶉柨瀣瑨闂囧鏌ㄥ┑鍡欏妞ゅ繒濞€閺屾洟宕卞Δ瀣惈闂佸搫鏈惄顖炵嵁濡皷鍋撻棃娑欐喐闁汇倕瀚板鐑樻姜閹殿噮妲銈嗗灥閹虫﹢鍨鹃弮鍫濈妞ゆ柨妲堣閺屾稑鈽夊鍡楁閻庤娲︽禍顏勵潖濞差亝鍋￠柡澶嬪椤斺偓闂備胶鎳撻崵鏍箯閿燂拷
            }else{
                
                if(modbus_buf->fun==MODBUS_RTU_FUN_RD){
                    
                    modbus_rd_response_t *meter_rec_buf=(modbus_rd_response_t *)currentCmd->cmd.payload;
                    
                    //u8 send_buf[25]={0};
                    u8 *send_buf=fibo_malloc(25);
                    modbus_wr_t *anti_send_buf=(modbus_wr_t *)send_buf;
                    if(modbus_buf->addr==METER_ADDR && meter_rec_buf->bytes>=2 && meter_rec_buf->bytes<=16){
                        
                        APP_DEBUG("get meter data success\r\n");
                        send_buf +=7;
                        //meter_rec_buf+=3;
                        currentCmd->cmd.payload +=3;
                        r_memcpy(send_buf,currentCmd->cmd.payload,meter_rec_buf->bytes);    //闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁炬儳缍婇弻鐔兼⒒鐎靛壊妲紒鐐劤濠€閬嶅焵椤掑倹鍤€閻庢凹鍙冨畷宕囧鐎ｃ劋姹楅梺鍦劋閸ㄥ綊宕愰悙宸富闁靛牆妫楃粭鎺撱亜閿斿灝宓嗙€殿喗鐓￠、鏃堝醇閻旇渹鐢绘繝鐢靛Т閿曘倝宕悧鍫熸珡濠电姷鏁告慨顓㈠磻閹剧偨鈧帒顫濋敐鍛婵犳鍠栭敃銊モ枍閿濆洦顫曢柟鐑樺殾閻斿吋鎯為梺顐ｇ〒缁€鍐ㄢ攽閻樻鏆俊鎻掓嚇瀹曟垿宕熼娑樹壕婵﹩鍘界欢鍙夈亜閺囶亞绉€规洏鍔嶇换婵嬪礋椤撶喎娈為梻鍌欑窔閳ь剛鍋涢懟顖涙櫠鐎电硶鍋撳▓鍨灕妞ゆ泦鍥х叀濠㈣泛谩閻斿吋鐓ラ悗锝呯仛缂嶅苯鈹戦悩鎰佸晱闁哥姵顨婇妴鍐川鐎涙ê浜辨繝鐢靛Т濞层倝寮告笟鈧弻鐔碱敍閸″繐浜鹃梺琛″亾濞寸姴顑嗛悡鐔兼煙闁箑澧紒鐙欏洦鐓曢柨婵嗙墛椤ュ鏌嶇憴鍕伌妞ゃ垺鐟╅幊鏍煛閳ь剛鍒掗悽鐢电＝濞达絽鎽滈悞宄邦渻閺夋垶鎲搁柟骞垮灩閳规垹鈧綆浜為崐鐐差渻閵堝骸澧婚柛搴㈡倐瀹曞爼濡歌楠炲牊绻濋悽闈涗沪闁搞劑娼ч悾鐑筋敆閸曨偄鍤戝┑鐐村灦閻熝呯不妤ｅ啯鐓曟繝濠傚暙閺嗙喓绱掗埦鈧崑鎾寸節濞堝灝鏋涢柨鏇樺劚椤啯绂掔€ｎ亣鎽曢梺鍛婄☉閻°劑宕愰悜鑺ョ厾闁煎湱澧楃涵鐐亜韫囷絽骞楃紒缁樼箞閸╂盯鍩€椤掑倷娌柤鎭掑劤瑜板酣姊绘担鍛婃儓闁哄牜鍓熼幆鍕敍閻愯尙鐣洪梺闈涚箞閸婃洖顔忓┑鍡忔斀闁绘ɑ褰冮顐︽煃鐠囪尙绠绘慨濠勭帛閹峰懏顦版惔婵婎洬缂傚倷鐒﹁ぐ鍐焽閳ュ磭鏆︽俊銈傚亾閾伙綁鎮规担鍝ワ紞缂佺姵宀稿楦裤亹閹烘搫绱电紓浣插亾濞撴埃鍋撻柟顔光偓鏂ユ婵☆垰绻愮紞濠囧极閹版澘骞㈡俊顖炴櫜閾忓酣姊绘担铏瑰笡缂佸甯￠獮鎴﹀炊瑜滃鏍磽娴ｈ偂鎴炲垔閹绢喗鐓熼柟瀵镐紳椤忓嫧鏋旈悘鐐电摂濞撳鏌曢崼婵囶棡濠㈣泛瀚伴弻娑樷枎韫囨挻娈梺浼欑悼閸忔﹢鐛€ｎ喗鏅滈柦妯侯槴閸嬫捇鎮滈懞銉у幈闂侀潧饪垫俊鍥煡婢跺本鍠愰柣妤€鐗嗛崫鐑樻叏婵犲偆鐓肩€规洘甯掗～婵嬵敄閽樺澹曢悗鐟板閸ｇ銇愰幒鎴犲€炲銈嗗笒椤︿即寮查鍫熷仭婵犲﹤鍟撮崣鍕煏閸℃鏆ｅ┑锛勫厴閸┾剝鎷呮笟顖氭櫍婵犵數鍋犻幓顏嗗緤閹稿海浠氶梻浣呵归鍛矓閹绢喖鐓橀柟杈鹃檮閸嬫劙鎮归崶鍥у暕缁憋綁姊绘担铏瑰笡妞ゃ劌鎳庤灋婵炴垶鐟ч悵鍫曟煛閸モ晛鏋旂紒鈾€鍋撴繝娈垮枟閿曗晠宕㈡ィ鍐ㄥ偍闁汇垹鎲￠埛鎴︽煕濞戞﹫鏀婚悗鍨懇閺屾稑鈽夐崡鐐茬濡炪倖鍔曢妶绋款潖缂佹ɑ濯撮柧蹇曟嚀缁楋繝姊虹憴鍕憙妞ゆ泦鍛疾闂備胶绮濠氬储瑜旈幏鎴︽偄閸忚偐鍙嗛梺缁樻煥閹碱偄鐡梻浣虹帛閸旀洟鏁冮鍫濊摕闁哄洨鍠庣欢鐐烘煕椤愶絿绠撳┑顔奸椤啴濡舵惔鈥愁潻闂佺粯顨呴敃锕傚箲閵忕姭鏀介悗锝庝簽閸橀亶姊洪柅鐐茶嫰婢ф澘霉閻欏懐鐣甸柟宕囧仱婵＄柉顦遍梺顓у灦濮婂宕掑顑藉亾缁嬫５娲Χ婢癸箑娲幃鐣岀矙閼愁垱鎲伴梻浣瑰缁诲倿骞忕€ｎ亶鐒介柕濞炬櫆閻撳啰鎲稿⿰鍫濈婵炲棙鎸撮埀顒婄畵瀹曞爼顢斿鍡忔瀸闂佽姘﹂～澶娒哄Ο鍏煎床闁告洦鍨伴悞鍨亜閹烘埊鍔熺紒澶屾暬閺屾盯骞樼€垫悶鈧帒顭跨憴鍕闁硅櫕鐗犻崺锟犲礃椤忓海闂繝鐢靛仩閹活亞绱為埀顒併亜閺囩喓澧甸柟顔惧仦缁傛帞鈧綆鍋嗛崢鎾愁渻閵堝棛澧紒瀣笧缁牓宕橀鍡欙紲缂傚倷鐒﹂…鍥洪幘顔界厵妞ゆ梻鎳撴晶鏌ユ煙椤栨稒顥堥柡浣瑰姍瀹曞墎鎹勯悜妯荤彣闂傚倷娴囬褍顫濋敃鍌︾稏濠㈣泛鈯曢崫鍕庣喖鎮℃惔锛勪喊闂傚⿴鍋勫ú锕傛憘鐎ｎ喖鐐婃い鎺嗗亾闁藉啰鍠栭弻鏇熷緞濞戞﹩娲梺鍛婏耿娴滆泛顫忛搹鍏夊亾閸︻厼校闁靛棗鍟撮弻銈夊礃閼碱剙鐓熼梺璇″枤閸嬨倕鐣烽妸锔剧瘈闁告劑鍔屾导搴♀攽閻樺灚鏆╁┑顔芥尦瀹曨垶顢涢悙鍙傦附绻濋棃娑氬闁稿鎸鹃幉鎾礋椤掆偓椤︹晠姊虹粙娆惧剰闁挎洏鍎茬粚杈ㄧ節閸ャ劌鈧鏌﹀Ο鐚寸礆闁靛ň鏅滈悡銉╂煛閸愩劎澧涢柡鍡樼矒閺屾稓鈧綆鍋呭畷灞俱亜閵忊槄鑰垮┑顔瑰亾闂佹娊鏁崑鎾绘煙闁垮銇濇慨濠冩そ瀹曘劍绻濋崟銊︻潔闂備焦瀵уú蹇涘磿閻㈢ǹ鏄ユ繛鎴欏灩缁犳盯鏌ｅΔ鈧悧蹇涘储闁秵鈷戦梻鍫熻儐瑜版帒纾块柧蹇ｅ亞椤╃兘鏌曡箛瀣偓鏍偂閻斿吋鐓ユ繝闈涙閸ｈ淇婇幓鎺濈吋闁诡噯绻濇俊鍫曞幢閹邦亞鐩庨梻濠庡亜濞诧箓骞愰幖渚囨晜妞ゆ劧闄勯悡鏇㈡煛閸愨晜灏甸柣锝堥哺閵囧嫰顢旈崟顐ｆ婵犵鈧磭鍩ｇ€规洖宕灃闁告劦浜濋崯浼存⒒閸屾艾鈧悂宕愰崫銉㈠亾濮樼厧澧扮紒顔芥閹粙鎮介悽鐢靛姽闁诲骸绠嶉崕閬嶅箠婢舵劕閱囨い蹇撶墛閻撴洘銇勯幇鈺佲偓鏇㈠几閺冨牊鐓曟俊顖氬悑閺嗩剚鎱ㄦ繝鍐┿仢鐎规洏鍔嶇换婵嬪礋椤撶姵娈奸梻浣筋嚙鐎涒晠宕欒ぐ鎺戠煑闁告劦鍘介敍鍌涚節閻㈤潧孝闁挎洏鍊濆畷銏°偅閸愨晛浠梺褰掓涧閸熷潡鎮у鑸碘拺闁告挻褰冩禍鏍煕閵娿儺鐓肩€殿喗濞婇、鏇㈠煑閳哄倹鏉告俊鐐€栧濠氬Υ鐎ｎ喖缁╃紓浣姑肩换鍡涙煟閹邦垰鐓愭い銉ヮ樀閺岋綁鏁愰崶褍骞嬪銈冨灪濞茬喖寮崘顔肩劦妞ゆ巻鍋撻柡渚囧櫍濮婄粯绗熼埀顒€顭囪绡撻柍褜鍓欓埞鎴﹀灳閾忣偄鏋犻梺绯曟杹閸嬫挸顪冮妶鍡楃瑐缂佲偓娓氣偓瀹曟繈濡舵径瀣帗闁荤喐鐟ョ€氼剟鎮橀幘顔界厵妞ゆ梻鏅幊鍥殽閻愬瓨宕屾鐐村浮楠炴﹢寮妷銉ゅ濡炪倖鐗滈崑鐐哄煕閹达附鐓犲┑顔藉姇閳ь剚娲熷鎶芥焼瀹ュ棛鍘搁梺鍛婁緱閸ㄤ即鍩㈤崼婵冩斀闁炽儱纾幗鐘绘煙瀹勭増鍤囩€规洘绮撳畷锝嗗緞婵犲倸甯梻鍌氬€峰ù鍥磻閹邦厾浠氶梻浣筋嚙缁绘垿鎳濇ィ鍐ㄧ厺鐎广儱鎳夐崼顏堟煕閺囥劌骞橀柣锕€鐗撳娲濞戙垻宕紓浣藉紦缁瑩骞冮敓鐘茬疀闁绘鐗嗛悵鏃堟⒒娓氬洤澧紒澶屾暬閹€斥槈閵忥紕鍘卞┑鐐村灥瀹曨剟寮搁妶鍥╃＜闁绘﹢娼ф禒锕傛煙娓氬灝濡界紒缁樼箞瀹曟﹢鍩炴径姝屾濠德板€楁慨鐑藉磻閻愬搫绀夐柡宥庡幖缁犳岸鏌￠崘銊у妞ゎ偄鎳橀弻宥夊传閸曨偀鍋撻悽绋跨闁告侗鍘搁弨浠嬫煟濡椿鍟忛柡鍡╁灡娣囧﹪骞撻幒鎾虫畻閻庤娲橀崹鍨暦閻旂⒈鏁囨繛鎴灻兼竟鏇炩攽椤旂瓔鐒介柛妯犲洨宓佹俊顖濆亹绾惧吋銇勯弮鍌楁嫛闁稿骸绻戦妵鍕箻閸愬弶鍊悗鍨緲鐎氼噣鍩€椤掑﹦绉甸柛鎾寸懄閹便劑骞栨担鍦幗闁硅壈鎻槐鏇㈡偩椤撱垺鐓曢幖绮光偓瀹犲煘闁捐崵鍋熼埀顒€鍘滈崑鎾绘煕閺囥劌浜炴い鏂挎閳规垿鎮欓崣澶嗘灆婵炲瓨绮嶇换鍫ュ春濞戙垹绠ｉ柨鏃傛櫕閸樺崬鈹戦悙鏉戠仸闁挎洦鍋婂銊︾節濮橆厼鈧爼鐓崶銊︾叆妞ゃ儱顑夐弻鐔煎矗婢跺鈧劗鈧鍠栭悥鐓庣暦瑜版帩鏁婇柤鎭掑労閸炲湱绱撻崒姘偓椋庣矆娓氣偓瀹曟劙宕妷褏鐓嬮梺鍦檸閸犳牠鎮″鈧弻鐔告綇閸撗呮殸闂備礁宕ú顓㈠蓟閺囷紕鐤€闁挎繂妫涚粣娆戠磽娴ｄ粙鍝洪柣鎾偓鎰佹綎婵炲樊浜濋崵鎺楁煏閸繃鍟楅柕蹇ョ磿缁犻箖鎮归崶鍥ф噽閺嗐垽姊洪棃娑欏闁告梹鐟ラ悾宄邦潨閳ь剟銆佸璺哄窛妞ゆ棁濮ら悵鏇炩攽閿涘嫬浜奸柛濠冪墵楠炴劖銈ｉ崘銊э紱闂佸湱澧楀妯肩磼閳轰急褰掓偐瀹割喖鍓遍梺缁樻尭閸熸挳寮婚弴鐔风窞闁割偅绻傛慨銏ゆ⒑閹稿海鈽夌紒澶婄秺瀵鈽夐姀鐘靛幐闁诲函缍嗛崜娑溾叺闂傚倷绀侀幖顐ｅ緞閸ヮ剙绀堟繝闈涱儏缁狀垶鏌涘☉鍗炵仭闁哥姴妫濋弻娑㈠即閵娿儰绨介梺鎸庣⊕閹瑰洤顫忕紒妯诲闁兼亽鍎埀顒€鍟撮弻锝夊箳閻愮數鏆ゅΔ鐘靛仦閸ㄥ灝鐣烽崼鏇ㄦ晢闁逞屽墴瀵憡绗熼埀顒勫蓟閻旂厧绀堢憸蹇曟暜濞戙垺鐓涢柛娑卞枟閸婃劙鏌＄仦璇插闁诡喓鍊濆畷鎺戔槈濮楀棔绱�
                        anti_send_buf->addr=device_addr;          
                        anti_send_buf->fun=MODBUS_RTU_FUN_WR;
                        anti_send_buf->st_addr=ENDIAN_BIG_LITTLE_16(ANTI_REFLUX_REG_ADDR);
                        anti_send_buf->num= ENDIAN_BIG_LITTLE_16(8);
                        anti_send_buf->bytes=meter_rec_buf->bytes;
                        anti_send_buf->crc16=crc16_standard(CRC_RTU,(u8_t *)anti_send_buf,sizeof(modbus_wr_t)-sizeof(anti_send_buf->crc16));
                        Uart_write((u8_t *)send_buf, sizeof(modbus_wr_t));
                        fibo_free(send_buf);
                    }
                }
                if(modbus_buf->fun==MODBUS_RTU_FUN_WR){
                    
                    reg_addr=ENDIAN_BIG_LITTLE_16(modbus_buf->st_addr);
                    if(reg_addr==ANTI_REFLUX_REG_ADDR){
                        //濠电姷鏁告慨鐑藉极閸涘﹥鍙忛柣鎴ｆ閺嬩線鏌涘☉姗堟敾闁告瑥绻橀弻锝夊箣閿濆棭妫勯梺鍝勵儎缁舵岸寮诲☉妯锋婵鐗婇弫楣冩⒑閸涘﹦鎳冪紒缁橈耿瀵鏁愭径濠勵吅闂佹寧绻傚Λ顓炍涢崟顖涒拺闁告繂瀚烽崕搴ｇ磼閼搁潧鍝虹€殿喛顕ч埥澶娢熼柨瀣垫綌婵犳鍠楅〃鍛存偋婵犲洤鏋佸Δ锝呭暞閳锋垿鏌涘☉姗堝姛闁瑰啿鍟扮槐鎺旂磼濡搫顫掑┑鐘亾濞撴埃鍋撴慨濠呮缁瑧鎹勯妸褜鍞堕梻浣告啞閼归箖顢栭崶鈺傤潟闁绘劕鎼粻锝夋煥閺冨倹娅曢柛姗€浜跺娲濞淬劌缍婂畷鏇㈡焼瀹ュ懐鍔﹀銈嗗坊閸嬫挻绻涚亸鏍ゅ亾閹颁礁娈ㄦ繝鐢靛У绾板秹寮查幓鎺濈唵閻犺櫣灏ㄩ崝鐔搞亜閺冣偓鐢繝骞冨Δ鍐╁枂闁告洦鍓涢ˇ銉モ攽閻愯尙婀撮柛濠冪箓閻ｇ兘顢曢埛姘そ椤㈡棃宕ㄩ鍛伖闂傚倷绀侀幉锛勬崲閸屾壕鍋撳鍗炲幋鐎规洘娲熼獮鍥偋閸垹骞楁繝寰锋澘鈧挾娆㈤垾鏂ユ灁婵せ鍋撻柡宀€鍠栭悰顕€宕归鍙ユ偅闂備礁鐤囧Λ鍕囬崹顐ｅ弿闁逞屽墴閺岋絽螣濞茶鏅遍梺鍛婅壘閹虫ê顫忕紒妯诲闁惧繒鎳撶粭锟犳⒑閸涘﹥鈷愭い顓炴处缁傚秶绮欐惔鎾寸€婚梺瑙勫劤绾绢參藝椤旂晫绠鹃悗鐢登圭敮鍫曟煟鎺抽崝鎴﹀春濞戙垹绠ｉ柣妯兼暩閿涙粓鏌ｆ惔顖滅У闁稿甯″畷鏇㈠Ψ閳哄倻鍘遍柟鍏肩暘閸ㄨ鎱ㄥ澶嬬厸鐎光偓閳ь剟宕伴弽褏鏆﹂柕濠忓缁♀偓闂佸憡鍔戦崝澶愬磻閹捐绠涢柣妤€鐗忛崣鍡椻攽閻樼粯娑ч柣妤€妫欑粋鎺戔堪閸喓鍘撻柣鐔哥懃鐎氼剟鎮橀埡鍛厓鐟滄粓宕滈妸褏绀婇柛鈩冪☉绾惧鏌涢弴銊ュ妞も晛寮舵穱濠囧Χ閸涱喖娅ら梺缁樻尰閻熲晠寮诲☉婊呯杸婵﹩鍏涘Ч妤呮⒑閸濆嫭顥為柨鏇樺灲瀵鈽夐姀鐘栤晠鏌ㄩ弮鍌滄憘婵炵》绻濆娲濞戞瑥顦╅梺鍛婃⒐閻楃娀鐛崱娑樼睄闁割偒鍓涚粙蹇擃渻閵堝棙灏靛┑顔惧厴閹偓銈ｉ崘鈹炬嫽婵炴挻鍩冮崑鎾寸箾娴ｅ啿娲﹂崑瀣煕閳╁喚妯呮繛宸簻鍥撮梺鍛婁緱閸犳鎯佹惔銊︹拻闁稿本鑹鹃埀顒傚厴閹虫鎳滈悽鍏哥泊濠碉紕鍋戦崐鏍垂闂堟党娑樷攽鐎ｎ亞鐣鹃梺鍛婃处閸ㄥジ寮鍡樺弿婵☆垰娼￠崫鐑樼箾閸喎鍔ゆい顏勫暣婵″爼宕卞▎蹇婃嫛闂備胶枪鐎涒晠宕濆▎蹇ｅ殨妞ゆ劑鍩勯崥瀣煕閳╁啰鎳呴柣锕€鐗婄换婵嬫偨闂堟刀銏ゆ煕婵犲啯鍊愭い銏℃閸╋繝宕ㄩ鐙€鍟囬梻浣告惈椤︿即宕烘繝鍌ゅ晠闁靛鏅滈悡鍐偡濞嗗繐顏╅柣蹇旀尦閺岀喖顢欑憴鍕彇缂備浇椴哥敮鎺曠亽婵犵數濮电喊宥夊汲濡　鏀介柨娑樺娴滃ジ鏌涙繝鍐⒌鐎规洖缍婇幃鐣岀矙鐠恒劎鏋冩繝娈垮枟閵囨盯宕戦幘鎼闁绘劖褰冮弳娆撴煃鐠囨煡鍙勬鐐叉喘椤㈡瑩宕滆椤矂姊婚崒娆戝妽闁诡喖鐖煎畷鏇㈩敍閻愯尙顦柟鍏肩暘閸斿矂宕掗妸锔轰簻闊洦鎸婚崳鐣岀磼閳锯偓閸嬫捇姊绘担鍦菇闁搞劏妫勯…鍥樄闁糕斁鍋撳銈嗗笒椤︻垶鎮橀敂閿亾鐟欏嫭绀冮柨鏇樺灪娣囧﹪骞栨担瑙勬珕缂備焦绋戦鍛村极閹惰姤鈷掗柛灞剧懅椤︼箓鏌熼懞銉х煉鐎规洑鍗抽獮鍥级鐠恒劎鏆梻浣呵归張顒勫礄閻熼偊鐒介柡宓偓閺€浠嬫煟濡櫣鏋冨瑙勵焽閻ヮ亪骞嗚閹垿鏌熸笟鍨妞ゎ偅绮撳畷鍗炍旈埀顒勭嵁鐎ｎ喗鈷戠紒瀣儥閸庢劙鏌熼悷鐗堝枠妤犵偛鍟オ浼村醇閻旈攱鐤呴梻渚€娼чˇ顓㈠磿閺屻儲鍋╅梺顒€绉甸埛鎺懨归敐鍛暈闁哥喓鍋ら弻鐔煎传閵夈儱骞嬮梺璇″枤閸嬨倝寮崘顔肩＜婵﹢纭稿Σ顖涚節閻㈤潧孝闁挎洏鍊濋幃褎绻濋崶銊ヤ簵闂佸搫娲ㄩ崰鍡樼濠婂牊鐓欓柡澶婄仢椤ｅ磭绱掔€ｎ厼鍚圭紒杈ㄥ浮閸┾偓妞ゆ帒瀚悞鍨亜閹烘垵鈧崵澹曢挊澹濆綊鏁愰崱妤冪シ婵炲瓨绮撶粻鏍ь潖濞差亜绀堥柟缁樺笂缁ㄤ粙姊洪崫銉バｉ柟鍛婂劤椤曪綀顦归柛鈹惧亾濡炪倖甯掔€氼參鍩涢幒妤佺厱閻忕偟鍋撻惃鎴濐熆瑜庣粙鎴﹀Υ閹烘埈娼╂い鎾楀嫮鏉归柣搴ゎ潐濞叉ê煤閺嶎収鏁囬柛蹇曞帶缁剁偤鎮楅敐搴″閻㈩垱顨婇弻锝夋偄閸濄儳鐓佺紓渚囧枟閹告悂鎮惧畡鎵冲牚闁告劧绲鹃悗濠氭⒑鐟欏嫬鍔ょ痪缁㈠弮瀵宕奸妷锔规嫼闂佸憡绻傜€氬嘲危瑜版帗鐓曢柕濞垮劤缁夎櫣鈧鍠楁繛濠囧极閸愵喖纾兼繛鎴炶壘鐢儳鈹戦悩鍨毄闁稿鍠栧畷鎴﹀箻閺傘儲鐎洪梺鐟板⒔缁垶鎮″☉妯忓綊鏁愰崨顔藉枑闁哄稄绱曠槐鎾存媴閾忕懓绗＄紓浣筋嚙閸熶即骞戦姀鐘斀閻庯綆浜為敍婊冣攽閻愭潙鐏﹂柨鏇楁櫊閸┾偓妞ゆ帊鑳堕埥澶愭煃鐟欏嫬鐏存俊楣冧憾閹ǹ绠涢弮鍌涘櫗闂佽绻戦悷鈺侇潖閾忓厜鍋撻崷顓烆€屾繛鍏煎姍閺屾盯濡搁妷锕€浠村Δ鐘靛仜閸燁偊鍩㈡惔銊ョ闁哄倸銇樻竟鏇炩攽閻愭潙鐏︽い蹇ｄ邯椤㈡棃宕奸悤浣诡棄闁诲骸绠嶉崕閬嵥囨导鏉戠厱闁瑰濮风壕鍏笺亜閺嶃劎鈯曠紒鈧崘鈺冪闁告侗鍘介崵鍥煛鐏炲墽娲撮柟顔哄灲瀹曘劍绻濋崟顓涙瀼闂傚倷妞掔槐顔惧緤閸ф绀傛慨妞诲亾闁绘侗鍠氶埀顒婄秵閸犳寮插┑瀣厓鐟滄粓宕滃☉姘灊濠电姵纰嶉崵鎺楁煏閸繃宸濋柨娑欑箖缁绘稒娼忛崜褏袣濡炪倖娲橀悧鐘诲箖閻愬顩烽悗锝庡亞閸樺崬鈹戦埥鍡楃仯缂侇噮鍨跺畷鎰板箛閻楀牏鍘搁悗鍏夊亾閻庯綆鍓涜ⅲ缂傚倷鑳舵慨鐢告儎椤栨凹鍤曢柟缁㈠枟閸婄兘鏌熷▓鍨灍鐎规洜鍠愮换婵嬫偨闂堟刀娑㈡煙瀹勬澘鏆ｇ€规洖宕～婊堝幢濮楀棙顥夐梻鍌欒兌缁垶骞愰崼鏇炵９婵犻潧顑呴拑鐔兼煟閺冨洦顏犵痪鎯с偢閺屾洝绠涢弴鐐愶綁鏌ｈ箛鎾缎ф慨濠呮缁辨帒螣鐠囨煡鐎虹紓鍌欑椤戝棝宕归崹顕嗚€垮〒姘ｅ亾婵﹥妞介獮鎰償閿濆洨鏆ゆ繝鐢靛仩椤曟粎绮婚幘宕囨殾闁汇垻枪閻掑灚銇勯幒宥堝厡缂佲檧鍋撴繝鐢靛仜閻楀棝鎮樺┑瀣嚑婵炴垶姘ㄧ壕鐓庮熆鐠虹尨鍔熼柛鈺嬬秮閺屾盯鍩為幆褌澹曞┑锛勫亼閸婃牜鏁幒妤€绐楁慨姗嗗墻閻掍粙鏌熼柇锕€骞樼紒鐘荤畺閺屾稑鈻庤箛锝嗩€嗛梺鍏兼緲濞硷繝寮婚埄鍐╁缂佸瀵у▓缁樼節濞堝灝鏋撻柛瀣崌濮婃椽鎮欓挊澶婂Г闁诲繐绻戦悷褏鍒掔拠宸僵闁煎摜顣介幏娲偡濠婂懎顣奸悽顖涱殜閺佸秹鎮㈤搹鍦紲闂侀€炲苯澧柟宄版嚇瀹曘劍绻濋崘鈺婂敹婵犵數濮烽。顔炬閺囥垹纾婚柟杈剧畱绾惧綊鏌″搴ｄ粶婵炴垯鍨圭粈鍐┿亜閺傚灝鎮戦柣搴墮椤啴濡堕崱妯硷紩闂佺ǹ顑嗛幐楣冨焵椤掑喚娼愭繛鍙夛耿瀹曞綊宕稿Δ鍐ㄧウ濠碘槅鍨伴崥瀣偓姘哺閺屻倗鍠婇崡鐐测拻闂佸摜鍠庨鍡樼┍婵犲洦鍊锋い蹇撳閸嬫捇寮介‖顒佺⊕閹峰懐绮电€ｎ偅鐦為梻鍌氬€烽懗鍫曞箠閹捐搴婇柡灞诲劚缁犺銇勯幇鍓佺暠闁绘挻锕㈤弻鐔告綇閹呮В闂佽桨绀侀敃顏堝蓟閿濆绠涢梻鍫熺☉椤晛鈹戦悙鑼闁兼椿鍨堕崺鐐哄箣閿旇棄鈧兘鏌ょ喊鍗炲闁告洟绠栧铏圭矙閸栤剝鏁剧紓浣筋嚙閻楁捇鎮伴鈧畷姗€顢欓挊澶嗗亾閻戣姤鍋″ù锝夘棑閸斿秵淇婇悙鎵煓闁靛棔绶氬顕€宕煎┑鍡欑崺婵＄偑鍊栭悧妤呮嚌閸撗呬笉闁绘劗鍎ら埛鎺楁煕鐏炲墽鎳呯紒鎰⒐缁绘稒鎷呴崘鍙夘棞妞ゃ倕鍊垮缁樻媴閸涘﹥鍎撻梺鐟板暱缁绘﹢骞冮悜钘夌厸闁告侗鍨扮粊锔界節閵忥絽鐓愰柛鏃€鐗犲畷鎰版煥鐎ｃ劋绨婚梺鍦劋閸╁牆危鐟欏嫨浜滈柡鍐ｅ亾婵☆偄鍟～蹇涙惞閸︻厾锛滃┑鈽嗗灠閹碱偊锝炲鍛斀闁绘劖褰冮幃鎴︽煟閻曞倻鐣垫鐐茬墦婵℃悂濡烽鍏煎€梻浣规偠閸庤崵寰婇懞銉ь洸濡わ絽鍟崑鈩冪箾閸℃绠版い蹇ｄ簽缁辨帡鍩€椤掑嫬绀冩い鏃傛櫕閸欏棗鈹戦鏂や緵闁告ǹ顫夌粋宥呪堪閸喓鍘搁梺绋挎湰缁诲啰娑甸崜浣虹＜闁绘鏁哥敮娑㈡煏閸パ冾伃濠殿喒鍋撻梺鎸庣☉鐎氼參宕虫导瀛樺€甸悷娆忓缁€鍐┿亜閵娿儳澧︾€规洜澧楃换婵嬪炊瑜忛、鍛存⒑缂佹ê濮堟繛鍏肩懄缁傚秵绺介崨濞炬嫽闂佺ǹ鏈懝楣冨焵椤掍焦鍊愮€规洘鍔欓獮鏍ㄦ媴閸濄儻绱┑锛勫仜椤戝懐鈧稈鏅犻、鏇㈡嚍閵夛箑寮垮┑顔筋殔濡鏅舵繝姘厽闁圭儤姊瑰▍鏇㈡煙閸欏鍊愭鐐差儔閹瑧鈧稒顭囪ぐ鎸庣節閻㈤潧鈻堟繛浣冲浂鏁勯柛鈩冪☉閻撴洟鏌熸潏楣冩闁绘挻娲樼换婵嬫濞戞瑯妫炲銈呮禋娴滎亪寮诲☉銏℃櫜闁割偆鍣ユ禒鈺冪磽娴ｄ粙鍝洪悽顖ょ節閵嗕礁鈻庨幘鏉戞疅闂侀潧顦崕鎶姐€傞弻銉︹拻濞达綁顥撴稉鑼磼閹绘帗鍋ョ€规洘顨呴～婊堝焵椤掑嫮宓侀柛鎰靛枟閸嬧晠鎮橀悙璺盒撻柣搴″暱閳规垿鍩ラ崱妤冧淮濠碘剝銇滈崝宥囩博閻旂厧鍗抽柕蹇婃閹锋椽姊洪崷顓€鐟懊规搴ｄ笉闁圭偓绶為弮鍫熷亹闁惧浚鍋勯埀顒佸姉閳ь剚顔栭崰妤呭箖閸岀偛绠栭柕蹇嬪€曠粈鍌炴煠濞村娅呮鐐搭殜濮婄粯鎷呯粵瀣秷闂佺ǹ瀛╂繛濠囧箖濞差亜惟鐟滃繘鎯岄崱娑欑厱闁逛即娼ч弸鐔兼煟閹惧磭绠婚柡灞剧洴婵＄兘骞嬪┑鍡樼亾婵炲鍘ч崯顐︹€旈崘顔嘉ч柛鎰╁妿娴犻箖姊洪幐搴㈢８闁搞劋绮欓悰顕€宕橀纰辨綂闂佸疇妫勫Λ娆愭櫏闂備礁婀遍崢褔鎮洪妸褎宕查柛鎰╁壆閻斿摜绡€闁告劦浜為惁鍫ユ⒑濮瑰洤鐏叉繛浣冲嫮顩锋繝濠傜墛閻撶喖骞掗幎钘夌閹兼番鍔岀粈鍡涙煙閻戞ê鐒鹃柛姘儔閺屾盯濡烽敐鍛瀳闁瑰吋娼欓敃顏勵潖濞差亜宸濆┑鐘插€歌闂備礁鎽滄慨鐢告偋濡ゅ懌鈧焦绻濋崶銊㈡嫽婵炶揪绲介幉锟犲疮閻愬绠鹃悹鍥囧懐鏆ら悗瑙勬礀缂嶅﹤顕ｉ崜浣瑰珰闁绘劦鍓涢埥澶嬨亜椤愶絿鐭掗柛鈹惧亾濡炪倖甯掔€氼剛绮婚弽顐ｅ枑闁绘鐗嗙粭鎺旂磼閻樺啿娴柡宀€鍠栭幃婊兾熼搹閫涙樊婵＄偑鍊戦崕閬嶆煀閿濆绠栫€瑰嫭澹嬮崼顏堟煕閹伴潧鏋涚€殿喗婢樿灃闁绘﹢娼ф禒婊堟煟濡や焦灏板ǎ鍥э躬楠炴牗鎷呯憴鍕彆闂備礁鎲￠幐鍡涘川椤曞懏缍嬮梻鍌氬€搁崐椋庣矆娓氣偓楠炲鏁撻悩鑼槷闂婎偄娲︾粙鎴澪涘鈧弻娑氫沪閸撗佲偓鎺撱亜閳哄啫鍘撮柡灞炬礉缁犳稓鈧綆浜栭崑鎾诲冀椤撶偟锛欓梺姹囧灩閹诧繝宕戦埄鍐闁糕剝顨堢粻鐗堛亜韫囷絼绨界紒杈ㄥ浮閸┾偓妞ゆ帒瀚柋鍥煏婢舵稑顩柛姗€浜跺Λ鍛搭敃閵忊€愁槱濠碘槅鍋呴崹鍧楀箠閹捐閿ゆ俊銈勮兌閸橆亪姊虹化鏇炲⒉婵炲弶绮撹棟闁挎柨顫曟禍婊勩亜閹板墎鎮奸柣顓熷浮閺屾盯鍩為幆褌澹曞┑锛勫亼閸婃牜鏁幒鏂哄亾濮樼厧澧扮紒顔碱煼瀵粙顢橀悢鍝勫妇闂備礁澹婇崑鍛崲閸愵啟澶愭倷濞村鏂€濡炪倖鐗楃粙鎺斾焊閿旇姤鍙忓┑鐘插暞閵囨繄鈧娲栫紞濠囥€佸璺哄窛妞ゆ挾鍋涢ˉ宥夋⒒閸屾瑨鍏岀紒顕呭灦楠炴劗鎷犵憗浣规そ閹垺绺芥径瀣▉濠电姷鏁告慨鐢告嚌閸撗冾棜闁稿繐鍚嬮崣蹇旀叏濡も偓濡宕㈤幘顔界厱閻庯綆鍋呭畷宀勬煙椤旂晫鐭掗柟宕囧仱婵＄兘濡烽敂鐐闂傚倸鍊风粈浣圭珶婵犲洤纾婚柛娑卞姸濞差亜鍐€妞ゆ劑鍊撶粭澶愭⒑缂佹﹩鐒界紒顕呭灦閹€斥枎閹惧鍘甸柣鐔哥懃鐎氼剚鎱ㄩ敃鍌涚厱闁靛牆妫涢幊鍥煛鐏炲墽鈽夋い顐ｇ箞椤㈡宕掑┃鐐姂濮婃椽宕崟顐У闂侀€炲苯澧柛鎾村哺瀹曘儳鈧綆鍠栫粻鍦磼椤旂厧甯ㄩ柛瀣尭閻ｇ兘宕剁捄鐑樻珝缂傚倸鍊搁崐鎼佸磹閻戣姤鍤勯柤鎼佹涧閸ㄦ梹銇勯幘鍗炵仼闁搞劌鍊块弻娑㈩敃閿濆棛顦ラ梺钘夊暟閸犳牠寮婚弴鐔虹闁绘劦鍓氶悵鏇㈡⒑缁嬫鍎忔俊顐ｇ箞瀵鈽夊顐ｅ媰闂佸憡鎸嗛埀顒€危閸繍娓婚柕鍫濇嚇閻涙粓鏌熼崙銈嗗
                        
                    }
                }
            }   //else
        }   //if(NULL != currentCmd)
    }   //if(NULL != currentDevice)
}   //static void anti_relex_data_process(void)
*/
/*******************************************************************************            
* introduce:        
* parameter:                       
* return:                 
* author:           Luee                                                    
*******************************************************************************/
void meter_read(void)
{
    u8 meter_buf[8]={0};
    modbus_rd_t *meter_read_t=(modbus_rd_t *) meter_buf;

    meter_read_t->addr=METER_ADDR;
    meter_read_t->fun=0x03;
    meter_read_t->st_addr=ENDIAN_BIG_LITTLE_16(METER_REG_ADDR);
    meter_read_t->num=ENDIAN_BIG_LITTLE_16(8);
    meter_read_t->crc16=crc16_standard(CRC_RTU, (u8_t *)meter_read_t, sizeof(modbus_rd_t) - sizeof(meter_read_t->crc16));

    //Uart_write(meter_buf, sizeof(modbus_rd_t));
    //anti_trans(meter_buf, sizeof(modbus_rd_t));
    meter_trans(meter_buf, sizeof(modbus_rd_t));
}

/*******************************************************************************            
* introduce:        
* parameter:                       
* return:                 
* author:           Luee                                                    
*******************************************************************************/


static void realtime_meter_read(void)
{
    

    if(counter)
        counter--;
    if(meter_overtime)
        meter_overtime--;
    
    if(meter_overtime==0){
        meter_data_sent=0;
    }
    if(counter==0 && online_dev_count!=0 && meter_data_sent==0){
        counter=REALTIME_METER_READ_COUNTER;
        if(anti_refluxing)
            counter=REALTIME_METER_READ_COUNTER_REFLUX;
        meter_data_sent=1;
        meter_overtime=METER_OVERTIME;
        meter_read();
    }
}

/*

static void realtime_meter_read(void)
{
    static u16 counter=REALTIME_METER_READ_COUNTER;

    if(counter)
        counter--;
    if(meter_overtime)
        meter_overtime--;
    
    if(meter_overtime==0){
        meter_data_sent=0;
    }
    if(counter==0 && online_dev_count!=0 && meter_data_sent==0){
        counter=REALTIME_METER_READ_COUNTER;
        meter_data_sent=1;
        meter_overtime=METER_OVERTIME;
        meter_read();
    }
}
*/


/*******************************************************************************            
* introduce:        
* parameter:                       
* return:                 
* author:           Luee                                                    
*******************************************************************************/
static u8_t checkDeviceOnline(void)
{
    static int onlineDeviceCount = 0;
    //闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁炬儳缍婇弻鐔兼⒒鐎靛壊妲紒鐐劤缂嶅﹪寮婚悢鍏尖拻閻庨潧澹婂Σ顔剧磼閻愵剙鍔ょ紓宥咃躬瀵鎮㈤崗灏栨嫽闁诲酣娼ф竟濠偽ｉ鍓х＜闁绘劦鍓欓崝銈囩磽瀹ュ拑韬€殿喖顭烽幃銏ゅ礂鐏忔牗瀚介梺璇查叄濞佳勭珶婵犲伣锝夘敊閸撗咃紲闂佽鍨庨崘锝嗗瘱闂備胶顢婂▍鏇㈠箲閸ヮ剙鐏抽柡鍐ㄧ墕缁€鍐┿亜韫囧海顦﹀ù婊堢畺閺屻劌鈹戦崱娆忓毈缂備降鍔庣划顖炲Φ閸曨垰绠抽悗锝庝簽娴犻箖姊洪棃娑欐悙閻庢矮鍗抽悰顕€宕堕澶嬫櫖濠殿噯绲剧€笛囧箲閸ヮ剙钃熼柣鏂挎憸閻熷綊鏌涢…鎴濇灈妞ゎ剙鐗嗛—鍐Χ鎼粹€茬凹缂備緡鍠楅幐鎼佹偩閻戣棄纭€闁绘劕绉靛Λ鍐春閳ь剚銇勯幒鎴濐仼闁绘挻娲熼弻鐔兼倻濮楀棙鐣烽梺鎶芥敱閸ㄥ湱妲愰幘瀛樺濠殿喗鍩堟禍鐐靛垝椤撱垹纾兼繝濠傛噽閿涙粌顪冮妶鍡樷拻闁哄拋鍋婇獮濠囧炊閳规儳浜炬繛鍫濈仢閺嬫稒銇勯銏℃暠濞ｅ洤锕畷濂稿即閻愯尪鈧灝鈹戦埥鍡楃仩闁圭⒈鍋呯€靛吋鎯旈妸锔规嫽婵炶揪绲介幗婊呯矓濞差亝鐓曢悗锝庝悍闊剛鈧娲橀〃鍛达綖濠婂牆鐒垫い鎺嗗亾闁伙絿鍏橀獮瀣晝閳ь剛绮绘繝姘仯闁搞儯鍔岀徊濠氭煕閻愵亜濡兼い顏勫暣婵″爼宕卞Δ鈧～搴ㄦ⒑閸濄儱孝閻庢稈鏅濈划瀣吋婢跺鈧攱銇勯幒宥囶槮鐎殿喖鐏濋埞鎴︻敊缁涘鐣跺┑鈽嗗亝椤ㄥ棝寮查懜鐢电瘈婵﹩鍘鹃崢浠嬫⒑閻熸澘鈷旈柛瀣ㄥ姂瀹曟垿濮€閵堝棛鍘搁柣蹇曞仧绾爼宕戦幘宕囨殾闁搞儯鍔嶉悾鐑芥⒑鐠囨彃鍤辩紓宥呮瀹曟粌鈽夊┃鎯у緧闂傚倷娴囬褏鈧稈鏅犻、娆撳冀椤撶偤妫峰銈嗘磵閸嬫挾鈧娲樻繛濠囧极閹版澘宸濇い鏍ㄧ⊕椤旀洟姊绘担鍛婅础闁稿簺鍊濆畷娲醇濠垫劗鍔烽梺鍐叉惈閸婅埖绂嶅⿰鍫熺厵閺夊牆澧界粙鑽ょ棯椤撶偟鍩ｉ柟顔荤矙椤㈡稑鈽夊銉㈠亾閹烘梻纾奸弶鍫涘妽瀹曞瞼鈧娲樼敮鎺楋綖濠靛鏁勯柦妯侯槷婢规洘淇婇悙宸剰閻庢稈鏅滈崚濠冪附閸涘﹦鍘搁柣蹇曞仩椤曆囧礉濮樿京妫柟顖嗗瞼鍚嬮梺鍝勭灱閸犳牠骞冨▎鎿冩晢闁逞屽墯閺呭爼顢涢悙瀵稿幗闂佸搫鍊圭€笛囁夐姀銈嗙厸閻忕偠顕ч埀顒佺箞閻涱噣寮介妸锕€顎撻柣鐔哥懃鐎氫即寮鍕ㄦ斀闁绘ɑ鍓氶崯蹇涙煕閻樺磭澧悡銈夋煏婵炑冨濞肩喖姊洪崷顓炲妺妞ゃ劌妫濆畷鎴﹀箛椤戦敮鍋撻幒鎴僵闁绘挸娴锋禒顓犵磽閸屾氨孝闁绘绻掑Σ鎰板箻鐎涙ê顎撻梺鎯х箳閹虫挾绮敓鐘斥拺闁绘垟鏅滃▍鎾绘煕閵娿劍纭炬い鏇秮椤㈡洟鏁冮埀顒傜不濞戞瑣浜滈柟鎹愭硾閺嬪酣鏌涢弬鎸庡殗婵﹥妞介幃娆撴寠婢跺﹤顫氶梻浣告啞閹稿鎳濇ィ鍐ｂ偓锕傚炊閳哄倸鐝板┑鐐存綑椤戝棝寮埀顒勬⒒娴ｈ櫣甯涢拑杈ㄣ亜閺冣偓閻楃姴顕ｉ幎绛嬫晬闁绘劕顕崢鎾绘偡濠婂嫮鐭掔€规洘绮岄埥澶愬閻樼绱遍梻渚€娼ц墝闁哄懏绋撴竟鏇熺節濮橆厾鍘棅顐㈡搐椤戝懘鍩€椤掍胶澧甸柟顔光偓鏂ユ闁靛繆鈧枼鍋撻崼鏇熺厽闁归偊鍘肩徊濠氭煃闁垮顥堥柡灞界Ч閹稿﹥寰勫Ο鎭嵮囨⒑闂堟稒鎼愰悗姘嵆閵嗕線寮撮姀鈩冩珳闂佹悶鍎弲婵嬪级閼恒儰绻嗛柣鎰典簻閳ь剚鍨垮畷鐟懊洪鍌楀亾閸愨晝绡€闁稿本绮嶅▓楣冩⒑閸︻厼鍔嬮柛銊у枛瀵劑鏁冮崒娑氬幗闂佽婢橀崥鈧紒銊嚙閳规垿鍨鹃悙钘変划闂佺妫勯悥鐓庮嚕娴犲鏁囬柣鏂挎惈楠炴绻濆▓鍨灍闁靛洦鐩畷鎴﹀箻鐎靛摜顔曟繛杈剧到閸熻法鈧凹鍣ｉ妴鍛存倻閼恒儳鍙嗛梺鍝勬川閸嬫盯鍩€椤掆偓缂嶅﹪骞冮敓鐘冲亜闂傗偓閹邦喚鐣鹃梻渚€娼ч悧鍡欌偓姘煎枤閹峰綊鎮ч崼銏㈩啎闂佸壊鍋嗛崰鎰板煕閹扮増鐓忛柛銉戝喚浼冨銈冨灪閿曘垽骞冨▎鎴斿亾閻㈢數銆婇柡浣哥Ф缁辨捇宕掑▎鎺戝帯婵犳鍠氶弫鍝ュ垝濞嗘挸绠ｉ柨鏇楀亾闁绘挴鈧剚鐔嗛悹鍝勩偨閿熺姵鍋勯柛婵嗗閻庢娊鏌℃径濠勫闁告捇浜舵俊鑸靛緞鐎Ｑ勫闂備胶鍘ч～鏇㈠磹閺囥垹鍑犻柟瀵稿Х绾惧吋銇勯弮鍥т汗闁诲繘浜堕弻鐔肩嵁閸喚浠奸柧缁樼墵閺屾稑鈽夐崡鐐茬濡炪倖姊归崹鐢糕€旈崘顔嘉ч柛鈩冾殔琛肩紓鍌欐祰鐏忣亜鈻旈弴鐑嗗殨鐟滄棃宕洪埀顒併亜閹烘垵顏柍閿嬪灦閹便劑鎮烽悧鍫熸倷闂佽绻愬鍓佹崲濞戞瑦濯撮柛鎰絻椤忣偄顭胯閳ь剚鏋奸弨浠嬫煥濞戞ê顏╁ù婊冦偢閺屾稒绻濋崘顏勨吂濡炪値鍋勭换妤呭Φ閹版澘绠抽柟鎯у帠缂冩洟姊绘担铏瑰笡閺嬵亪鎮樿箛鏃傛噰鐎殿喗濞婇弫鍐磼濞戞ü鐢绘繝鐢靛仜濡鎹㈤幇閭︽晜闁冲搫鍊舵禍婊堟煛閸ヨ埖绶氶柟鏌ョ畺閺岋紕浠︾粙鍨拤閻庡灚婢樼€氼噣鍩€椤掑﹦绉靛ù婊勭箞椤㈡瑩寮撮姀鈥充画濠电姴锕ょ€氼參藟閸懇鍋撳▓鍨灈妞ゎ厾鍏橀獮鍐閵堝懐顦ч柣蹇撶箲閻楁鈧矮绮欏铏规嫚閺屻儱寮板┑鐐板尃閸曨厾褰炬繝鐢靛Т娴硷綁鏁愭径妯绘櫔闂侀€炲苯澧い顐㈢箰鐓ゆい蹇撴噹閻у嫭绻濋姀锝嗙【闁挎洏鍎遍埢鎾诲醇閺囩啿鎷洪梺鍛婄缚閸庤鲸鐗庨梻浣虹帛椤ㄥ牊鎱ㄩ幘顕呮晪闁挎繂妫涚弧鈧┑顔斤供閸樿棄鈻嶅⿰鍕瘈闁靛骏绲剧涵楣冩煥閺囶亞鐣甸柟顖氱墦瀹曠喖顢涘☉鎺撳缂傚倷绀侀鍡欌偓绗涘喛鑰块柣妤€鐗勬禍婊堟煏婵炲灝鍔滄い銉у█閺屽秷顧侀柛鎾存皑閸犲﹤顓兼径瀣壆濡炪倖鐗楅崙鐟邦焽閺嶎厽鐓熼柟瀵稿€栭幋鐐村弿婵犲﹤鐗婇悡娆愮箾閸繄浠㈡繛鍛戞穱濠傤啅椤斿吋鐏撶紓浣介哺閹稿骞忛崨鏉戠闁告瑥锛嶉敂鍓х＝闁稿本姘ㄥ瓭闂佹寧娲忛崐婵嬨€佸鑸垫櫜闁搞儯鍔岄悵鏉库攽閻愬瓨缍戞い鎴濇閿濈偛顓兼径瀣ф嫼闂傚倸鐗婄粙鎾剁不閸愭祴鏀芥い鏃€鍎抽崢瀵糕偓瑙勬礃缁诲牓鐛鈧、娆戞喆閿濆棗顏归梻鍌欑閹诧紕绮欓幋锔芥櫇闁靛牆妫欓崣蹇擃熆閼搁潧濮堥柣鎾存礋閹鏁愭惔鈥茬凹閻庤娲栭惌鍌炲蓟閻旂⒈鏁婇柦妯侯槸婵垽姊烘导娆戠Ф缂佺粯绻堥悰顔碱吋婢跺鍎銈嗗姧缁叉儳顭块幋锔解拻闁稿本鐟ㄩ崗宀€绱掗鍛仸闁轰礁鍟撮崺锟犲川椤撶媴绱遍梻浣告啞濞诧箓宕滃☉鈧偓鍛村蓟閵夛妇鍘介梺閫涘嵆濞佳勬櫠閹殿喚纾奸柣妯垮吹閻ｆ椽鏌＄仦绋垮⒉鐎垫澘瀚埀顒婄秵娴滅偞绂掗幘顔解拺閻犲洠鈧櫕鐏嶉梺鎼炲妼婢у酣骞戦姀鐘闁靛繒濮烽ˇ褔姊洪崗鑲┿偞闁哄懏绮撳畷铏鐎涙ê鈧敻鎮峰▎蹇擃仾缂佲偓閸愵喗鐓ラ柡鍥悘鑼偓瑙勬礃濡炰粙宕洪埀顒併亜閹哄秹妾峰ù婊勭矒閺岀喖鎮滃Ο铏逛淮濡炪倕娴氭禍顏堝蓟瀹ュ鐓ラ悗锝庝簽娴煎矂姊洪崫鍕効缂傚秳绶氶悰顕€宕堕澶嬫櫖濠电偞鍨兼ご鎼佀夋径鎰拻濞达絽鎲￠崯鐐存叏婵犲倹璐￠柛鎺撳浮楠炴鎷犻懠鑸垫啺闂備焦瀵х粙鎴犫偓姘€鍥х；闁瑰墽绮弲鏌ュ箹鐎涙绠橀柡鍡橆殜濮婅櫣绮欏▎鎯у壄闂佹悶鍔岄…鐑藉春閳ь剚銇勯幒宥囪窗闁哥喎绻橀弻娑㈡偐閾忣偄纾抽悗瑙勬礃缁诲倿顢樻總绋跨倞闁冲搫鍟伴崝褰掓⒒娴ｅ憡璐￠柛搴涘€濆濠氭晸閻樿尙锛涢梺鐟板⒔缁垶寮查弻銉ョ缂侇喖鍘滈崑鎾绘嚑椤掍焦娅﹂梻鍌氬€风粈渚€骞夐敍鍕畳缂傚倷绶￠崰妤呮偡閵夆晪缍栭煫鍥ㄦ煟閸嬪﹪鎮锋担闈涒偓鎾承уΔ鍛拺闁革富鍘奸崝瀣煕閵婏箑鈻曠€规洜澧楃换婵嬪炊閵娿垺瀚奸梻浣告啞缁嬫垿銈幘顔藉€垮ù鐘差儐閻撴盯鏌涘⿰鈧粈浣圭閻愮繝绻嗛柛娆忣槸婵秹鏌熼鐣屾噰鐎规洦鍋婂畷鐔碱敇瑜嶉幃鍫ユ⒒閸屾瑧鍔嶉悗绗涘喚娼栧┑鐘宠壘閻ょ偓銇勯幇鍓佺暠闁稿被鍔岄湁闁绘ê妯婇崕鎰亜閵夈儻鏀婚柕鍥у楠炲洭鍩℃担杞扮棯闂備胶枪鐞氼偊宕濋幋锕€钃熸繛鎴炵懄閸庣喖鏌曡箛鏇炐涢柡瀣懇濮婅櫣鎷犻垾铏彎缂備胶濮甸悧鐘荤嵁閸愨晝顩烽悗锝庝簻缁愭稒绻濋悽闈浶㈤悗姘煎墴閻涱噣骞囬悧鍫㈠幗闁硅偐琛ラ埀顒€鍟挎潏鍛存⒑缁嬫鍎愰柟鐟版喘瀵顓奸崼顐ｎ€囬梻浣告啞閹搁箖宕版惔銊﹀仼闂佸灝顑呴閬嶆煛婢跺鐏╂い鏃€甯￠弻锝夋偐閸欏鍎撻梺鍦拡閸嬪﹪骞冨Ο鑽ょ瘈闁稿本顨嗛弬鈧梻浣虹帛閸旀洖顕ｉ崼鏇€澶愭倷閻戞鍘电紓浣割儐鐎笛囧箟閸濄儳纾兼い鏂垮⒔鐢盯鎮楅棃娑栧仮鐎殿喖鐖奸獮瀣偑閳ь剟宕崶銊х瘈闁汇垽娼ч崜宕囩磽瀹ュ懏顥㈢€规洘绮岄埢搴ㄥ箻閺夋垟鍋撻崼鏇熺厓闁告繂瀚崳娲煟閹惧娲撮柟顔筋殜閺佹劖鎯旈垾鑼泿闂備浇顕х换鍡涘疾濠靛牊顫曢柟鐑樻尰缂嶅洭鏌曟繝蹇曠暠缁剧偓濞婇幃妤冩喆閸曨剛顦ㄩ柣銏╁灡鐢繝宕洪姀鈩冨劅闁靛ǹ鍎抽娲⒑閹稿海绠撴繛灞傚妼閻ｇ兘宕奸弴鐔叉嫽闂佺ǹ鏈悷褔藝閿曞倹鐓欓柤鎭掑劤閻鏌熸笟鍨闁诡喕绮欓獮鏍倷閳轰椒澹曢梺鍛婂姦閸犳牕顔忓┑瀣厵婵炲牆鐏濋弸娆戠磽閸愨晜绀嬫慨濠傤煼瀹曟帒鈻庨幋顓熜滈梻浣侯攰椤曟粎鎹㈠┑鍡欐殾婵犻潧顑呯粻锝夋煥閺囨浜剧紓浣插亾濠㈣埖鍔曠粻瑙勭箾閿濆骸澧┑鈥冲悑閹便劎鎲撮崟顓炲绩闂佸搫琚崝鎴濐嚕閺夋嚦鏃堝焵椤掍胶顩插Δ锝呭暞閳锋垿鎮楅崷顓烆€屾繛鍏煎姍閺屾盯濡搁妷褌铏庨梺浼欑悼閸忔﹢鐛幒妤€绠ｉ柡鍐ｅ亾闁轰胶濞€濮婅櫣鎲撮崟顐㈠Б缂佸墽铏庨崢鍓у垝閺冨牊鎯為柛蹇擃槸娴滈箖鎮峰▎蹇擃仾缂佸矁娉曠槐鎺旂磼濡偐鐤勯梺缁樹緱閸犳骞嗛弮鍫澪╅柨鏇楀亾婵炲牏鍠栧娲濞戝磭纭€闂佸憡鍔戦崝搴敊閹达附鈷掗柛灞捐壘閳ь剟顥撶划鍫熺瑹閳ь剟鐛弽顓ф晝闁挎洍鍋撻柣銈庡枟閵囧嫰骞囬妸锕€顕樺┑鐐叉▕娴滄繈寮插┑瀣厱閻忕偛澧介埥澶嬬箾閸噦鑰块柡宀嬬秮閹垽宕妷锕€娅戦梺璇插閸戣绂嶉悙鍝勭闁靛繈鍊曢獮銏＄箾閹寸偟鎳呴柛妯哄船閳规垿鎮欓崣澶樻濠电偛鐡ㄩ懝鎯у祫缂備礁顑呯花閬嶅绩閼恒儯浜滈柡鍐ㄦ搐娴滃綊寮介敓鐘斥拺闂侇偅绋撻埞鎺楁煕閺傝法肖闁瑰箍鍨归埞鎴犫偓锝庝簽椤︽澘顪冮妶鍡樺暗闁稿鍠栭、鏇熺附閸涘ň鎷绘繛杈剧悼閸庛倝宕甸埀顒勬⒑閹肩偛鐏柣鎿勭節閻涱喗绻濋崒銈嗗缓闂侀€炲苯澧撮柣娑卞櫍瀹曟﹢濡搁姀鐘靛闂備胶枪缁绘劖鏅舵禒瀣獥闁哄稁鍘肩粻鏍ㄧ節婵犲倸鎮╅柣鏃傚帶缁€鍌炴煕韫囨洍鎷￠柛鐐茬摠缁绘繈鎮介棃娴躲儲銇勯敐搴℃灓婵″弶鍔欏鎾閻樼绱遍梻浣侯攰閹活亞绮婚幋鐘差棜鐟滅増甯楅悡娑氣偓骞垮劚濞撮攱绂嶇憴鍕鐎瑰壊鍠曠花濂告煛閸涱喚绠為柡灞剧〒娴狅箓鎮欓鍌涱吇闂備胶绮幐濠氬垂閸噮娼栨繛宸簻瀹告繂鈹戦悩鎻掆偓鎼侊綖閸ヮ剚鈷戦柛娑橈攻閻撱儵姊虹敮顔惧埌妞ゆ洩缍侀獮搴ㄦ嚍閵夛附鐝栭梻浣呵归張顒傜矙閹捐鍌ㄩ柣銏犳啞閻撴稑顭跨捄鐚村姛濠⒀嶅缁辨帡鎮╁畷鍥р吂濡炪値鍓欓敃顏堛€佸璺虹劦妞ゆ帒瀚拑鐔哥箾閹寸偛鐒归柛瀣崌閺佹劖鎯斿┑鍫㈡晨婵＄偑鍊曞ù姘跺磻閸℃瑦顫曢柟鐑樻尰缂嶅洭鏌曟繛鍨姢闁荤喆鍔戦弻褏绱掑Ο鐓庘拰闂佸搫鏈惄顖氼嚕閺夋嚦鏃€鎷呯憴鍕暘闂傚倷鑳舵灙妞ゆ垵妫濋獮鎴﹀炊椤掆偓閺勩儵鏌嶈閸撴岸濡甸崟顖氱闁瑰瓨绻嶆禒楣冩⒑缂佹ɑ灏版繛鑼枛楠炲啫螖閸涱喗娅滈柟鑲╄ˉ閳ь剝灏欓崙褰掓煟鎼淬値娼愭繛鍙夌墵閹绺界粙璺ㄥ姦濡炪倖甯掗崰姘焽閹邦厾绠鹃柟缁樺笧缁犺崵鈧娲樼换鍫ョ嵁鐎ｎ亖鏀介柟閭﹀墯椤撳潡姊绘担绋款棌闁稿鎳庣叅闁哄稁鍋嗘稉宥夋煥濠靛棭妲归柣鎾卞劜缁绘繈妫冨☉娆樻！濡炪們鍎抽崑銈夊蓟濞戙垺鍋勯柛娑樓规禒銏犫攽椤旂》宸ユい顓炲槻閻ｇ兘骞掗幋鏃€鐎婚梺鐟邦嚟婵嘲鐣烽崣澶岀瘈闁汇垽娼ф禒鎺楁煕閺嶎偄鈻堢€规洜鏁婚悡顒勫箵閹烘埈娼庨梻浣虹《閺備線宕戦幘鎰佹富闁靛牆妫楅崸濠囨煕鐎ｎ偅宕岄柡灞界Ф閹叉挳宕熼銈勭礉闂備焦鎮堕崝鎴犵不閺嶎厼绠圭憸鐗堝俯閺佸啴鏌曡箛銉х？濞存粎鍏樺铏规嫚閸欏鏀銈庡亜椤︻垳鍙呴梺鍐叉惈閸熸壆绮堟繝鍋綊鏁愰崨顔藉枑闂佸搫妫寸粻鎾诲蓟濞戞鏃堝礃閵娿倖鐫忔繝纰樺墲瑜板啴鎮ф繝鍕床婵炴垯鍨归獮銏′繆閵堝嫮鍔嶉柟鐑戒憾閺岋絾鎯旈～顓濆闂佺ǹ顑嗛崝妤€危閹版澘绠婚悹鍥皺閿涙粌鈹戦鏂や緵闁稿繑锕㈠畷鎴﹀箻缂佹ê鈧鏌ら幁鎺戝姎闁逞屽墮濞硷繝寮婚妸鈺佸嵆婵ê宕俊浠嬫⒑閻熸澘鏆遍柣顒冨亹濡叉劙骞樼拠鑼紲濠电偛妫欑敮鈺呭船瑜版帗鈷戠紒瀣儥閸庢劙鏌熼悷鐗堝枠鐎殿喛顕ч濂稿醇椤愶綆鈧洭姊绘担鍛婂暈闁规悂绠栧畷鐗堟償椤帞绋忛棅顐㈡处缁嬫帡骞嗛悙鐑樼厱闁挎棁顕ч獮姗€鏌ｉ幘瀛樺磳婵﹥妞藉畷銊︾節閸曨偀鍙ч梻渚€鈧偛鑻晶顕€鏌涘Ο鑽ゅ⒈婵″弶鍔欓弫鎰板幢濞嗘垹妲囬梻浣圭湽閸ㄨ棄顭囪閳挳姊绘担鍛靛綊顢栭崱娑樼闁搞儜灞剧稁濠电偛妯婃禍鍫曞极閸℃稒鐓冪憸婊堝礈濞戞艾鍨濋柡鍐ㄧ墕缁犵粯銇勯弮鍥棄闁逞屽墮濞硷繝寮诲☉鈶┾偓锕傚箣濠靛懐鎸夊┑鐐茬摠缁秶鍒掗幘璇茶摕闁绘梻鍘ф导鐘绘煕閺囥劌甯ㄩ柕澶嗘櫆閻撴洟鐓崶銊﹀暗闁绘帗鎮傞弻锛勪沪閸撗勫垱闂佽鍠撻崹钘夌暦椤愶箑唯闁靛鍎抽崫妤呮⒒閸屾瑧顦﹂柟纰卞亰閹绺界粙璺ㄧ崶闂佸搫璇為崨顔筋啎婵犵數鍋涘Λ娆撳箰缁嬫寧绾梻鍌欒兌绾爼宕滃┑瀣ㄢ偓鍐疀閺傛鍤ら梺璺ㄥ櫐閹凤拷0,
    //闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁炬儳缍婇弻鐔兼⒒鐎靛壊妲紒鐐劤缂嶅﹪寮婚悢鍏尖拻閻庨潧澹婂Σ顔剧磼閻愵剙鍔ょ紓宥咃躬瀵鎮㈤崗灏栨嫽闁诲酣娼ф竟濠偽ｉ鍓х＜闁绘劦鍓欓崝銈囩磽瀹ュ拑韬€殿喖顭烽幃銏ゅ礂鐏忔牗瀚介梺璇查叄濞佳勭珶婵犲伣锝夘敊閸撗咃紲闂佽鍨庨崘锝嗗瘱闂備胶顢婂▍鏇㈠箲閸ヮ剙鐏抽柡鍐ㄧ墕缁€鍐┿亜韫囧海顦﹀ù婊堢畺閺屻劌鈹戦崱娆忓毈缂備降鍔岄妶鎼佸蓟閻斿吋鍎岄柛婵勫劤琚﹂梻浣告惈閻绱炴笟鈧妴浣割潨閳ь剟骞冨▎鎾崇妞ゆ挾鍣ュΛ褔姊婚崒娆戠獢婵炰匠鍏炬稑鈻庨幋鐐存闂佸湱鍎ら〃鎰礊閺嶃劎绡€闂傚牊渚楅崕鎰版煛閸涱喚鍙€闁哄本绋戦埥澶愬础閻愬樊娼绘俊鐐€戦崕鏌ユ嚌妤ｅ啫鐓橀柟瀵稿仜缁犵娀姊虹粙鍖℃敾妞ゃ劌妫濋獮鍫ュΩ閳哄倸鈧鏌﹀Ο渚Ш闁挎稒鐩铏圭磼濡搫顫庨梺绋跨昂閸婃繂鐣烽幋鐘亾閿濆骸鏋熼柣鎾跺枑娣囧﹪顢涘┑鍡楁優濠电姭鍋撳ù鐘差儐閻撳啰鎲稿⿰鍫濈婵炴垶纰嶉鑺ユ叏濮楀棗澧婚柛銈嗘礋閺岀喓绱掗姀鐘崇亪濡炪値鍋勯幊姗€寮诲澶婄厸濞达絽鎲″▓鏌ユ⒑缂佹绠栨繛鑼枎椤繒绱掑Ο璇差€撻梺鑺ッ敍宥夊箻缂佹鍙嗗┑顔斤供閸樿绂嶅⿰鍫熺叆闁哄啫娴傞崵娆撴煛鐎ｃ劌鈧妲愰幒鎾寸秶闁靛⿵瀵屽Λ鍐倵濞堝灝鏋熼柟姝屾珪閹便劑鍩€椤掑嫭鐓冮梺娆惧灠娴滈箖姊鸿ぐ鎺濇缂侇噮鍨抽幑銏犫槈濞嗘劗绉堕梺鍛婃寙閸涘懏鑹鹃埞鎴︽倷閸欏鐝旂紓鍌氱С閻掞附绌辨繝鍕ㄥ亾濞戞瑯鐒界紒鈾€鍋撻梻浣规偠閸庮垶宕濇惔銊ュ偍闂侇剙绉甸埛鎴︽偡濞嗗繐顏╅柛鏂诲€栭妵鍕即閵娿儱绠荤紓渚囧枛椤兘骞冨▎鎾村€绘俊顖滃帶楠炲秹姊绘担钘壭撻柨姘亜閿旇鐏﹂柛鈹惧亾濡炪倖宸婚崑鎾淬亜椤撶姴鍘寸€规洘妞介崺鈧い鎺嶉檷娴滄粓鏌熼悜妯虹厐闁告梻鍠撶槐鎺撳緞鐏炵偓姣堥梺鍝勬湰閻╊垶骞冮埡浣烘殾闁搞儜鈧幏浼存⒒娴ｇ瓔鍤冮柛鐘愁殜閹兘鏁傞悙顒€搴婂┑鐘绘涧椤戝懐绮堥崘顔界叆闁哄啫娲︾涵鍫曟煟閳轰線鍙勬慨濠勭帛閹峰懘鎮滃Ο鐑樼暚闂備礁婀遍埛鍫ュ磻閸℃瑥鍨濋柡鍐ㄧ墛閸婂鏌﹀Ο渚Ш妞は佸洦鍊甸柛蹇擃槸娴滈箖姊洪崨濠冨闁告挻鐩畷銏ゆ焼瀹ュ棌鎷洪梺鍛婄箓鐎氼剟鍩€椤掑啯顥夐柍缁樻瀵挳濮€閻樿櫕袣闂備焦瀵х换鍌炈囨导瀛樺亗婵炲棙鍔戞禍婊堟煛閸愩劌鈧骞楅崒娑氱闁割偆鍠撻惌鎺楁煛瀹€瀣埌闁宠棄顦靛畷锟犳倷鐎电ǹ缍嗛梺璇叉唉椤煤閺嶎偆绀婂┑鐘叉储閳ь兛绀侀埢搴ㄥ箻閺夋垳绨甸梺鐟板悑閹矂宕板Δ鍐闁瑰墽绮埛鎺楁煕鐏炴崘澹橀柍褜鍓涢崗姗€骞婂Δ鍛唶闁哄洨鍋熼悿鍥⒑鐟欏嫬绀冩い鏇嗗洦鍋い鏇楀亾闁诡喖缍婇獮渚€骞掗幋婵愮€撮柣搴ゎ潐濞叉牕顕ｉ崼鏇炵疄闁靛ǹ鍎哄〒濠氭偣閸ヮ亜绱﹀瑙勬礃娣囧﹪濡堕崶顬儵鏌涚€ｎ偆娲寸€规洦鍨堕、鏇㈠Ψ瑜岀花鐑芥⒒閸屾瑧顦﹂柟璇х磿閸掓帡宕奸妷锕€鈧潡鏌ㄩ弴鐐测偓鎼佹偪妤ｅ啯鐓忛煫鍥ь儏閳ь剚鐗犻崺娑㈠箣閿旂晫鍘卞┑鐐村灦閿曨偊寮ㄧ拠宸唵閻犲搫鎼顓㈡煛鐏炲墽顬肩紒鐘崇洴瀵噣骞橀崗澶婁壕闁圭ǹ瀵掑▓浠嬫煟閹邦垰鐨虹紒鐘卞嵆閹繝濡堕崱鎰盎闂婎偄娲﹂幐濠氬闯閹惰姤鐓欓梺鍨儐閵囨繃鎱ㄦ繝鍐┿仢鐎规洏鍔嶇换婵嬪礋閵婏富娼旈梻鍌欑劍鐎笛兠洪埡鍐笉闁规崘顕ч弰銉╂煏婢舵稓鐣辩紒鍓佸仱閺岀喖鏌囬敃鈧獮姗€鏌涘▎蹇旑棦婵﹥妞藉畷顐﹀礋椤掑倶鍋愬┑鐐茬摠缁秶鍒掗幘璇参ラ柛娑欐儗閺佸棝鏌涚仦鍓х煂闁挎稒绮撻弻鈩冨緞婵犲嫬顣堕梺鍛婃煥缁夎埖绂嶉幖渚囨晣闁绘梻绻濈花璇差渻閵堝棗濮х紒鑼舵硶缁鎮欓悜妯煎幍闂佹儳娴氶崑鍡涙儗閹烘鐓欐い鏃囧吹閻瑦淇婇銏犳殭闁宠棄顦灒闁兼祴鏅滃鏍⒒閸屾艾鈧悂宕愰悜鑺ュ殑闁割偅娲栫粻鐘绘煙閹规劦鍤欓悷娆欑畵閹鏁愭惔鈩冪亶闂佺ǹ顑傞弲婊堝Φ閸曨喚鐤€闁规崘娉涢。娲⒑閹肩偛濡奸柛濠冩倐閸╃偤骞嬮敂钘変汗闁诲骸婀辨慨鎾夊┑瀣拺婵炶尪顕ч獮妤併亜閵娿儻韬€殿喛顕ч濂稿醇椤愶綆鈧洭姊绘担鍛婂暈闁规悂绠栧畷浼村冀椤撶姴绁﹂梺鍛婂姂閸擃噣寮崼婵堫槰闂佸疇妗ㄩ悞锕傛倵椤撱垺鈷掑ù锝呮啞閸熺偞绻涚拠褏鐣电€规洘绮岄埥澶愬煑閸濆嫭鍠樺┑鈩冩倐閸╋繝宕掑Δ浣割伖闂傚倷鑳堕、濠囧磻閹版澘纾绘繛鎴炵懁缁诲棝鏌涜椤ㄥ棝鎮″☉妯忓綊鏁愰崨顓ф闂佺粯鎸搁妶鎼佸蓟閳╁啯濯撮柣鐔告緲椤帡姊虹拠鈥虫灍闁荤喆鍎靛﹢渚€鏌ｆ惔顖滅У濞存粎鍋為弲鍫曨敍閻愮补鎷绘繛杈剧悼鏋い銉ョ箻閺屾稓鈧綆浜濋崳浠嬫煙楠炲灝鐏茬€规洜鍠栭、娑橆潩妲屾牗啸闂傚倷鐒︾€笛兠哄澶婄；闁圭偓鐣禍婊勩亜韫囨挸顏╅柡鍡到閳规垿鍨惧畷鍥х厽閻庤娲栧畷顒冪亙闂佸憡鍔︽禍婵嬪闯椤栫偞鈷掑ù锝囩摂閸ゆ瑩鎮楀☉鎺撴珚鐎规洘鐟ㄩ妵鎰板箳閹寸媭妲堕梻浣虹帛濮婂宕㈣缁顢涢悙瀵稿幍闁哄鐗撶粻鏍ь瀶椤曗偓閺屾稓鈧綆浜滈顓㈡煛鐏炲墽顬肩紒鐘崇☉椤繈顢栭幐搴ｆ綎闂傚倷绀侀幉锟犳晝閳哄倻顩叉繝闈涚墛瀹曞弶绻濋棃娑卞剱闁稿鍔戝濠氬醇閻旇　妫╅梺鐟邦嚟閸忔ê顫忛搹鍦煓婵炲棙鍎抽崜閬嶆⒑閻熺増鍟為柟顔煎€垮畷娲閻欌偓閸氬顭跨捄鐚村伐闁兼澘鐏濋埞鎴︽倷閺夋垹浠搁梺鑽ゅ暀閸パ冨亶闂備緡鍓欑粔鐢告偂閻旂厧绠归柟纰卞幖閻忥絿绱掓径鎰锭闂囧绻濇繝鍌氼伀缂佺姷鍋ら幐濠囨偄閸忚偐鍘棅顐㈡搐椤戝懘鍩€椤掍胶澧甸柟顔光偓鏂ユ闁靛繆鈧枼鍋撻崼鏇熺厽闁归偊鍘肩徊濠氭煃闁垮顥堥柡灞炬礋瀹曞崬螣閾忓湱鎳嗛梻鍌氭搐椤︾敻寮婚敐鍛瀻闊洦鏌ㄥ▍褔姊烘导娆戞偧闁轰焦鎮傞崺鈧い鎺戝枤濞兼劖绻涢崣澶樼劷闁告帗甯熺粻娑樏归弶鎸庡枠妞ゃ垺鐟╅獮瀣箳閺冨倻鏆伴梻鍌欑濠€杈╁垝椤栨粍鏆滈柣鎰摠濞呯娀鏌￠崶鈺佹瀭濞存粍绮嶉妵鍕疀閹炬剚浠奸梺鍝勬４缁蹭粙鍩為幋锕€鐏崇€规洖娲ら悡鐔兼倵鐟欏嫭纾搁柛鏂块叄閸┾偓妞ゆ帒鍊归弳鈺呭几椤忓懍绻嗛柣鎰閻瑦鎱ㄦ繝鍕笡闁瑰嘲鎳橀幃婊兾熼悜妯兼殮闂傚倷鐒﹂幃鍫曞磹閺嶎厽鍋嬮柣妯垮吹瀹撲線鐓崶銊р姇闁哄懏鎮傞弻銊╂偆閸屾稑顏�
    if (onlineDeviceList.count !=  onlineDeviceCount 
        && (MeterDevice.head != null)){
        onlineDeviceCount = 0;

        if (onlineDeviceList.count > 1){
            int i;
            
            AntiRefluxDeviceInfo_t *info;
            Device_t *meterDev = null;
            DeviceOnlineHead_t *online = null;

            online = list_nextData(&onlineDeviceList, null);
            Device_removeType(DEVICE_ARTI);
            list_delete(&invertDevice);

            while (online != null)
            {
                for (i = 0; i < sizeof(deviceTab)/sizeof(deviceTab[0]); i++)
                {
                    if (deviceTab[i]->tab.code == online->code)
                    {
                        //if (0x0200 == (online->code & 0x0200))
                        if (0x0212 == (online->code))           //婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柛娑橈攻閸欏繘鏌ｉ幋锝嗩棄闁哄绶氶弻娑樷槈濮楀牊鏁鹃梺鍛婄懃缁绘﹢寮婚敐澶婄闁挎繂妫Λ鍕⒑閸濆嫷鍎庣紒鑸靛哺瀵鈽夊Ο閿嬵潔濠殿喗顨呴悧濠囧极妤ｅ啯鈷戦柛娑橈功閹冲啰绱掔紒姗堣€跨€殿喖顭烽弫鎰緞婵犲嫷鍚呴梻浣瑰缁诲倸螞椤撶倣娑㈠礋椤栨稈鎷洪梺鍛婄箓鐎氱兘宕曟惔锝囩＜闁兼悂娼ч崫铏光偓娈垮枛椤兘骞冮姀銈呯閻忓繑鐗楃€氫粙姊虹拠鏌ュ弰婵炰匠鍕彾濠电姴浼ｉ敐澶樻晩闁告挆鍜冪床闂備胶绮崝锕傚礈濞嗘挸绀夐柕鍫濇娴滄粍銇勯幘璺盒㈤柛妯侯嚟閳ь剚顔栭崰鏍€﹂悜钘夋瀬闁归偊鍘肩欢鐐测攽閻樻彃顏柡澶婃啞娣囧﹪鎮欓鍕ㄥ亾閺嶎偅鏆滃┑鐘叉处閸婂潡鏌ㄩ弴鐐测偓鍝ュ閸ф鐓欓柛鎾楀懎绗￠梺鎶芥敱閸ㄥ潡寮婚悢鍏煎殐闁宠桨妞掔划鑸电節绾版ǚ鍋撻悙钘変划闂佸搫鏈粙鎺旀崲濠靛纾兼繛鎴灻煎ǎ顕€鏌ｆ惔銏╁晱闁哥姵鐩、姘愁樄闁糕斂鍎插鍕箛椤掑缍傞梻浣稿暱閹碱偊宕愰悷鎵虫瀺闁搞儺鍓氶埛鎺懨归敐鍥ㄥ殌妞ゆ洘绮庣槐鎺旀嫚閹绘巻鍋撳宀€浜辨繝鐢靛仦閸ㄧ喖骞婇悙鍝勭倞妞ゆ巻鍋撻崬顖炴偡濠婂啰绠冲瑙勬礋閹稿﹥绔熷┑鍡欑Ш闁轰焦鍔欏畷銊╊敊閽樺澹嶉梺璇茬箰缁绘劗鎹㈠Ο渚綎婵炲樊浜滃婵嗏攽閻樻彃顒㈤柣锝夋敱缁绘繈鎮介棃娑楃捕闂佹寧娲忛崐婵嬨€佸鑸垫櫜闁糕剝鐟ч惁鍫濃攽椤旀枻渚涢柛妯哄悑缁傚秴饪伴崼鐔叉嫼缂備礁顑堝▔鏇犵不娴煎瓨鐓熼柕濞у啫骞嬪Δ鐘靛仜缁绘垹鎹㈠┑鍡╂僵妞ゆ挾濮撮獮妤呮⒑绾懎顥嶉柟娲讳簽濡叉劙寮撮悢渚祫濠电偞鍨崹娲偂閻斿吋鐓冮柍杞扮閺嗙偟绱掗埀顒勫醇閵忋垻锛滃銈嗘⒒閳峰牓鎮℃總鍛婄厵妞ゆ梻鏅幊鍥煙椤旂晫鐭婇摶锝夋⒑閸噮鍎忔い蹇撶秺濮婂宕掑▎鎺戝帯濡炪們鍨归敃顏勭暦閹达箑绠涢柡澶庢硶閿涙稑鈹戦悙鏉戠仧闁搞劌婀辩划鍫熷緞閹邦厾鍘电紓鍌欓檷閸ㄥ綊寮搁悢鍏肩厽闁规儳鐡ㄧ粈瀣煛瀹€鈧崰鏍嵁閸℃凹妾ㄩ梺鎼炲€楅崰鏍蓟閻旂厧绀冮柛娆忣槸濞呫倗绱撴担铏瑰笡闁烩晩鍨堕悰顔锯偓锝庡枟閸嬫劙鏌ц箛锝呬簼闁伙附鎹囧缁樻媴閾忓箍鈧﹪鏌￠崒娆戠獢鐎规洘鍨块獮姗€骞囨担鐟扮槣闂備線娼ч悧鍡椢涘Δ鍐當闁圭儤顨嗛崐鍨叏濡厧甯剁€殿噮鍣ｉ弻娑㈠煛閸屾粍鍒涘Δ鐘靛仜椤戝寮崒鐐村癄濠㈣泛顦€垫煡姊婚崒娆戝妽闁诡喖鐖煎畷鏇㈡倻濡⒈娲稿┑鐘诧工閻楀﹪宕曞澶嬬叄闊洦鎸荤拹锛勭棯閹佸仮闁哄矉绲借灒閻犲洩灏欑粊椋庣磽娴ｅ搫鐝￠柛蹇ョ畱闁帮絽鐣烽幆閭︽闂傚⿴鍓﹂崜娑㈠焵椤掑喚娼愭繛娴嬫櫇瀵板﹪骞嗚閸ゆ鏌涢弴銊ュ缂佲檧鍋撻梻浣告啞閸旓箓宕㈤幆褜鐎堕柕濞炬櫆閳锋帡鏌涚仦鍓ф噮闁告柨绉归幃妤冪箔濞戞ɑ鍣虹€规洘鐓￠弻娑㈠即閵娿儳浠╃紒鐐劤椤兘寮婚敐澶婄疀妞ゆ帊璁查弸娆撴⒑閹肩偛鈧牠銆冩繝鍥ц摕婵炴垯鍨归崡鎶芥煏婵炲灝鍔氭い顐亞缁辨挻鎷呴崣澶樷偓鍡涙煕鐎ｎ偅宕屾慨濠呮濞戠敻宕ㄩ婵囩潖闂佽崵鍋炵粙蹇涘磿闂堟稓鏆︽繝濠傚暊閺€浠嬫倵閿濆懐浠涢柡鍛櫊濮婅櫣绮欑捄銊т紘闂佺ǹ顑囬崑銈夊春濞戙垹绠抽柟鐐藉妼缂嶅﹪寮幇鏉垮窛妞ゆ柨鍚嬪▓姗€姊绘担鍛婃喐闁哥姵鎹囧畷鎴︽倷閸偄搴婂┑鐐村灦绾板秶鈧碍姘ㄩ幉姝岀疀濞戞瑥浠奸梺姹囧灮椤ｄ粙宕戦幘鑸靛枂闁告洦鍓涢ˇ銉х磽閸屾氨孝闁挎洦浜幃浼搭敊绾板崬鎮戞繝銏ｅ煐钃遍柡鍛櫊濮婃椽宕ㄦ繝鍕櫍闂佺ǹ瀛╂繛濠囧箖瀹勬壋鏀介柛銉㈡櫇閻﹀牓姊哄Ч鍥х伈婵炰匠鍕浄闁挎洖鍊归悡鏇㈡煏婵炲灝鍔ら柛鈺嬬秮閺岀喖顢欓幆褍骞嬮梺杞扮劍閸旀瑥鐣烽崡鐐╂瀻婵☆垰顭烽弫婊冣攽閻樺灚鏆╁┑顔芥尦閺佸啴濡舵径瀣罕婵犵數濮村ú锕傚磻閸屾稓绠鹃柛鈩兩戠亸浼存煟閹惧鎳囬柟顔煎槻閳诲氦绠涢幙鍐ф偅濠电姵顔栭崰鏍偋韫囨稒鍎夋い蹇撶墱閺佸洭鏌ｉ弬鍨Щ濠殿喓鍨藉濠氬炊瑜滃Ο鈧梺鍝勭焿缁插€熺亽闂佸憡绻傜€氼厼袙閹邦喚纾藉ù锝呯畭娴滅偤鏌涘☉鍗炵仯闁挎稒绮撻弻鈩冨緞婵犲嫬顣堕梺鍛婃煥缁夋挳鎮惧畡鎵殕闁逞屽墴閸┾偓妞ゆ帒鍠氬鎰箾閸欏鐒介柡渚囧櫍楠炴帒螖閳ь剟鎮￠垾鎰佺唵閻犲搫褰块崼銉ュ嚑閹兼番鍔庨崣鎾绘煕閵夛絽濡藉璺哄閺岋繝宕遍鐘电槇濠殿喖锕ら…宄扮暦閹烘垟鏋庨柟鎼幗琚﹂梻鍌欑劍閻綊宕愰弴鐏绘椽顢橀姀鈩冩珳闂佺粯鍔栧娆戞閻愮儤鐓欓梺顓ㄧ畱婢ь噣鏌ｆ惔顔煎籍婵﹨娅ｇ划鏃堝幢濡も偓椤忓瓨绻涢崼鐔糕拻缂佽鲸甯￠幃鈺佺暦閸パ屾椒缂傚倷鑳剁划顖炴儎椤栨氨鏆﹂柛妤冨€ｉ悢鐑樺珰闁哄被鍎抽埀顒佹そ濮婄粯鎷呯憴鍕哗闂佺ǹ锕ュú鐔笺€侀弽銊ョ窞濠电姴瀛╃紞搴㈢節閻㈤潧校闁煎綊绠栭弻瀣炊椤掍胶鍘介梺鍝勫暙濞层垽鍩€椤戣棄浜惧┑鐘愁問閸犳牕煤椤撶儐娼栫紓浣股戞刊鎾偣閸ワ絺鍋撻崘鎻掝瀳闂傚倷绀侀幉锟犳晪婵犫拃鍡橆棄閸楅亶鏌熼悧鍫熺凡缂佺姴顭烽幃褰掑炊椤忓嫮姣㈤梺鎸庣⊕缁矂鍩為幋锔藉€烽柛娆忣樈濡繝姊洪崨濠冣拹妞ゃ劌锕ユ穱濠囨嚋闂堟侗鍤ら柣搴㈢⊕閿氶柍褜鍓欓悘姘辨崲濞戙垹閱囨繝闈涚墔閾忓酣姊洪崫鍕靛剳闁哥姵鐗犲濠氭偄閻撳海顔愭繛杈剧秬濞咃綁寮抽锔藉€甸悷娆忓缁€鍐偓鍏夊亾闁归棿鑳跺畵渚€鏌熼悜姗嗘當缂佺媴缍侀弻锟犲礃閿濆懍澹曢梻浣筋嚙妤犳悂鈥﹀畡鎷旀盯宕ㄩ幖顓熸櫇闂侀潧绻嗛埀顒佸墯濡茶鲸绻濋悽闈涗粶鐎殿喖鐖奸弫瀣⒑瀹曞洨甯涢柟鐟版喘閻涱噣宕卞鍏碱€囨繝鐢靛仦閹告悂鈥﹂悜钘夎摕闁哄洢鍨归柋鍥ㄧ節闂堟稒绁╂俊顐犲€栫换婵嬪煕閳ь剟宕堕敂钘夋灓闂備礁鎼張顒傜矙閹捐鐒垫い鎺戯功缁夌敻鏌涚€ｎ亝顥㈤柛鈺侊躬瀵挳濮€閿涘嫬骞堥梺鐟板悑閹矂宕伴弽銊ь洸闁绘鐗婇崣蹇撯攽閻樻彃顏悽顖涚洴閺岀喎鐣￠悧鍫濇畻閻庤娲﹂崑濠冧繆閻戣姤鏅滈梺娆惧灠娴滅偓銇勯弬璺ㄦ癁闁衡偓娴犲鐓冮柍杞扮閺嗘柨霉閻橀潧鈻堥柡灞剧洴瀵噣鍩€椤掑嫬鍨傞柛褎顨堝畵浣糕攽閻樿弓杩归柡鍐ㄧ墕瀹告繃銇勯幘鍗炵仼闁轰礁缍婂缁樻媴閸涘﹥鍎撳┑鐐茬湴閸旀垵鐣烽幋锔藉亜濠碘剝鎸稿ú顓€€佸璺虹劦妞ゆ巻鍋撴い顐㈢箰鐓ゆい蹇撳椤斿洭鏌熼崗鑲╂殬闁搞劌顭烽弫宥夊即閵忊檧鎷虹紓浣割儐椤戞瑩宕曢幇鐗堢厵缂佸顑欓悡鐓庘攽閿涘嫭鏆€规洜鍠栭、娑㈡晲閸℃ɑ鐝曢梻鍌欑閹测€趁洪敃鍌氱；闁告侗鍘搁弸鏃傜磽娴ｈ鐒界紒鈾€鍋撶紓浣稿⒔婢ф褰滈梺绋款儐閹告悂鎮鹃悜钘夌倞鐟滃繘宕㈡禒瀣厽閹兼番鍊ゅ鎰箾閸欏澧柣锝囧厴椤㈡宕橀鍐兒闂傚倸鍊风粈渚€骞夐敓鐘茬闁挎梻鏅々鍙夌節闂堟侗鍎忛梻鍌ゅ灡閵囧嫰寮介顫勃闂佹娊鏀辩敮锟犲蓟濞戞矮娌柛鎾楀嫬娅橀梻浣告啞閺屻劎绮旇ぐ鎺戠畺婵°倕鍟扮粻鏃€绻涢幋鐏活亪鐛Ο浣曟棃鏁冩担鍦€婇梺姹囧€愰崑鎾寸節閻㈤潧浠﹂柛銊ョ埣閳ワ箓宕堕浣规珫闂佺粯鏌ㄩ崥瀣煕閹达附鍋℃繛鍡楃箰椤忊晠鏌涢弮鍥х厫濞ｅ洤锕、鏇㈠閻欌偓娴煎啴姊虹拠鈥虫灓闁稿鍊曢悾鐤亹閹烘繃鏅濋梺缁樓规禍顒勬儎鎼淬劍鈷掑ù锝囧劋閸も偓闂佸湱鈷堥崑鍡欏垝閺冨牊鍊婚柦妯侯槺椤ρ囨倵閸忓浜鹃梺鍛婃处閸撴盯宕㈤柆宥嗏拺缂備焦蓱閻撱儵鏌熼懞銉х煉鐎规洩缍侀崺鈧い鎺戝閳锋垿鏌涘┑鍡楊伀闁诲繘浜堕弻娑㈡偐瀹曞洤鈪归梺浼欑到閸㈡煡鍩㈡惔銊ョ婵犮垹瀚囬崶銊у幈闂佹枼鏅涢崰姘枔閵忕妴鍦兜闁垮顏�
                        {
                            InvertList_t *deviceList;
                            Device_t *invsterDev = null;

                            invsterDev = list_nodeApply(sizeof(Device_t));
                            info = memory_apply(sizeof(AntiRefluxDeviceInfo_t));

                            info->addr = online->addr;
                            info->aux =(AntiReflux_t *) &deviceTab[i]->tab;
                            invsterDev->cfg = null;
                            invsterDev->callBack = ArtiReflux_InvDataAck;
                            invsterDev->explain = info;
                            invsterDev->type = DEVICE_ARTI;
                            list_init(&invsterDev->cmdList);
                            deviceList = list_nodeApply(sizeof(InvertList_t));
                            deviceList->dev = invsterDev;
                            list_bottomInsert(&invertDevice, deviceList);

                            Modbus_GetCmdAdd(&invsterDev->cmdList, online->addr, deviceTab[i]->tab.cmdTab, deviceTab[i]->tab.count*sizeof(ModbusGetCmd_t));
                        }
                        else if (0x0400 == (online->code & 0x0400))
                        {
                            if (meterDev == null)
                            {
                                meterDev = list_nodeApply(sizeof(Device_t));
                                info = memory_apply(sizeof(AntiRefluxDeviceInfo_t));

                                info->addr = online->addr;
                                info->aux = (AntiReflux_t *) &deviceTab[i]->tab;
                                meterDev->cfg = null;
                                meterDev->callBack = ArtiReflux_meterDataAck;
                                meterDev->explain = info;
                                meterDev->type = DEVICE_ARTI;
                                list_init(&meterDev->cmdList);
                            }

                            Modbus_GetCmdAdd(&meterDev->cmdList, online->addr, deviceTab[i]->tab.cmdTab, deviceTab[i]->tab.count*sizeof(ModbusGetCmd_t));
                        }
                    }
                }
                online = list_nextData(&onlineDeviceList, online);
            }

            if ((meterDev != null)
                && (invertDevice.count > 0)
            )
            {
                onlineDeviceCount = onlineDeviceList.count;
                Device_add(meterDev);
                list_trans(&invertDevice, invterAdd, null);
            }
            else
            {
                deviceDel(meterDev);
                list_trans(&invertDevice, invterRemove, null);
                list_delete(&invertDevice);
            }   
        }
        return 1;
    }

    return 0;
}

static u8_t invterAdd(void *load, void *val)
{
    InvertList_t *deviceList = load;

    Device_add(deviceList->dev);

    return 1;
}

static u8_t invterRemove(void *load, void *val)
{
    InvertList_t *deviceList = load;

    deviceDel(deviceList->dev);

    return 1;
}

static void deviceDel(Device_t *dev)
{
    if (dev != null)
    {
        DeviceCmd_clear(dev);
        list_nodeDelete(null, dev);
    }
}

/*******************************************************************************
  * @note   inv Data Collect
  * @param  None
  * @retval None
*******************************************************************************/
//static void ArtiReflux_InvDataAck(Device_t *dev)
static u8_t ArtiReflux_InvDataAck(Device_t *dev)
{
    AntiRefluxDeviceInfo_t *info = (AntiRefluxDeviceInfo_t*)dev->explain;
    u8_t result = 0;

    list_trans(&dev->cmdList, modbusDataCheck, &result);

    if (result == 0)
    {
        if (meterPower.state == 1)
        {
            info->aux->func(invertDevice.count, dev, &meterPower);
            if (meterPower.state != 1)
            {
                return result;
            }
        }
    }

    dev->lock = 0;
    return result;
}

static u8_t invterLockStatus(void *load, void *val)
{
    InvertList_t *invert = load;
    u8_t *pVal = val;

    if (invert->dev->lock == 0)
    {
        *pVal = 1;

        return 0;
    }

    return 1;
}

static u8_t invterUnlock(void *load, void *val)
{
    InvertList_t *invert = load;

    invert->dev->lock = 0;

    return 1;
}

//static void ArtiReflux_meterDataAck(Device_t *dev)
static u8_t ArtiReflux_meterDataAck(Device_t *dev)
{
    AntiRefluxDeviceInfo_t *info = (AntiRefluxDeviceInfo_t*)dev->explain;
    u8_t result = 0;

    dev->lock = 0;
    list_trans(&dev->cmdList, modbusDataCheck, &result);

    if (result == 0)
    {
        u8_t flag = 0;

        info->aux->func(0, dev, &meterPower);
        list_trans(&invertDevice, invterLockStatus, &flag);
        if (flag == 0)
        {
            APP_DEBUG("Invter unlock!!\r\n");
            list_trans(&invertDevice, invterUnlock, null);
        }
    }
    return result;
}

/*******************************************************************************
  * @note   data check
  * @param  None
  * @retval None
*******************************************************************************/
u8_t modbusDataCheck(void *load, void *changeData)
{
    int ret;
    DeviceCmd_t *cmd= (DeviceCmd_t*)load;

    if (0 == cmd->state)
    {
		ret = Modbus_CmdCheck(&cmd->cmd, &cmd->ack);
		cmd->state = (u8_t)ret;
		if (ret != 0)
		{
            *((u8_t*)changeData) = 1;
        }
    }
    else
    {
        *((u8_t*)changeData) = 1;
    }
 
	return 1;
}

/*******************************************************************************            
* introduce:        
* parameter:                       
* return:                 
* author:           Luee                                                    
*******************************************************************************/
void updata_anti_reflux_para(void)
{
    Buffer_t buf;
    u32 buf_value;
    float f;

    //get para 96,anti reflux enable or disable?
    SysPara_Get(96, &buf);
    buf_value = Swap_charNum((char *)buf.payload);   
    APP_DEBUG("anti_reflux_en=%ld\r\n",buf_value);
    anti_reflux_en=0;       
    if(buf_value)
        anti_reflux_en=1;   //anti reflux enable
    memory_release(buf.payload);

    //get para 97,anti reflux threshlod
    SysPara_Get(97, &buf);
    f=my_atof((char *)buf.payload);
    anti_threshold=f/1000;      //kw
    APP_DEBUG("anti_threshold=%f\r\n",anti_threshold);
    memory_release(buf.payload);
}

/*******************************************************************************
  * @note   None
  * @param  None
  * @retval None
*******************************************************************************/
static void Anti_reflux_init(void)
{
    antibuf.payload=NULL;
    meterPower.state = 0;
    list_init(&invertDevice);

    updata_anti_reflux_para();
}

int float2int(u32_t data)
{
#if 0  //闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁炬儳缍婇弻鐔兼⒒鐎靛壊妲紒鐐劤缂嶅﹪寮婚悢鍏尖拻閻庨潧澹婂Σ顔剧磼閻愵剙鍔ょ紓宥咃躬瀵鎮㈤崗灏栨嫽闁诲酣娼ф竟濠偽ｉ鍓х＜闁绘劦鍓欓崝銈囩磽瀹ュ拑韬€殿喖顭烽幃銏ゅ礂鐏忔牗瀚介梺璇查叄濞佳勭珶婵犲伣锝夘敊閸撗咃紲闂佺粯鍔﹂崜娆撳礉閵堝洨纾界€广儱鎷戦煬顒傗偓娈垮枛椤兘骞冮姀銈呯閻忓繑鐗楃€氫粙姊虹拠鏌ュ弰婵炰匠鍕彾濠电姴浼ｉ敐澶樻晩闁告挆鍜冪床闂備胶绮崝锕傚礈濞嗘挸绀夐柕鍫濇川绾剧晫鈧箍鍎遍幏鎴︾叕椤掑倵鍋撳▓鍨灈妞ゎ厾鍏橀獮鍐閵堝懐顦ч柣蹇撶箲閻楁鈧矮绮欏铏规嫚閺屻儱寮板┑鐐板尃閸曨厾褰炬繝鐢靛Т娴硷綁鏁愭径妯绘櫓闂佸憡鎸嗛崪鍐簥闂傚倷娴囬鏍垂鎼淬劌绀冮柨婵嗘閻﹂亶姊婚崒娆掑厡妞ゃ垹锕ら埢宥夊即閵忕姷顔夐梺鎼炲労閸撴瑩鎮橀幎鑺ョ厸闁告劑鍔庢晶鏇犵磼閳ь剟宕橀埞澶哥盎闂婎偄娲ゅù鐑剿囬敃鈧湁婵犲﹤鐗忛悾娲煛鐏炶濡奸柍瑙勫灴瀹曞崬鈻庤箛鎾寸槗缂傚倸鍊烽梽宥夊礉瀹€鍕ч柟闂寸閽冪喖鏌ｉ弬鍨倯闁稿骸鐭傞弻娑樷攽閸曨偄濮㈤悶姘剧畵濮婄粯鎷呴崨濠冨創闂佹椿鍘奸ˇ杈╂閻愬鐟归柍褜鍓熸俊瀛樻媴閸撳弶寤洪梺閫炲苯澧存鐐插暙閳诲酣骞樺畷鍥跺晣婵＄偑鍊栭幐楣冨闯閵夈儙娑滎樄婵﹤顭峰畷鎺戔枎閹寸姷宕叉繝鐢靛仒閸栫娀宕楅悙顒傗槈闁宠閰ｉ獮瀣倷鐎涙﹩鍞堕梻鍌欑濠€閬嶅磿閵堝鈧啴骞囬鍓ь槸闂佸搫绉查崝搴ｅ姬閳ь剟姊婚崒姘卞濞撴碍顨婂畷鏇㈠箛閻楀牏鍘搁梺鍛婁緱閸犳岸宕ｉ埀顒勬⒑閸濆嫭婀扮紒瀣灴閸┿儲寰勯幇顒傤攨闂佺粯鍔曞Ο濠傤焽缂佹ü绻嗛柣鎰典簻閳ь剚鍨垮畷鏇㈠蓟閵夛箑娈炴俊銈忕到閸燁偊鎮″鈧弻鐔衡偓鐢登规禒婊呯磼閻橀潧鈻堟慨濠呮缁瑩宕犻埄鍐╂毎婵＄偑鍊戦崝灞轿涘┑瀣祦闁割偁鍎辨儫闂佸啿鎼崐鎼佸焵椤掆偓椤兘寮婚敃鈧灒濞撴凹鍨辨闂備焦瀵х粙鎺楁儎椤栨凹娼栭柧蹇撴贡绾惧吋淇婇姘儓妞ゎ偄閰ｅ铏圭矙鐠恒劍妲€闂佺ǹ锕ョ换鍌炴偩閻戣棄绠ｉ柣姗嗗亜娴滈箖鏌ㄥ┑鍡涱€楅柡瀣枛閺岋綁骞樼捄鐑樼€炬繛锝呮搐閿曨亪銆佸☉妯锋斀闁糕剝顨嗛崕顏呯節閻㈤潧袥闁稿鎸搁湁闁绘ê妯婇崕鎰版煟閹惧啿鏆熼柟鑼归オ浼村醇濠靛牜妲繝鐢靛仦閸ㄥ墎鍠婂澶樻晝闁兼亽鍎查崣蹇旀叏濡も偓濡鏅舵繝姘厱闁靛牆妫欑粈瀣煛瀹€鈧崰鎾舵閹烘顫呴柣妯虹－娴滎亝淇婇悙顏勨偓銈夊磻閸曨垰绠犳慨妞诲亾鐎殿喛顕ч鍏煎緞婵犲嫬骞愬┑鐐舵彧缁蹭粙骞夐垾鏂ユ灁闁哄被鍎查埛鎴犵磽娴ｈ鐒界紒鐘崇墵閺岋絽螖閸愩剱銏°亜椤愩垻绠崇紒杈ㄥ笒铻ｉ柤娴嬫櫆閸ゅ矂姊绘笟鈧埀顒傚仜閼活垱鏅堕幘顔界厱闁宠鍎虫禍鐐繆閻愵亜鈧牜鏁幒妤€纾归柛娑橈功椤╅攱绻濇繝鍌滃闁绘挾濮电换娑㈡嚑妫版繂娈梺璇查獜缁绘繈寮婚敓鐘插窛妞ゆ挾濮撮悡鐔兼倵濞堝灝鏋︽繛澶嬬洴閸┿垺鎯旈妸銉ь槶閻熸粌绉瑰顐﹀箹娴ｅ厜鎷洪梺鐓庮潟閸婃洟寮搁幋锔界厽闁绘梹娼欓崝銈夋煃瑜滈崜姘跺礄瑜版帒鍌ㄩ柛鎾楀啫鐏婇梺鍓插亐閹冲洭宕戦幘缁樻櫜閹肩补鍓濋悘宥夋⒑缂佹ɑ灏伴柣鐕傜畵婵＄敻宕熼姘辩潉闂侀€炲苯澧寸€规洘娲熼獮搴ㄦ寠婢跺﹤浜堕梺璇插缁嬫帡鏁冮埡浣叉灁濞寸姴顑嗛悡鐔兼煙闁箑鐏遍柛銈咁儔閺岋繝鍩€椤掑嫭鍤掗柕鍫濇川閿涙粎绱撻崒娆戝妽妞ゎ厼娲ㄧ划濠氭倷绾版ê浜鹃悷娆忓缁€鍐偨椤栨稑娴柕鍫簼鐎靛ジ寮堕幋婵堢崺闂備礁鎲℃笟妤呭磻閸曨剚鍙忛柛灞剧⊕閸欏繐鈹戦悩鍙夊櫤妞ゅ繒濞€閺岀喐顦版惔鈾€鏋呴梺鎼炲姂缁犳牠骞栬ぐ鎺濇晝闁靛牆瀚悥閬嶆⒒閸屾艾鈧绮堟笟鈧獮鏍敃閿曗偓缁犵娀鐓崶銊р姇闁稿骸瀛╅妵鍕冀椤愵澀鏉梺閫炲苯鍘哥紒鈧笟鈧崺銏℃償閵娿儳顔婇梺鍝勫暙閸婄懓顭块幋鐐电瘈闁汇垽娼ф禒锕傛煕閵娿儱鎮戦柕鍥ㄦ楠炴牗鎷呴崫銉︾叄闂備礁鍟块幖顐﹀箠韫囨稑鐓曢柟瀵稿Х绾捐棄霉閿濆牆浜楅柟瀵稿С閻掑﹥銇勯幘璺衡偓锝夊籍閸喎浜归悗瑙勬礀濞诧箓骞夊▎鎾粹拺閻犲洩灏欑粻鐗堢箾鐏炲倸濡挎俊鍙夊姍楠炴鎷犻懠顒婄床婵犳鍠楅敃鈺呭礂濮椻偓瀹曟垿骞樼拠鑼啇婵炶揪绲介幗婊堟晬濞嗘挻鈷戠憸鐗堝笚閿涚喓绱掗埀顒佹媴閸濆嫷妫滈悷婊呭鐢鎮″▎鎾粹拻闁稿本鍑归崵鐔搞亜閿旂厧顩柣銉邯楠炲棜顦寸紒澶嬫そ閺岋紕浠﹂崜褉妲堥梺瀹狀潐閸ㄥ灝鐣烽悢纰辨晝闁靛繒濮岄幋锔解拻濞达綀顫夐妵鐔兼煕濡湱鐭欐鐐村灴瀹曞爼顢楅埀顒勬嫅閻斿吋鐓ユ繝闈涙－濡插憡銇勯銏″殗闁哄矉绲借灒闁告繂瀚В鎰版⒑閸濆嫭顥滈柣妤佹尭椤繘鎼归崷顓犵厯濠电偛妫欓崕鎶藉礈閺夋娓婚柕鍫濇閻忋儲銇勯敃鍌涙锭妞ゆ洩绲剧换婵嗩潩椤撶喐顏熼梻浣虹帛鏋悘蹇旂懇瀹曟劙鎮欓悜妯锋嫼闂佸湱枪濞撮绮婚幘缈犵箚妞ゆ劧缍嗗▓鏃堟煃鐠囪尙孝妞ゎ偅绻堥幊婊呭枈濡顏归梻鍌氬€风欢锟犲磻閸℃稑纾绘繛鎴欏灪閸ゆ劖銇勯弽銊р姇婵炲懐濞€閺岀喖顢涢崱蹇撲壕闂佽　鍋撳ù鐘差儐閻撳啴鏌曟径鍫濆闁绘繍浜弻娑㈡偐閹存劖鍨块妴鍐Ψ閳哄倸鈧兘鏌℃径瀣仼濞寸厧鐭傞幃妤冩喆閸曨剛顦梺鍝ュУ閻楃娀濡存担绯曟婵☆垳鍋炵敮鐐寸閹间礁鍐€闁靛⿵濡囪ぐ瀣⒒娴ｅ憡鎯堥悶姘煎亰瀹曟繈骞嬪┑鎰闂佸搫顦伴崵锕傚籍閸繄鍔﹀銈嗗笂閼冲爼銆呴弻銉︾厱闁圭偓顨呴幊鎰版晬濠婂牊鈷戦柛娑橈攻鐎垫瑩鏌涢埄鍐夸緵闁逞屽墯椤ㄥ﹤顫忓ú顏勭闁绘劖褰冮～鍛攽閻愬樊妲归柣鈺婂灦閺佹劙鎮欓崜浣烘澑濠电偞鍨堕悷锕傚磿椤忓牊鈷戦梻鍫氭櫅閻︽粓鏌涘鈧粻鏍极瀹ュ應鍫柛鎰剁稻閺傗偓闂備礁鐤囧Λ鍕涘Δ鍛€堕柕澶涘缁犻箖鏌涘⿰鍐ㄦ殶缂佸宕电槐鎺楀磼濞戞ɑ璇炲Δ鐘靛仦閻楁骞忛崨鏉戞嵍妞ゆ挾鍋涚猾宥夋⒒閸屾瑧顦﹂柟璇х節瀹曟繈鏁冮崒姘辩崶闂佸搫娲㈤崹鍦不閻旇偤鏃堟晲閸涱厽娈查梺缁樻尰缁嬫捇鍩€椤掆偓閸樻粓宕戦幘缁樼厓鐟滄粓宕滈悢椋庢殾濞村吋娼欓崘鈧銈嗘尵閸嬬喖鎮鹃崫鍕ㄦ斀闁绘ǹ顕滃銉╂煟濡も偓濡稓鍒掓繝姘櫜濠㈣泛顑囬崢鐢告⒑缂佹ê鐏﹂拑閬嶆倶韫囷絽寮柡宀嬬磿閳ь剨绲婚崝宀勫焵椤掍胶澧遍柟骞垮灩閳规垿宕辫箛鏃備簴闂備礁澹婇悡鍫ュ窗濡ゅ懏鍊堕柛顐犲劜閳锋垿鏌熺粙鍨劉缁剧偓鎮傞弻娑㈠棘鐠恒劎鍔梺绯曟杺閸ㄥ綊顢橀崗鐓庣窞閻庯綆鍋呴悵鎶芥⒒娴ｈ鍋犻柛搴㈢矒瀹曟﹢顢旈崘銊︾€冲┑鐘垫暩婵兘寮幖浣哥；婵炴垶顭傚☉妯锋瀻闁规儳鍟块悗顓㈡煟閻樿崵绱版繛鍜冪秮瀵娊鏁冮埀顒勨€﹂崸妤佸殝闂傚牊绋戦～宥夋⒑缂佹ɑ灏紒缁樺姍閸╃偤骞嬮敂钘夆偓鐑芥煙鐎涙绠撻柡鍡愬灲閹顫濋銏犵ギ闂佸搫澶囬崜婵嬪箯閸涘瓨瀵犲璺侯槹閻繒绱撻崒娆愮グ濡炲瓨鎮傞獮鎴﹀炊瑜忛弳锕傛煙閻戞ê鐒炬繛灏栨櫆閵囧嫰骞嬮敐鍡╂婵炲瓨绮嶉崕鎶解€旈崘顏佸亾閿濆簼绨绘い鎺嬪灪閵囧嫰骞囬鍡欑厯闂佸搫琚崝鎴﹀箖閵忋倕浼犻柛鏇熷灟閸ㄨ崵妲愰幒妤€绠涙い鎾楀嫮鏆﹀┑鐑囩到濞层倝鏁冮鍛箚闁割偅娲栧婵囥亜閺傚灝鎮戞い蹇曞Х缁辨捇宕掑▎鎺戝帯婵犳鍠氶弫濠氬箖閿熺姵鏅搁柣妯垮蔼閹芥洖鈹戦悙鏉戠仧闁搞劎鎳撻弫顕€姊绘担鐑樺殌闁宦板妿閹广垽宕卞▎灞戒壕婵ê宕。鑲╃磼缂佹娲寸€规洜鍘ч埥澶娢熸笟顖溾偓瀵哥磽閸屾瑨鍏岀紒顕呭灣閹广垽宕奸妷銉х暫婵炲濮撮鍡浰夐崼鐔虹缁炬儳顑愰崯鍥╃磽瀹ュ嫮绐旂€殿喖顭锋俊鑸靛緞婵犲啫绁舵俊鐐€栭幐楣冨磻濡崵鐝堕柡鍥ュ灪閳锋垹绱掔€ｎ亞浠㈤柣锔哄姂閺屾稓鈧綆浜峰銉︺亜椤愩垻绠崇紒杈ㄥ笒铻ｉ悹鍥ф▕閳ь剚鎸剧槐鎾存媴閸撴彃鍓遍柣搴ｇ懗閸愬啯甯￠獮鍥偋閸碍瀚奸梻渚€娼荤€靛矂宕㈤幖浣哥闁跨喓濮甸悡鏇㈡倵閿濆簼鎮嶇€规悶鍎甸弻锝夋晲閸パ冨箣濡ょ姷鍋涘ú顓烆嚕閸洖鍨傛い鏂垮⒔瀹曠儤绻濋悽闈浶ラ柡浣告啞閹便劎鈧數纭堕崑鎾愁潩椤掆偓濡插鎮￠妶澶嬬厵闂傚倸顕崝宥夋煃闁垮鐏╃紒杈ㄦ尰閹峰懏鎱ㄩ幋顓濈凹闁逛究鍔嶅鍕箛椤撶姴骞堥梺鍦帶閻°劎绮欓幋锕€鐒垫い鎺嶈兌缁犵偟鈧娲栭幖顐﹀煡婢舵劕顫呴柣妯活問閸氬懘姊绘担铏瑰笡妞ゎ厼娲顐﹀箹娴ｈ娅栧┑鐘诧工閻楀﹪鎮￠悢鐓庣闁圭⒈鍘奸悘锝囩磼婢跺本鏆柡灞剧〒閳ь剨缍嗘禍婊堫敂椤撶喆浜滈柕寰涖倕顥濆Δ妤婁簷閸楀啿鐣烽悢纰辨晣闁绘ê鐏氶～宀勬⒒閸屾瑧绐旈柍褜鍓涢崑娑㈡嚐椤栨稒娅犻悗娑欙供濞堜粙鏌ｉ幇顖氱毢閺佸牆顪冮妶鍐ㄧ仾闁荤啿鏅涢悾宄扳堪閸♀晜顎夌紓鍌欐祰妞存悂鎮￠垾鎰佹綎闁惧繗顫夌€氭岸鏌熺紒妯虹瑨婵絾鍔楃槐鎾诲磼濮樻瘷銏′繆椤愶絿绠撻柣锝囧厴楠炲鏁冮埀顒傜矆鐎ｎ偁浜滈柡宥冨妿閳藉鏌嶈閸撴瑩鎮ユ總绋跨畺婵°倐鍋撻柍钘夘槸閳诲秵娼忛妸褏鐓佺紓浣稿€哥粔鎾偑娴兼潙閱囬柣鏂挎惈鐢箖姊绘繝搴′簻婵炲眰鍊濋弫鍐Χ閸℃ɑ鐝烽梺鍛婄懃椤︻厽绂嶅⿰鍫熺厪濠㈣泛鐗嗛崝銈咁熆瑜濈粻鎾诲蓟閿涘嫪娌紒瀣仢閳峰姊洪悷鏉挎Щ闁硅櫕鍔欓獮澶愬箻椤旇偐顦板銈嗗姂閸娧呮閿曞倹鈷掗柛灞剧懄缁佺増淇婂鐓庡闁诡喚鍋ら弫鍐磼濮橀硸鍞归梻浣规偠閸庢椽宕滃▎鎾冲嚑濞撴埃鍋撻柡宀€鍠栧畷婊嗩槾閻㈩垱鐩弻锟犲川椤旇棄鈧劙鏌＄仦璇插闁诡喓鍊濆畷鎺戔槈濮楀棔绱� 1
    s8_t S;     //缂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁炬儳缍婇弻鐔兼⒒鐎靛壊妲紒鐐劤缂嶅﹪寮婚悢鍏尖拻閻庨潧澹婂Σ顔剧磼閻愵剙鍔ょ紓宥咃躬瀵鎮㈤崗灏栨嫽闁诲酣娼ф竟濠偽ｉ鍓х＜闁绘劦鍓欓崝銈囩磽瀹ュ拑韬€殿喖顭烽幃銏ゅ礂鐏忔牗瀚介梺璇查叄濞佳勭珶婵犲伣锝夘敊閸撗咃紲闂佺粯鍔﹂崜娆撳礉閵堝洨纾界€广儱鎷戦煬顒傗偓娈垮枛椤兘骞冮姀銈呯閻忓繑鐗楃€氫粙姊虹拠鏌ュ弰婵炰匠鍕彾濠电姴浼ｉ敐澶樻晩闁告挆鍜冪床闂備胶绮崝锕傚礈濞嗘挸绀夐柕鍫濇川绾剧晫鈧箍鍎遍幏鎴︾叕椤掑倵鍋撳▓鍨灈妞ゎ厾鍏橀獮鍐閵堝懐顦ч柣蹇撶箲閻楁鈧矮绮欏铏规嫚閺屻儱寮板┑鐐板尃閸曨厾褰炬繝鐢靛Т娴硷綁鏁愭径妯绘櫓闂佸憡鎸嗛崪鍐簥闂傚倷鑳剁划顖炲礉閿曞倸绀堟繛鍡樻尭缁€澶愭煏閸繃宸濈痪鍓ф櫕閳ь剙绠嶉崕閬嶅箯閹达妇鍙曟い鎺戝€甸崑鎾斥枔閸喗鐏堝銈庡幘閸忔﹢鐛崘顔碱潊闁靛牆鎳愰ˇ褔鏌ｈ箛鎾剁闁绘顨堥埀顒佺煯缁瑥顫忛搹瑙勫珰闁哄被鍎卞鏉库攽閻愭澘灏冮柛鏇ㄥ幘瑜扮偓绻濋悽闈浶㈠ù纭风秮閺佹劖寰勫Ο缁樻珦闂備礁鎲￠幐鍡涘椽閸愵亜绨ラ梻鍌氬€烽懗鍓佸垝椤栫偛绀夐柨鏇炲€哥粈鍫熺箾閸℃ɑ灏紒鈧径鎰厪闁割偅绻冨婵堢棯閸撗勬珪闁逞屽墮缁犲秹宕曢柆宥呯闁硅揪濡囬崣鏇熴亜閹烘垵鈧敻宕戦幘鏂ユ灁闁割煈鍠楅悘鍫濐渻閵堝骸骞橀柛蹇斆锝夘敃閿曗偓缁犳稒銇勯幘璺轰户缂佹劗鍋炵换婵嬫偨闂堟刀銏ゆ倵濮樺崬鍘寸€规洏鍎靛畷銊р偓娑櫱氶幏缁樼箾鏉堝墽鎮奸柟铏崌椤㈡艾饪伴崨顖滐紲闁荤姴娲﹁ぐ鍐焵椤掆偓濞硷繝鎮伴钘夌窞濠电偟鍋撻～宥夋⒑闂堟稓绠冲┑顔惧厴椤㈡瑩骞掗弮鍌滐紳闂佺ǹ鏈悷褔宕濆鍡愪簻妞ゆ挾鍋為崰妯尖偓瑙勬磸閸ㄥ搫顭囪箛娑樜╃憸蹇涙儊閸儲鈷戞慨鐟版搐閻忓弶绻涙担鍐插暟閹姐儵姊婚崒娆掑厡閺嬵亪鏌ㄩ弴妯衡偓妤冩閻愬绡€闁稿本绮嶅▓楣冩⒑绾懏褰х紒鐘冲灥閺侇噣姊绘担绋挎毐闁圭⒈鍋婂畷鎰節濮橆剙鍋嶉梺褰掓？閻掞箓鎮￠悢鑲╁彄闁搞儯鍔嶇粈鈧繛瀵稿Л閺呮粓濡甸崟顖氬嵆闁糕剝顨呴顏堟煕濞嗗繒绠婚柡灞剧〒娴狅箓骞嗚濡粓姊虹粙娆惧剱闁瑰憡鎮傞崺銏ゅ箻鐠囨彃鐎銈嗘⒒閺咁偅绂嶉崼鏇熲拻濞达絿鍎ら崵鈧梺瑙勭ゴ閸撴繄鎹㈠☉娆戠瘈闁搞儮鏅涚粊锕傛⒑閸涘﹤濮傞柛鏂款樀瀵憡鎯旈敐鍌氫壕闁汇垽娼ч。鑲╃磼鐠囨彃鈧悂鏁冮姀銈嗙劶鐎广儱鎳愰崝锕€顪冮妶鍡楃瑨闁挎洩濡囩划鏃堟濞淬垻鎳撻オ浼村礋椤撶喎娅楃紓鍌欑劍濮婂宕伴弽褜鍤曢柟缁㈠枛椤懘鏌嶉柨顖氫壕闂佸綊鏀卞钘夘潖濞差亜宸濆┑鐘插暙闂夊秹鎮峰⿰鍕凡闁哥噥鍨崇划瀣吋閸涱亝鏂€闂佹悶鍎弲婵嬵敊閺囥垺鈷戦柛娑橈功閹冲啯銇勯敃渚€鍝洪柡鍛埣閹粙宕ㄦ繝鍕箥婵＄偑鍊栧褰掑磿閾忣偆顩烽弶鍫氭杹閸嬫挾鎲撮崟顒傤槬缂傚倸绉撮敃顏堝Υ娓氣偓瀵挳濮€閳ュ厖姹楅梺鍝勵槸閻楀啴寮插┑鍡忔灃闁秆勵殕閳锋帡鏌涚仦鍓ф噯闁稿繐鐭傞弻鐔兼惞椤愶絽纾冲Δ鐘靛仦閻楃娀銆侀弴銏犵厬闁兼亽鍎抽埥澶愭懚閺嶎灐褰掓晲閸曨噮鍔呭┑鐐村絻閹测剝绌辨繝鍥ч煫鍥ㄦ礀閸╁矂姊洪崫銉ユ珡闁搞劌鐖煎畷鍝勨槈閵忕姷顓洪梺鎸庢⒒閺咁偊宕㈤崡鐐╂斀闁绘绮☉褔鎮楀鐓庡⒋鐎规洘绻傞～婵嬫嚋閻㈤潧骞愰梺璇插嚱缂嶅棝宕戦崟顖涘€堕柟缁㈠枟閻撴稓鈧厜鍋撻柍褜鍓熷畷浼村冀瑜忛弳锕傛煏婵犲繐顩紒鈾€鍋撻梻浣呵归張顒勩€冮崱娑欏€堕柛鈩冪⊕閳锋帒霉閿濆洨鎽傞柛銈呭暣閺屾盯鎮╅搹顐ゎ槹閻庤娲╃换婵嬬嵁鎼淬垺鍙忛柟鑸妼娴滄儳霉閿濆懎顥忔繛灏栨櫊閹銈﹂幐搴哗闂佸憡妫戠粻鎴︹€旈崘顔嘉ч柛鈩冾殔濞兼垿姊虹粙娆惧剱闁圭懓娲濠氭晲婢跺娅滈梺鎼炲劀閸愩劎顓洪梺璇叉唉椤煤閺嶎厼围缂佸顑欓崵鏇㈡煙缂併垹鏋涢幆鐔兼⒑閹稿孩顥嗗┑顔哄€濋幃闈涒堪閸曨厾鐦堥梺姹囧灲濞佳嗏叿闂備焦鎮堕崝搴ㄥ储瑜旈崺銏ゅ棘鎼存挻顫嶉梺闈涚箚閺呮粓寮查悙鐑樷拺缂侇垱娲栨晶鏌ユ煏閸ャ劎娲寸€殿喚枪椤撳吋寰勭€ｎ剙骞嶉梻浣告啞閹稿棝宕ㄩ鐙€鍋ч梻鍌欑劍婵炲﹪寮ㄦ潏鈺傛殰闁圭儤顨嗙粻鎺楁⒒娴ｇ懓顕滅紒璇插€块獮濠呯疀濞戞鏌堥梺缁樺姉閸庛倝鎮￠弴銏＄厽闁哄倹瀵ч幆鍫澝归悩璁虫喚闁哄备鈧磭鏆嗛悗锝庡墰琚﹂梻浣筋嚃閸犳捇宕愬┑鍡欐殾闁圭儤鍨熼崼顏堟煕濞戞ɑ鍣虹紒顔芥崌楠炲啫螖閸愨晛鏋傞梺鍛婃处閸撴盯藝閵娿儮鏀介柣鎰硾閻ㄦ椽鏌涢悩宕囧⒌闁诡喕鍗抽、娆撴嚍閵夈儱濡抽梻渚€娼чオ鐢电不閹存績鏋旈柣鏂垮悑閳锋垿姊婚崼鐔剁繁婵℃彃鐖奸弻娑欐償濠靛棗绁梺璇″枤閺咁偆妲愰幒鎳崇喖鎳栭埡鍐╊潓闂傚倷鐒﹂惇褰掑垂閽樺鐒界憸鏃堝春閵忋倕閱囬柣鏃囨椤旀洘绻涙潏鍓у埌闁哥喎鐏濋湁闁稿瞼鍋涢弸渚€鏌涢弴銊ョ仭闁绘挻娲熼弻宥夊煛娴ｅ憡娈堕梺瀹犳椤︾敻寮婚敐澶婄閻庢稒顭囬ˇ浼存⒑閸濆嫮鐏遍柛鐘崇墵楠炲啫饪伴崗鍓у枛閹粌顫滈崱妤佹殽闂備浇宕甸崰鎰垝鎼淬垺娅犳俊銈呭暞閺嗘粍淇婇妶鍛櫣闁汇倝绠栭弻锛勪沪鐠囨彃濮曢梺缁樻尰濞茬喖寮婚敓鐘茬倞闁靛鍎遍‖鍫濃攽閻愬弶鍣洪柨鏇樺灲瀵鈽夐姀鐘愁棟闂佸湱枪妤犵ǹ鈻撳Δ鈧埞鎴︻敊绾兘绶村┑鐐叉嫅缂嶄線鐛崘鈺侇嚤闁哄鍨规导瀣⒑缁嬭法绠伴柟鍐查叄钘熸慨姗嗗幘缁♀偓闂佹眹鍨藉褎绂掑⿰鍕╀簻闁哄洢鍔屽顔锯偓瑙勬磸閸ㄥジ藝瑜版帗鐓欐い鏃囧Г閵囨繂鈹戦埄鍐╁€愰柛鈺嬬節瀹曟帒顫濋銈嗘婵犵數濮烽弫鎼佸磻濞戞娑樷枎閹惧磭顦┑掳鍊曢崯鐗堢▔瀹ュ憘鏃堟晲閸涱厽娈查梺缁樻尵婵挳鍩為幋锕€纾兼慨姗嗗墻濡矂姊洪崫鍕垫Ч婵＄偘绮欏璇测槈閵忊€斥偓鐑芥煠閸涘⿴鍟忓ù鐘櫇缁辨挻鎷呮禒瀣懙闁汇埄鍨崜婵囩┍婵犲偆娼扮€光偓婵犲唭顏呯節閻㈤潧浠滈柟鍐茬箰鐓ら柣鏃傚帶閽冪喓鈧箍鍎遍悧婊冾瀶閵娾晜鈷戦柛娑橈攻鐏忎即鏌ｉ悢鍙夋珚妤犵偛鍟灒濞撴凹鍨遍崓闈涱渻閵堝棗绗掓い锕備憾瀹曨剟妫冨☉鎺撴杸濡炪倖鏌ㄩ～鏇熺濠婂牊鐓曢悗锝庡亝瀹曞矂鏌＄仦绋垮⒉闁瑰嘲鎳愮划娆撳箰鎼淬埄鍟嬮梻鍌欐祰濡椼劎绮堟笟鈧畷鎰板锤濡も偓缁犳牗绻涢崱妯绘儎闁轰礁妫楅…璺ㄦ崉娓氼垰鍓崇紓浣割儐閸旀瑥顫忔繝姘＜婵炲棙鍩堝Σ顔尖攽閻橆偄浜鹃梻渚囧墮缁夊澹曢崸妤佺厪闁割偅绻嶅Σ鎼佹煕濮橆剛绉洪柡灞诲姂瀵挳鎮欏ù瀣壕鐟滅増甯掔壕濠氭煕閺囥劌鐏￠柣鎾存礃缁绘繈妫冨☉娆樻濡炪倕娴氭禍顏堝蓟閿濆棙鍎熼柕蹇曞Л閺嬫瑩姊洪崫鍕槵闁告挻绻傞銉╁礋椤掑倻鐦堥梺鍛婃处閸嬫帡寮抽妷鈺傗拻濞达絽鎲￠崯鐐存叏婵犲倻绉虹€规洖缍婂畷褰掝敋閸涱厽顓挎俊鐐€栭崝蹇涘箠閸ヮ剙閱囨い蹇撶墛閻撴洘銇勯幇鈺佲偓鏇㈠汲闁秵鐓欓梺鍨儐閵囨繃鎱ㄦ繝鍐┿仢闁诡喒鍓濋幆鏃堫敊閻ｅ瞼鈼ラ梻鍌欒兌鏋柨鏇樺劚鐓ら柣鏂款殠閸ゆ洟鏌熼梻瀵割槮缂佺媴缍侀弻锝呂熼崗鍏兼瘎闂佹寧绋掔划宀勨€旈崘顔嘉ч柛鈩兦氶幏濠氭⒑閸涘⿴鐒奸柛銉ㄥ煐閺呫垽姊洪棃娑氱疄闁稿﹥鐗犻幃鈥斥槈閵忥紕鍘卞┑鐐村灦閼归箖銆傞懖鈺冩／妞ゆ挶鍨婚悾娲煙閽樺鍩ｇ€殿喕绮欓、姗€鎮㈤崫鍕疄闂傚倷鑳堕、濠囧春閸ヮ剙绀夌€广儱鎳夐弸宥夋煕閳╁喚鐒界紒鐘荤畺閺屾盯顢曢妶鍛€剧紓浣藉煐閻擄繝寮诲鍥ㄥ枂闁告洦鍋嗘禒绋课旈悩闈涗粶闁挎洦浜璇测槈濞嗘垹鐦堥梺鍛婂姀閺呮繈藝閺夎鏃堟偐闂堟稐绮堕梺鎸庢磸閸斿海鍒掔拠娴嬫婵☆垶鏀遍～宥呪攽閳藉棗鐏ｉ柕鍡楊儑濡叉劙鏌嗗鍡忔嫽婵炶揪绲介幊娆掋亹閹烘挸鍓舵繝闈涘€绘灙缁炬儳顭烽弻锝夊箛椤旂厧濡洪梺绋款儏閸婂潡鎮￠锕€鐐婇柕濠忛檮閸庡酣姊虹紒妯荤叆婵☆偅绻堥獮鍐亹閹烘挻鍎梺鑽ゅ枑濠㈡ɑ淇婇崫鍕垫富闁靛牆鍟崝銈夋煕鐎ｎ剙浠ч柟骞垮灩閳藉濮€閻樿尙鐛╂俊鐐€栭幐楣冨闯閵夈儙娑㈡晝閸屾稈鎷洪梺鍛婄箓鐎氼噣鎮炵捄銊х＝鐎广儱瀚粣鏃堟煟濞戝崬鏋涢摶锝夋煕韫囨洖甯剁痪缁㈠灦濮婅櫣绱掑Ο铏逛桓濡炪値鍘煎ú锔剧矉瀹ュ鏁傞柛顐ゅ暱閹风粯绻涙潏鍓у埌闁硅绻濋獮鍡涘醇閵夛妇鍘藉銈嗘尵閸庢劕危濞差亝鐓欐鐐茬仢閻忊晠鏌嶇憴鍕伌鐎规洖宕埢搴ㄥ箛椤撗冩櫗闂傚倸鍊风粈浣圭珶婵犲洤纾婚柛娑卞姸濞差亜鍐€妞ゆ挾鍠庢禍妤€鈹戦悙鏉戠仸闁崇鍊涢妵鎰板箳閹惧瓨鐝冲┑鐘灱閸╂牞鎽銈冨劜閻楃姴顫忛搹瑙勫厹闁告粈鐒︾紞鍫濃攽閻愯泛鐨洪柛鐘查叄閿濈偠绠涢弴鐘碉紲濠碘槅鍨甸崑鎰板箠濠靛鈷戦梺顐ゅ仜閼活垱鏅堕幘顔界厱闁宠鍎虫禍鐐繆閻愵亜鈧牜鏁幒妤€纾归柛娑橈功椤╅攱绻濇繝鍌滃闁绘挾濮电换娑㈡嚑妫版繂娈梺璇查獜缁绘繈寮婚敓鐘插窛妞ゆ挾濮撮悡鐔奉渻閵堝啫鐏柣鐔叉櫊楠炲啴骞嗚閺嗗棝鏌嶈閸撶喖骞嗘笟鈧畷濂稿Ψ閿旇瀚奸梻鍌欑贰閸嬪棝宕戝☉銏″殣妞ゆ牗绋掑▍鐘绘煙缂併垹鏋熼柣鎾寸洴閹﹢鎮欑捄鐩掓挻銇勯妷锔剧煁闁靛洤瀚伴獮姗€鎮欓挊澶夊垝闁诲氦顫夊ú蹇涘礉閹达负鈧礁鈽夊鍡樺兊濡炪倖鍩堥崑鍛洪弽顓炵厴闁硅揪闄勯弲顒勬煕閺囥劌浜楅柡澶樺弮濮婅櫣绮欓崠鈩冩暰闂佺粯顨嗙划鎾愁嚕椤愶富鏁婇柣锝呯灱閻﹀牓姊洪幖鐐插姌闁告柨鑻埢鎾诲箣閿旇В鎷洪梺鍛婃尰瑜板啯绂嶅┑鍥╃闁告瑥顦辨晶鐢告煙椤斿吋鍋ユい銏″哺閸┾偓妞ゆ帒瀚拑鐔兼煥濞戞ê顏ф繛宀婁邯閹綊宕堕妸銉хシ婵犳鍠楀ú鐔奉潖閾忓湱纾兼俊顖濐嚙闂夊秹姊洪懡銈呮毐闁哄懐濮撮锝囨嫚濞村顫嶉梺闈涚箳婵兘顢橀崫鍕ㄦ斀闁绘劕寮堕ˉ婊呯磼鐠囧弶顥㈢€规洘鍨块獮妯兼嫚閹绘帒鏁ゆ俊鐐€栭崝妤呭窗鎼淬垻顩查柣鎰靛墯閸欏繑淇婇婊冨付濞存粓绠栭幃妤€顫濋悙顒€顏�
    s8_t  E;    //闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁炬儳缍婇弻鐔兼⒒鐎靛壊妲紒鐐劤缂嶅﹪寮婚悢鍏尖拻閻庨潧澹婂Σ顔剧磼閻愵剙鍔ょ紓宥咃躬瀵鎮㈤崗灏栨嫽闁诲酣娼ф竟濠偽ｉ鍓х＜闁绘劦鍓欓崝銈囩磽瀹ュ拑韬€殿喖顭烽幃銏ゅ礂鐏忔牗瀚介梺璇查叄濞佳勭珶婵犲伣锝夘敊閸撗咃紲闂佺粯鍔﹂崜娆撳礉閵堝洨纾界€广儱鎷戦煬顒傗偓娈垮枛椤兘骞冮姀銈呯閻忓繑鐗楃€氫粙姊虹拠鏌ュ弰婵炰匠鍕彾濠电姴浼ｉ敐澶樻晩闁告挆鍜冪床闂備胶绮崝锕傚礈濞嗘挸绀夐柕鍫濇川绾剧晫鈧箍鍎遍幏鎴︾叕椤掑倵鍋撳▓鍨灈妞ゎ厾鍏橀獮鍐閵堝懐顦ч柣蹇撶箲閻楁鈧矮绮欏铏规嫚閺屻儱寮板┑鐐板尃閸曨厾褰炬繝鐢靛Т娴硷綁鏁愭径妯绘櫓闂佸憡鎸嗛崪鍐簥闂傚倷娴囬鏍垂鎼淬劌绀冮柨婵嗘閻﹂亶姊婚崒娆掑厡妞ゃ垹锕ら埢宥夊即閵忕姷顔夐梺鎼炲労閸撴瑩鎮橀幎鑺ョ厸闁告劑鍔庢晶鏇犵磼閳ь剟宕橀埞澶哥盎闂婎偄娲ゅù鐑剿囬敃鈧湁婵犲﹤鐗忛悾娲煛鐏炶濡奸柍瑙勫灴瀹曞崬鈻庤箛鎾寸槗缂傚倸鍊烽梽宥夊礉瀹€鍕ч柟闂寸閽冪喖鏌ｉ弬鍨倯闁稿骸鐭傞弻娑樷攽閸曨偄濮㈤悶姘剧畵濮婄粯鎷呴崨濠冨創闂佹椿鍘奸ˇ杈╂閻愬鐟归柍褜鍓熸俊瀛樻媴閸撳弶寤洪梺閫炲苯澧存鐐插暙閳诲酣骞樺畷鍥跺晣婵＄偑鍊栭幐楣冨闯閵夈儙娑滎樄婵﹤顭峰畷鎺戭潩椤戣棄浜剧紒瀣紩濞差亜围濠㈢櫢绠戝ú顓㈠箖閻ｅ瞼鐭欓柤鎰佸灡閹蹭即姊绘笟鈧褎鐏欓梺绋垮瘨閸ｏ絽顕ｉ妸锔绢浄閻庯綆鍋嗛崢閬嶆⒑閹惰姤鏆滈柛瀣崌閺岋繝宕ㄩ鍓х厑闂佸搫鎳岄崕鑼崲濠靛鍋ㄩ梻鍫熺◥缁爼姊虹€癸附婢樻慨鍌溾偓瑙勬礀閻忔岸骞嗛弮鍫澪╅柕澹秶涓插┑鐘垫暩婵炩偓婵炰匠鍥舵晞闁告稑鐡ㄧ€氬懘鏌ｉ弬鍨倯闁绘挸绻橀弻娑㈩敃閿濆洨顓煎┑鈩冨絻閹芥粎妲愰幒妤佸亼婵炲棗绻戞径鍕煟閹惧鎳呯紒杈ㄥ笧閳ь剨缍嗘禍婵嬪磻閵夛负浜滈幖娣焺濞堟棃妫佹径鎰厽婵☆垱瀵ч悵顏堟倶韫囥儳鐣甸柡宀€鍠栭、娆戠驳鐎ｎ偆鏆ラ梻浣哥－缁垶骞戦崶褏鏆︾憸鐗堝俯閺佸﹪鏌ｉ敐鍛殭闂侇収鍨跺濠氬磼濞嗘帒鍘＄紓渚囧櫘閸ㄥ爼骞冭楗即宕煎┑鍡椾憾闁荤喐绮嶅Λ鍐嵁閸愨斂鍋呴柛鎰ㄦ櫅閳ь剙顭烽弻銈夊箒閹烘垵濮庢繛瀛樼矋椤ㄥ﹪寮婚悢鍏煎亗閹艰揪绲鹃幉濂告煢閸愵參鍝洪柕鍥у椤㈡洟濮€閳惰￥鍨介弻宥囨喆閸曨偆浼岄梺绯曟杺閸庨潧鐣烽崡鐐嶆棃宕樿閸╂盯姊绘担钘夊惞濠殿噮鍙冨畷鎴﹀箻缂佹鍙嗛梺鍝勬川閸嬫盯鍩€椤掆偓缂嶅﹤鐣烽幇鐗堝仺缁剧増锚娴滈箖鏌ｉ悢鍛婄凡妞ゅ浚浜滈…鍧楁偡闁箑鍓堕悗娈垮枔閸斿秶绮嬮幒鏂哄亾閿濆骸浜為柛妯圭矙濮婇缚銇愰幒鎴滃枈闂佸憡鎸诲畝鎼佸春閵忋倕鍗抽柕蹇ョ磿閸橀亶姊洪棃娑氬婵炲眰鍊濆鍛婃償閵婏妇鍘撻柣鐔哥懃鐎氼剟鎮樼€涙ǜ浜滈柕蹇ョ磿閹冲洭鏌熼鐣屾噰妞ゃ垺顨嗛幏鍛村捶椤撶噥娼犻梻鍌氬€搁崐椋庣矆娓氣偓楠炴饪伴崟顒€寮块梺鍦檸閸犳寮插┑瀣厪闁割偅绻嶅Ο鍫ユ煛娴ｅ憡鎼愰柍瑙勫灴瀹曟帒鈹冮幘宕囩Ш闁诡喗鐟︾换婵嬪炊閵娧冨妇濠电姷鏁搁崑娑㈡倶濠靛绀夋慨妯夸含绾惧ジ鏌曟繝蹇曞埌闁告梹绮庣槐鎺旂磼濡偐鐤勯梺璇″枙缁瑥螞閸愩劉妲堥柟鐑樻尵閳ь剛澧楃换婵嬫偨闂堟稐绮ч梺鍛婄墱婵炩偓鐎规洖鐖奸幊婊堝垂椤愶絿褰堥梻鍌氬€烽懗鍓佹兜閸洖绀堟繝闈涚墢閻瑩鏌熺€电ǹ孝妞ゃ儲鑹鹃埞鎴︽偐瀹曞浂鏆￠梺缁樻尭缁绘劙鍩為幋锔藉€烽梻鍫熺◥婢规洖鈹戦悙鍙夊櫣婵☆偅绻堝璇差吋婢跺鍙嗛柣搴秵娴滄繄鎷犻悙鐑樷拺闁告繂瀚﹢浼存煟閳哄﹤鐏﹂柕鍡曠窔瀵挳濮€閻樻爠鍥ㄧ厱婵炴垵宕弸銈吤瑰⿰鍕⒌婵﹦绮幏鍛村传閵夘垳绀婃俊鐐€栭崹璺好洪悢椋庢殾闁哄洢鍨洪崑銊х磼鐎ｎ厼鍔甸柟鑺ユ礀閳规垿鎮欓弶鎴犱桓闁艰￥鍊濋弻锟犲焵椤掍胶顩烽悗锝庡亞閸橀亶姊洪棃娑辨Ф闁告柨鐭傞幃锟犲箛閻楀牏鍘介梺鎸庣箓閻楀﹦娑甸悙顑句簻妞ゅ繐瀚弳锝呪攽闄囬崺鏍箚閺傚簱鏀介柛顐犲灪閺呫劑姊婚崒娆戭槮闁硅姤绮撳畷鐗堟償閵婏箑浠遍梺闈涒康婵″洭鍩炲鍛斀闁绘ê寮堕幖鎰版⒑閸楃偞鍠橀柡宀嬬節瀹曞爼鍩℃担椋庢崟闂備礁鍚嬪姗€鎮樺┑瀣厴闁硅揪绠戦悡锟犳煕閳╁喚娈樺ù鐙€鍨跺娲礃閹绘帗些闂佺粯顨呭Λ妤€鐣甸崟顖涒拺閻熸瑥瀚烽崯蹇涙煕閻樿櫕鐨戝瑙勬礃缁傛帞鈧綆鍋嗛崢閬嶆煟韫囨洖浠滃褌绮欓獮濠囧川鐎涙ê浠梺褰掑亰娴滄粌鐣甸崱娑欑厸閻忕偛澧藉ú鎾煙椤旇娅呴柣锝囧厴瀹曟儼顦柛姘€垮濠氬磼濮橆厽鎮欏銈忓閺佽顕ｆ繝姘櫜濠㈣泛锕﹂娲⒑閹稿海绠撴俊顐幖铻為柛鏇ㄥ幘绾捐棄霉閿濆棗绲诲ù婊堢畺濮婅櫣鍖栭弴鐐测拤缂備礁顑嗙敮锟犲箖閳ユ枼鏋庨柟鎯ь嚟閸樹粙姊洪悷閭﹀殶闁稿﹥鐗犻獮瀣偐鏉堚晛澧鹃梻浣圭湽閸ㄥ寮崫銉ヮ棜濠靛倸鎲￠悡鍐⒑濞嗘儳鐏犲ù婊堢畺濮婅櫣绮欏▎鎯у壉闂佽鐡曞畷鐢稿箲閵忕姭鏀介柛鈥崇箲閻忎線姊洪崜鑼帥闁哥姵顨婇幃妯侯吋婢跺鎷洪梺鍦圭€涒晝澹曢悽鍛婄厸闁告侗鍨板瓭闂佷紮绲介崲鏌ャ偑娴兼潙绀冮柨婵嗘－濞兼棃姊绘笟鈧褏鎹㈤崱娑樼柧婵犲﹤鐗嗛悿楣冩煃閸濆嫭鍣洪柍閿嬪灴閺屾盯鏁傜拠鎻掔闂佸憡鏌ㄩ鍡涘Φ閸曨垰惟闁靛瀵屽Λ锕傛⒑缁洘娅嗛柣鈺婂灦閻涱喚鈧綆鍠楅崑鎰版煕閹邦剙绾ч柣搴ㄧ畺濮婄粯鎷呴搹鐟扮濡炪們鍔岄幊姗€骞冭瀹曞崬螣鐏忔牗鏁垫俊鐐€栭悧婊堝磻閻愮儤鍋傛繛鎴欏灪閻撴洟鏌嶉埡浣稿箻妞ゅ繐妫涚粻鏃傛喐韫囨洘顫曢柟鐑樻尰缂嶅洭鏌曟繛鍨姕閻犲洨鍋ゅ铏瑰寲閺囩喐婢掗梺绋款儐閹告悂鈥旈崘顔嘉ч柛鈩冾殘閻熸劙姊虹紒妯洪嚋闂傚嫬瀚板畷姘節閸曘劌浜鹃梻鍫熺⊕閹插摜鐥幆褍鎮戦柕鍥у瀵粙濡歌婵洨绱撴担鎻掍壕闂佸憡鍔﹂崰妤呮偂閻旇偐鍙撻柛銉戝嫭宕崇紓浣瑰姈濮婂綊骞堥妸锔剧瘈闁告劏鏂傛禒銏犫攽閳藉棗浜滈柛鐕佸亰濠€渚€姊洪棃娑辨Ф闁稿氦娅曢弲鍫曟晜闁款垰浜炬繛鍫濈仢閺嬬喓鎲搁弶鍨殻闁靛牜浜濈€靛ジ寮堕幋锕€鏁规繝鐢靛█濞佳囨偋閸℃稓宓侀柛顐犲劜閳锋帒霉閿濆嫯顒熼柡鈧导瀛樼厵婵炶尪顔婇柇顖涙叏婵犱胶鐭欑€规洜鍠栭、娑橆潩閹插骞㈤梻鍌欑劍閺嬪ジ寮插☉銏犵柈闁规鍠氭稉宥呂旈敐鍛殲闁绘挻娲熼弻宥夊煛娴ｅ憡鐏撳┑鐐茬墛椤洨妲愰幒妤佸亹闂傚牊渚楅弳顓㈡⒑闂堟稒鎼愰悗姘煎灣缁鈽夊▎鎴犵槇闂佸憡鍔忛弲婵娿亹鐎ｎ喗鈷掑ù锝呮啞閹牓鏌￠崼顐㈠⒋闁诡垰瀚伴、娑橆潩閻撳孩顓挎俊鐐€栧ú宥夊磻閹惧灈鍋撶憴鍕闁绘牕鍚嬫穱濠傤潰瀹€濠冃ч梻渚€鈧偛鑻晶顖炴煕閺冣偓閻熴儵锝炶箛娑欐優闁稿繐顦禍楣冩煕閿旇骞栨い搴℃湰缁绘盯宕楅悡搴☆潚闂佸搫鏈惄顖涗繆閹间礁唯闁挎洍鍋撳ù鐘虫尦濮婃椽妫冨☉娆樻缂備讲鍋撳〒姘ｅ亾闁糕斂鍨洪幆鏃堝Ω閵壯屽晪闂備胶枪缁绘劙骞婇幇鐗堝€峰┑鐘叉处閳锋帒霉閿濆懏鍟為柛鐔哄仦缁绘盯骞撻幒鏃傤啋閻庤娲樼换鍕閿曞倸绀堢憸婊兠洪幖浣光拺缂備焦锚婵箓鏌涢幘瀵搞€掔€殿啫鍥х劦妞ゆ帒瀚埛鎺楁煕鐏炵偓鐨戝褎绋撶槐鎺斺偓锝庡亜濞搭噣鏌℃担鍝バ㈡い鎾冲悑瀵板嫮鈧綆鍓欓獮鍫ユ⒒娓氣偓濞佳囨偋閸℃あ娑樷枎閹寸姷鐒奸柣搴秵閸犳鎮″☉姘ｅ亾閸忓浜鹃柣搴秵閸撴盯鏁嶉悢鍝ョ閻庣數枪椤庢挸鈹戦垾铏枠妤犵偛绻橀幃鈺冩嫚閼碱剦鍞介梻浣告贡閸庛倝宕洪崼婵愮劷婵炴垶姘ㄧ壕浠嬫煕鐏炴崘澹橀柍褜鍓涢崗姗€骞婂Δ鍛殝闁割煈鍋勫鍧楁⒑缂佹ê鐏辨俊顐㈠缁鎮╃紒妯煎幍闂佸憡鎸嗛崨顓狀偧缂傚倷鑳舵慨鐢垫暜閳ユ剚娼栫紓浣股戞刊鎾煟閻旂厧浜伴柛銈咁儑缁辨挻鎷呯粵瀣闂佺ǹ锕ゅ锟犳偘椤旂晫绡€闁告侗鍨抽弶鎼佹⒑閸濆嫭宸濋柛鐘查叄椤㈡棃骞栨担鍏夋嫼闁荤姵浜介崝宀勫几閺傚簱鏀芥い鏃傚亾閺嗩剟鏌熼鍡欑瘈鐎殿喗鎸抽幃銏ゆ惞鐠団€虫櫗闂傚倷鑳剁涵鍫曞礈濠靛鈧啴宕奸姀顫瑝闂佸憡鐟ラˇ顓熺濠婂牊鐓忓鑸电〒閸掍即鏌ｈ箛锝勯偗闁哄瞼鍠愮粭鐔煎垂椤旂⒈鐎寸紓鍌欒兌缁垳鎹㈤崼婵堟殾闁靛ň鏅╅弫瀣煕濞戝崬澧柟钘夘儑缁辨捇宕掑顑藉亾瀹勬噴褰掑炊閵婏絼绮撻梺鍛婄缚閸庢煡寮冲⿰鍫熺厵闁绘垶蓱缁€鍫澝瑰⿰鈧划娆忣潖缂佹ɑ濯撮柛婵嗗娴犳ê顪冮妶搴′簼婵炶尙鍠庨悾鐑藉箛閺夎褔鏌涘☉妯轰喊缂傚秳绶氶妴浣肝旈崨顓狀槹濡炪倖鍨兼慨銈団偓姘虫閳规垿鎮欓懜闈涙锭缂備浇寮撶划娆撶嵁婵犲倵鏋庨柟鍝勵儎濮规姊洪崷顓炲妺闁规瓕顕ч埢宥夊炊椤掍讲鎷洪梻鍌氱墛缁嬫挻鏅堕弴銏＄厵闂佸灝顑呴悘鎾煙閾忣偅宕岀€规洜枪铻栧ù锝呭级鐎氬吋淇婇悙顏勨偓鏍ь啅婵犳艾纾婚柟鎯у绾剧厧顭跨捄渚剱閻忓骏绠撻弻鐔碱敊閹傛閻庤娲栫紞濠囥€侀弴銏″亹閺夊牃鏅濆▔鍧楁⒒閸屾瑨鍏岄柟铏崌楠炴牠顢曢妶鍥╃厠闂佺粯鍨煎Λ鍕矆閸屾壕鍋撻崗澶婁壕闂佸憡娲﹂崜娑㈠储闁秵鈷戠紓浣股戦悡銉╂煙閼恒儳鐭掔€规洩缍侀崺鈧い鎺戝閳锋垿鏌涘┑鍡楊伀闁诲繘浜堕弻娑㈡偐瀹曞洤鈪归梺浼欑到閸㈡煡鍩㈡惔銊ョ婵犮垹瀚囬崶銊у幈闂佹枼鏅涢崰姘枔閵忕妴鍦兜闁垮顏�
    u32_t F;    //闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁炬儳缍婇弻鐔兼⒒鐎靛壊妲紒鐐劤缂嶅﹪寮婚悢鍏尖拻閻庨潧澹婂Σ顔剧磼閻愵剙鍔ょ紓宥咃躬瀵鎮㈤崗灏栨嫽闁诲酣娼ф竟濠偽ｉ鍓х＜闁绘劦鍓欓崝銈囩磽瀹ュ拑韬€殿喖顭烽幃銏ゅ礂鐏忔牗瀚介梺璇查叄濞佳勭珶婵犲伣锝夘敊閸撗咃紲闂佺粯鍔﹂崜娆撳礉閵堝洨纾界€广儱鎷戦煬顒傗偓娈垮枛椤兘骞冮姀銈呯閻忓繑鐗楃€氫粙姊虹拠鏌ュ弰婵炰匠鍕彾濠电姴浼ｉ敐澶樻晩闁告挆鍜冪床闂備胶绮崝锕傚礈濞嗘挸绀夐柕鍫濇缁♀偓闂侀€炲苯澧撮柡灞芥椤撳ジ宕ㄩ姘曞┑锛勫亼閸婃牜鏁幒妤€纾圭憸鐗堝笒閸氬綊鏌嶈閸撶喖寮婚敐鍡樺劅闁靛繒濮村В鍫ユ⒑閸涘﹦鎳冮柛鐕佸亰閹儳鐣￠幍顔芥闂佹悶鍎滅仦缁㈡％闂備浇顕ч崙鐣屽緤婵犳艾绀夐悗锝庘偓顖嗗吘鏃堝川椤旇瀚奸梻渚€娼荤€靛矂宕㈡總绋跨閻庯綆鍠楅悡鏇㈡煏婵炲灝鍔ょ紒澶庢閳ь剝顫夊ú姗€宕濆▎鎾崇畺婵炲棗娴氶崯鍛亜閺冨洦顥夐柣锔界矒濮婄粯绗熼埀顒€顭囪閹囧幢濡炪垺绋戣灃闁告劦浜為悾鍫曟⒑閸︻厼鍔嬮柟姝屽煐缁傚秴饪伴崼鐔哄弳闂佸搫鍊藉▔鏇熺閵忊懇鍋撶憴鍕碍婵☆偅鐩崺鈧い鎺嶇贰閸熷繘鏌涢悩鎰佹疁闁诡噯绻濋弫鎾绘偐椤旂懓浜惧〒姘ｅ亾鐎殿噮鍣ｅ畷鐓庘攽鐎ｎ亝鏆梻鍌欒兌缁垰螞娴ｆ悶鈧帟銇愰幒鎾充缓缂傚倷鐒﹂…鍥╁姬閳ь剟姊哄Ч鍥х伈婵炰匠鍐懃闂傚倷鐒︾€笛兠鸿箛娑樼９婵犻潧妫涢弳锔姐亜閺嶎偄浠滅紒鐘劜閵囧嫰寮崹顔剧◤缂備焦顨呴ˇ杈╂閹捐纾兼繛鍡樺灥婵′粙姊洪幐搴㈢５闁哄懏鐩崺銏ゅ箻鐎靛壊娴勯柣搴秵閸嬪棝宕㈡禒瀣拺鐟滅増甯掓禍浼存煕濡吋娅曠紒杈╁仱楠炲鏁傞悾灞藉箺闂傚⿴鍋勫ú锕€顫忛崷顓犵闁硅揪闄勯悡鍐偡濞嗗繐顏╅柣蹇撶摠閵囧嫰濮€閿涘嫭鍣伴梺璇″櫍閺€閬嶆晬閹邦厽濯撮柛鎾冲级椤ワ繝姊婚崒姘偓鎼佸磹閹间礁纾瑰瀣椤愯姤鎱ㄥ鍡楀⒒闁绘帞鏅幉鎼佸籍閸繄鐣洪悷婊勬煥閻ｇ兘宕￠悙鈺傤潔濠碘槅鍨甸崑鎰板几閸愵喗鈷掑ù锝囩摂濞兼劕顭块悷鐗堫棡闁哄懓娉涜灃闁告侗鍘鹃敍娑橆渻閵堝懐绠伴柣妤€锕幃锟犲礃椤忓懎鏋戝┑鐘诧工閻楀棛绮堥崼鐔稿弿婵妫楅獮姗€鏌嶉悷鎵㈤柍瑙勫灴閹晠宕ｆ径濠庢П闂備胶枪閿曨亪寮ㄩ柆宥呂﹂柛鏇ㄥ枤閻も偓闂佸湱鍋撻崜姘闁秵鈷戠紒瀣儥閸庢劙鏌熼悷鐗堟悙妞ゆ洩绲剧粋鎺斺偓锛扁偓閸嬫捇寮介褎鏅㈡繛杈剧秬閵嗏偓濠殿喖娲娲偡閺夋寧些闂佺娅曢敃銏ょ嵁婵犲洤鍐€鐟滃寮ㄦ禒瀣厱闁靛鍨哄▍鍡涙煕閹烘挾娲撮柟顔筋殘閹叉挳宕熼鍌ゆФ闂備礁鎽滄慨鐢告偋閻樿违濞达綀鍊介弮鈧幏鍛存偡闁腹鍋撻幘鍓佺＝濞达絽澹婇崕蹇涙煟韫囨梻绠為柣鎾卞灪缁绘繈鎮介棃娴躲儵鏌℃担鍛婂暈闁逛究鍔戦幃婊堟寠婢跺鈧剟姊洪崨濠勨槈闁挎洏鍎靛畷锝堢疀濞戞瑧鍘告繝銏ｆ硾椤戝懎鈻撻鐣岀鐎瑰壊鍠曠花濂告煛閸涱喚绠為柡灞剧〒娴狅箓鎮欓鍌涱吇闂備礁鎲￠敃銏＄鐠轰警娼栨繛宸簼閸嬶繝姊洪銊х暠婵炲牐鍩栫换婵嗏枔閸喗鐏撻梺杞版祰椤曆囨偩闁垮顕遍柡澶嬪灩閻も偓闂備胶绮〃鍛存偋韫囨稑鍌ㄩ柦妯侯槴閺€浠嬪箳閹惰棄纾归柟鐗堟緲绾惧鏌熼崜褏甯涢柣鎾跺枑娣囧﹪濡堕崒姘婵犵妲呴崑鍛矙閹捐绀嗛柟鐑橆殢閺佸洭鏌曡箛鏇炐ユい鏂匡躬濮婃椽宕烽鐐扮紦闂佸憡鏌ㄩ柊锝夌嵁婵犲洤绠绘慨鐟版搐娴滃吋绻涢弶鎴濇倯婵炲吋鐟╅幃鐐哄垂椤愮姳绨婚梺鍦劋閸ㄧ敻顢旈埡鍐／妞ゆ挻绋戞禍楣冩⒒閸屾瑦绁版い顐㈩樀瀹曟洟鎮￠獮顒佺洴瀹曠喖顢涘☉妯煎絽闂備胶绮弻銊╁箺濠婂懐涓嶅Δ锝呭暞閻撴瑩鎮楀☉娆樼劷闁瑰啿鍟撮弻锝堢疀閿濆嫰鍋楅梺鍝勬湰缁嬫捇鍩€椤掑﹦绉甸柛瀣閹便劌顓兼径瀣幐閻庡厜鍋撻柍褜鍓熷畷浼村箛閻楀牊娅栭梺褰掑亰閸樿姤鍒婇幘顔界厱婵犻潧妫楅鈺傘亜椤掆偓椤﹂潧顫忕紒妯诲濡炲绨肩憰鍡欑磽娴ｈ棄绱︾紒顔界懇楠炲啴濡烽埡鍌氫簵闁瑰吋鎯岄崰妤冪礊鎼淬劍鈷戠紓浣姑悘锕傛煥濮橆厹浜滈柡鍥风節閸濊櫣绱掔紒妯兼创鐎规洖宕灒闁惧繘鈧稒顢橀梻鍌欒兌鏋柣鐕佷邯瀹曞爼濡搁姀鈥愁伖缂傚倸鍊风粈渚€顢栭崼婵冩灃闁哄洨濮锋稉宥夋煛鐏炶鍔滈柣鎾卞劜閹便劌顫滈崱妤€绠叉繛瀛樼矋缁捇寮婚敓鐘茬倞闁哄牏鏁搁弫鏍磽娴ｅ壊鍎撶€规洜鏁稿Σ鎰板箳閺冨倻锛滃┑鈽嗗灥閸嬫劙鎮鹃棃娑辨富闁靛牆楠告禍婵堢磼鐠囪尙澧﹂柕鍡曠窔瀵粙顢橀悙闈涘箣闂備礁澹婇悡鍫ュ窗閺嶎叏缍栭柛銉墯閳锋垿鏌涘┑鍡楊伂妞ゎ偓绠撻弻娑㈠籍閳ь剟宕归悽鍓叉晪闁挎繂顦介弫瀣煃瑜滈崜鐔风暦濞差亜鐒垫い鎺嶉檷娴滄粓鏌熼悜妯虹仴妞ゅ繆鏅濋惀顏堝箚瑜庨崑銉╂煛瀹€鈧崰鏍х暦濠婂嫭濯撮悷娆忓瑜把囨煟鎼淬値娼愰柟鍝ュ厴閹虫宕奸弴鐐靛姦濡炪倖宸婚崑鎾剁磼閻樿尙效鐎规洘娲熼弻鍡楃暤閵夈儲澶勯悗闈涖偢瀵爼骞嬮悩鎻掔疄闂傚倷鑳堕、濠囧箵椤忓牊鈷旈柛鏇ㄥ灡閸嬪倿鏌￠崶鈺佹灁缂佲檧鍋撻梻鍌氬€搁悧濠勭矙閹烘澶娾堪閸曗晙绨婚棅顐㈡处閹搁箖骞楅悩鐫酣宕惰闊剛鈧娲╃徊鎯ь嚗閸曨厸鍋撻敐搴濈按闁稿鎹囬獮鍥偋閸垹骞愰柣搴″帨閸嬫捇鎮楅敐搴″闁糕晛鐭傞弻褏绱掑Ο鐓庘拰闂佸搫鑻粔鐑铰ㄦ笟鈧弻娑㈠箻鐎靛憡鍣梺璇茬箰椤戝懘鍩為幋锔藉€烽柛娆忣樈濡繝姊洪悷鐗堝暈闁诡喖鍊块獮鍐箰鎼存稑浜濋梺鍛婂姀閺呮繈宕㈡ィ鍐┾拺闁告稑锕︾紓姘舵煕鎼淬垻鍙€鐎殿喗濞婇崺锟犲磼濡湱鐩庨梻浣稿暱閹碱偊宕锕€鍌ㄩ柟缁㈠枟閻撴瑦銇勯弮鍌滄憘婵炲牊绮撻弻鈩冩媴閻熸澘顫嶉梺璇″灡濡啴宕规ィ鍐╁殤妞ゆ帒鍊归弲銊モ攽閻樺灚鏆╅柛瀣洴椤㈡岸顢橀悢绋垮伎闂佸湱铏庨崰鏍ф纯闂備礁缍婂Λ璺ㄧ矆娓氣偓閹锋垿鎮㈤崗鑲╁帗闂佸疇妗ㄧ粈渚€寮冲▎鎴犵＜闁告挷绀佹禒婊堟煃鐟欏嫬鐏撮柟顔规櫊楠炴捇骞掑┑鍛亝濠碉紕鍋戦崐褏寰婃禒瀣亯闁绘挸瀵掑鏍ㄧ箾瀹割喕绨荤€瑰憡绻傞埞鎴︽偐閹绘帗娈堕梺鍛婄懃濡稓妲愰幘瀛樺闁告挸寮舵闂備胶顢婂▍鏇㈠箲閸ヮ剙绠栧Δ锝呭暞閸婂鏌ら幁鎺戝姕婵炲懏绮撳娲礈閹绘帊绨撮梺鎼炲妼椤嘲顕ｉ崜浣虹煓閹煎瓨鎸婚弬鈧梻浣虹帛閸旀牕顭囧▎鎾村€堕柨鏇炲€归悡鐔兼煟閺冣偓濞兼瑩宕濆⿰鍛＜闁稿本绋戝ù顔姐亜閵忊槄鑰块柟顔界懇閸╋繝宕掑☉娆愮帆闂傚倸鍊烽懗鍓佸垝椤栫偛绀夐柡鍥╁剱閸ゆ洟鏌涢锝嗙』濠㈣泛艌閸亪鏌涘☉鍗炵仯闁挎稒绮庣槐鎾诲磼濞嗘垵濡介梺鎸庤壘閳规垿顢欓懖鈹綁鏌曢崶褍顏┑顔瑰亾闂佹枼鏅涢崰姘涢崘顭戞富闁靛牆鍟悘顏呯箾閼碱剙鏋涚€殿噮鍋婂畷鎺楁倷閺夋垳鎮ｉ梺璇茬箳閸嬬姴螞閸曨厾涓嶉柣鎰ゴ閺€浠嬫煟濡櫣浠涢柡鍡忔櫊閺屾稓鈧綆鍋嗛埥澶愭懚閻愮繝绻嗛柕鍫濇噺閸ｆ椽鏌涢妶鍡楀闁靛洤瀚板浠嬪Ω瑜嬮埀顒佸笚閵囧嫰鍩￠崒姘辩シ闁剧粯鐗犻弻銊モ攽閸℃ê娅ｉ梺鍝勬閸嬨倝寮诲澶嬬叆閻庯綆浜濈拠鐐烘⒑閸濆嫭婀扮紒瀣尰缁傛帡鏁冮崒姘鳖槶閻熸粌閰ｅ畷鎶筋敊绾拌鲸瀵岄梺闈涚墕缁绘顢橀搹鍦＜闁绘ǹ娅曞畷宀€鈧鍠栭…鐑藉箖閵忋倕浼犻柛鏇ㄥ墰閳ь剚濞婂娲川婵犲孩鐣奸梺绋款儐閿曘垹鐣烽悧鍫㈢瘈闁搞儯鍔夐幏娲煟閻樺弶绀岄柍褜鍓欑壕顓熺閳哄懏鈷戦柛婵嗗婢ч亶鏌涢幘瀵告噰妞ゃ垺宀告俊鐑藉煛娴ｄ警妲规俊鐐€栭崝鎴﹀磹閺嵮€鏋旈柡鍥ュ灪閳锋垿姊洪銈呬粶闁兼椿鍨遍弲鍫曞箥椤斿墽锛滃銈嗘閸嬫劖鏅跺☉姘辩＜缂備焦顭囩粻鐐碘偓瑙勬礃閸ㄥ潡銆佸☉姗嗘僵閺夊牃鏁╅妸鈺傗拺閺夌偞澹嗛崝宥夋煕閺冣偓閻熴儵鎮鹃悜钘壩╅柍鍝勶攻閺咃綁鎮峰⿰鍐弰閽樼喖鏌熸潏楣冩闁抽攱甯掗湁闁挎繂鐗滃鎰版煕鐎ｎ剙鈻堥柡灞剧⊕缁绘繈宕橀鍕ㄥ悅闂佺粯鎸堕崐鏍箞閵娿儺娓婚悹鍥紦婢规洖鈹戦悩娈挎殰缂佽鲸娲熷顐ゆ嫚閼碱剚娈鹃梺缁樻⒒閳峰牓寮鍡樺弿婵妫楁晶顔剧磼娓氬洤鏋熺紒缁樼箓椤曘儵鏌ㄧ€ｎ偆鍑￠梺閫炲苯澧柛鏃€鐟ラ悾鐑藉箣閿曗偓缁犲鎮洪幒宥堝厡闁硅櫕鎹囬妶顏呭閺夋垿鍞堕梺闈涚箞閸ㄥ搫袙閸ヮ剚鈷掑ù锝囩摂閸ゅ啴鏌涢悩鎰佹疁闁靛棗鍟村畷濂稿Ψ閵壯呮瀫闂備礁婀遍搹搴ㄥ窗閺嶎偆鐭嗛悗锝庡亖娴滄粓鏌熼悜妯虹仴濞存粎鍋炴穱濠囩叓椤撶偛绁┑顔硷工閹碱偅鏅ラ梺鎼炲劀閸涱厼肖闂傚倷鐒﹂幃鍫曞礉韫囨梻顩叉い鎺戝閺嬩焦銇勯弴妤€浜鹃梺杞扮劍閹瑰洭骞冮埡鍛優妞ゆ劧绲胯ぐ鎼佹⒒閸屾瑨鍏岀紒顕呭灦瀹曟繈寮介銈囩劸闂佸湱铏庨崰鏍磼閳轰急褰掓偐瀹割喖鍓遍梺绋匡功閺佸寮婚妸銉㈡斀闁糕剝锚濞呇勭箾鐎电ǹ校闁烩晩鍨跺濠氭晸閻樻彃绐涘銈嗙墬閻喖危閹扮増鈷戦柛婵嗗閻掕法绱撳鍕獢妤犵偛鍟撮崺锟犲川椤撶媭妲梻浣告啞缁嬫帒顭垮鈧幃鐐寸節濮橆厸鎷绘繛杈剧到閹诧繝宕悙鐑樼厸閻忕偠顕ф慨鍌炴煙椤栨凹妯€闁硅櫕鐗犻崺鈩冩媴閸濄儰鍠婂┑锛勫亼閸婃牠骞愰崼鏇炲瀭婵炲樊浜滈悿鐐亜閹烘垵顏柣鎾存礋閺岋繝宕堕妷銉ヮ瀳濡ょ姷鍋為敃銏ゅ蓟閵娿儮妲堟繛鍡樺灩閻ゅ嫬鈹戦纭烽練婵炲拑绲块崚鎺戔枎閹惧磭顔囬柟鍏肩暘閸ㄨ櫣鈧碍濞婂缁樻媴閸濆嫬浠樼紓鍌氱Т閿曪妇鍒掓繝姘唨妞ゆ挾鍋炲Σ顒勬⒑闁偛鑻晶顖炴煏閸パ冾伃妤犵偞甯掗濂稿炊瑜嶉‖澶愭⒒娴ｅ懙褰掓晝閵夆晛绀夋俊銈呮噹閻掑灚銇勯幒鎴濇灓婵炲吋鍔栫换娑㈠矗婢舵稖鈧法鈧娲樼换鍌炲煝鎼淬劌绠荤€规洖娲ㄩ弳顐ｇ節閻㈤潧孝闁挎洏鍊濋幃褎绻濋崶褍鎯為悗骞垮劚椤︿即鎮¤箛鎿冪唵閻犻缚娅ｆ晶鏇㈡煕閺冣偓缁捇寮婚敐澶嬫櫜濠㈣泛顦伴崰姘攽椤旂》鍔熺紒顕呭灦楠炲繘宕ㄧ€涙ê鐧勬繝銏ｆ硾椤︿即鎯堣箛娑欌拺闁告繂瀚烽崕娑樏瑰⿰搴濋偗鐎殿喖顭烽弫鎰板醇閵忋垺婢戦梻浣告惈閸婃悂鎮樺┑瀣闁汇垹鎲￠崐鐢告偡濞嗗繐顏紒宀冩硶缁辨挸顓兼担闀愬缂傚倸鍊烽懗鑸垫叏閻㈢數鐭欓柟杈剧畱閻撯€愁熆鐠哄彿鍫ュ几鎼淬劍鐓欓悗娑欘焽缁犳挾绱掗悩闈涱暭缂佺粯绻堥幃浠嬫濞村墎鍋ら弻娑㈠Ω瑜嶇敮鍫曟煃缂佹ɑ鐓ラ柍钘夘樀婵偓闁冲搫鍊瑰▍鍫ユ⒒娴ｅ憡鍟炵紒瀣灴閹椽濡搁埡浣猴紮闂佸壊鐓堥崯锝夊籍閸喐娅滈梺鍛婁緱閸樿棄鈻撻弻銉︹拺缂備焦蓱鐏忕増绻涢懠顒€鏋涚€殿喖顭峰鎾閻樿鏁规繝鐢靛█濞佳兠归崒姣兼盯鏁嶉崟顓狅紳婵炶揪绲捐ぐ鍐╃妤ｅ啯鐓熼幖鎼灣缁夌敻鏌涢悩鎰佹疁闁诡喒鈧枼妲堥柕蹇娾偓鏂ュ亾閸洘鐓熼柟閭﹀幖缁插鏌嶉柨瀣拹缂佺粯鐩獮鎾诲箳閺冣偓閹插ジ姊洪棃娑欐悙閻庢氨澧楅幈銊╁焵椤掑嫭鐓冮柍杞扮閺嗙喐銇勯敂鍨祮婵﹦鍎ゅ顏堝箥椤旂厧顬夐梻浣告啞濮婂綊鎮烽妷鈺傚仼闁绘垼妫勭涵鈧梺缁樺姀閺呮粓鎮楃拠娴嬫斀闁宠棄妫楅悘鈥趁瑰⿰鍡樼【妞ゎ偅绻堥、姗€鎮╅悽鍨潓缂傚倷绀佹晶鑺ユ櫠濡ゅ懏鏅┑鐘媰閸愩劎楠囬梺闈涙搐鐎氱増淇婇幖浣肝ㄩ柨鏇楀亾婵炲牊顨呰灃闁绘﹢娼ф禒婊堟煥閺囨ê鈧盯鎮橀幒鎾剁闁圭偓娼欓崵顒勬煕閵娿劋鍚紒杈╁仦閹棃鍩﹂埀顒勫绩娴犲鐓熼柟閭﹀墮缁狙囨煃缂佹ɑ绀€闂囧绻濇繝鍌氼伀闁活厼锕ラ妵鍕棘鐠恒劎顔囬梺瀹狀潐閸ㄥ灝鐣锋潏顐ょ杸闁哄啠鍋撻柡澶嬫倐濮婄粯鎷呴搹鐟扮闁藉啳浜幉鎼佸级閸喗娈婚悗娈垮枛閸熷潡鍩㈡惔銊ョ疀闁宠　鍋撶紒銊ヮ煼濮婃椽骞愭惔銏╂⒖濡炪値鍋勯ˇ顖炲煝瀹ュ棛绡€闁告劏鏅涘鎸庣節閻㈤潧孝闁哥噥鍨舵俊闈涒攽閸ヨ埖顔旈梺缁樺姇椤曨厽鏅堕悽鍛婄厵妞ゆ梻鏅幊鍥殽閻愬瓨宕屾鐐村笒閳规垿宕煎顑垮闂佸搫顦伴崹鐔煎绩娴犲鐓熸慨妤€妫楅弸娑㈡煟韫囷絽娅嶉柡宀€鍠栭幖褰掝敃閿濆懐顣查梺鎹愬吹閸嬬偟鎹㈠┑瀣棃婵炴垵宕崜鎵磽娴ｅ搫校闁绘顨婃俊鐢稿礋椤栨艾宓嗗┑掳鍊愰崑鎾趁瑰⿰鍕姢閾绘牠鏌ｅ鈧褎绂掑⿰鍕箚妞ゆ劧绲块惌鎺斿姬閹剧偨鈧帒顫濋敐鍛闂備礁鎼張顒傜矙閹达讣缍栨繝闈涱儛閺佸棗顭跨捄鐚村伐濠㈢懓鐗婃穱濠囨倷椤忓嫧鍋撻妶澶婄煑闁逞屽墯缁绘稒寰勭€ｎ偆顦板Δ鐘靛仦閸ㄥ灝鐣烽悢纰辨晢闁稿本绮嶉崵灞句繆閻愵亜鈧牠鎮уΔ鍛殞闁绘劦鍓涢悵鍫曟倵閿濆骸鏋熼柍閿嬪笒闇夐柨婵嗘噺閸熺偤鏌涢悢鍝勪槐闁哄被鍔戝鏉懳熼搹閫涚棯缂傚倷绀侀崐鍝ョ矓閸洖绠查柛鏇ㄥ墰閻熻銇勯弽銊с€掔紒瀣╃劍缁绘繈鎮介棃娑楃捕濠碘槅鍨伴敃銉х矉瀹ュ應鏀介悗锝呴椤﹂潧鐣锋總鍛婂亜闁惧繗顕栭崯搴ㄦ⒒娴ｄ警鏀伴柟娲讳簽缁辩偞绗熼埀顒€鐣烽鈷氭椽顢旈崟顒傗偓顒勬⒑閸撴彃浜栭柛搴㈢叀閸╂盯骞掗幊銊ョ秺閺佹劙宕奸锝囩Х闂備胶枪椤戝洦绻涢埀顒勬煛鐏炲墽娲寸€殿噮鍓熷畷绋课旈埀顒€顕ｆ导瀛樺€垫繛鍫濈仢濞呮﹢鏌涚€ｎ亝顥㈡鐐茬箻閹晝绱掑Ο鐑橆吇婵＄偑鍊栫敮濠囨倿閿曞偆鏁婇柡鍥╁枍缁诲棝鏌ｉ幇鍏哥盎闁逞屽墯閻楃娀骞冭楗即宕煎┑鍫吹闂備礁婀辨晶妤€顭垮鈧鍛婃媴鐞涒€充壕妤犵偛鐏濋崝姘亜閿斿灝宓嗛柟顕嗙節閹垽宕楅懖鈺佸箥闂傚倷绶￠崣蹇曠不閹达附鍊堕柣妯肩帛閻撶喖鏌曟繝蹇涙闁靛洦绻堥弻锛勪沪鐠囨彃顬堥梺瀹犳椤︻垶锝炲┑瀣垫晢濞达綀銆€閸嬫挾鎷犲顔藉瘜闂侀潧鐗嗙花鑲╄姳婵犳碍鐓曢柣鏃堫棑閹界姴菐閸パ嶈含鐎规洖銈稿鎾倷閼碱剛宕哄┑锛勫亼閸婃牠鎮уΔ鍐ㄥ灊闁绘ǹ顕ч懜褰掓煠閸濄儲鏆╃紒鈾€鍋撶紓浣稿⒔婢ф鎽銈庡亜閿曨亪寮诲☉姘ｅ亾閿濆簼绨奸柛锝囨櫕缁辨帡顢欓悾灞惧櫚濡ょ姷鍋為…鍥焵椤掑嫭娑ч柟鑺ョ矎閵囨劖銈ｉ崘鈹炬嫼闂佸憡绻傜€氼厼顔忓┑瀣厱闁绘ǹ娅曞畷宀勬煏閸℃鍤囬柟顔界矒閹崇偤濡烽妷銏犱壕闁汇垹鎲￠悡銉︾節闂堟稒顥㈡い搴㈩殔闇夋繝濠傛噹娴犻亶鏌＄仦鍓р槈妞ゎ偅绮撻崺鈧い鎺嶈兌椤╂煡鏌涢锝嗙闁藉啰鍠栭弻銊モ攽閸℃瑥鈪遍梺姹囧€愰崑鎾绘⒒娴ｅ憡鎯堟繛灞傚姂瀹曟垵螣閻撳骸鐏婇梺鐓庢憸閺佸摜寮ч埀顒勬⒑閸愯尙娈遍柛瀣崌閺屾稓浠﹂崜褏鐓傞梺缁樻尰閹告瓕鐏冮梺缁橈耿濞佳勭濠婂牊鐓ラ柡鍥ュ妺缁ㄥ鏌ｉ敐鍥у幋濠碘剝鎮傞崺鈩冪節閸愨晜鐝﹂梻浣告惈椤﹂亶宕戦悙瀵哥彾闁糕剝绋掗崕搴ㄥ箹濞ｎ剙濡介柍閿嬪笒闇夐柨婵嗘处閸も偓濡炪倖娲樼划鎾诲蓟閿涘嫪娌悹鍥ㄥ絻椤洦绻濈喊妯峰亾閸愬樊鏆㈢紓渚囧枟閻熴儵鍩㈡惔銊ョ鐟滃宕戦幘缁樺殝闁绘劙鈧稓鐩庨梻浣告惈濞诧箓銆冮崨顔绢洸濡わ絽鍟埛鎴︽煕濠靛棗顏繝鈧悧鍫㈢闁肩⒈鍓欓弸搴ㄦ煟閿濆洤鍘存鐐叉閺屽洭鏁傞崣顐熸櫆娣囧﹪鎮欓鍕ㄥ亾閺囩伝鐟邦潩鐠鸿櫣顦┑顔角瑰▔娑欘攰闂備礁鎲″ú锕傚垂闁秴鐤炬繝濠傜墛閸嬶綁鏌涢妷鎴濆暟妤犲洭姊虹紒妯肩畺缂佽鐗嗛～蹇撁洪鍕炊闂佸憡娲﹂崜姘跺箯鏉堚晝纾藉ù锝呭閸庢劙鏌熼悷鐗堝枠鐎规洘妞介崺鈧い鎺嶉檷娴滄粓鏌熼悜妯虹厐闁告梻鍠撶槐鎺撳緞鐏炵偓姣堥梺鍝勬湰缁嬫捇鍩€椤掑﹦绉靛ù婊勭箞瀹曞疇銇愰幒鎾跺幗闂佹寧绻傞ˇ钘壩涢幋婢濆綊鎮崨顖滄殼闂佽鍠楅悷鈺呫€佸Δ鍛劦妞ゆ巻鍋撴い鏇秮楠炴劖鎯旈敐鍥╂闂備焦鐪归崹钘夘焽瑜嶉悺顓㈡⒒娴ｅ憡鎲搁柛锝冨劦瀹曞綊鎳滈崗鍝ョ畾闂傚倸鐗婄粙鍫ュ绩娴犲鍊甸柨婵嗛娴滅偤鏌涘鈧褔鈥旈崘顔嘉ч柛鈩兦氶幏褰掓⒑缁嬪灝顒㈠┑鐐诧工閻ｇ兘濮€閳垛晛浜鹃柣銏㈡暩閵嗗﹪鏌涚€ｎ偅灏柍缁樻崌瀹曞綊顢欓悾灞奸偗闂傚倷鑳剁划顖炴偋閺囥垹围闁归棿鐒﹂崑妯汇亜閺囨浜惧Δ鐘靛仜濞差參銆佸鈧幃銏犵暋閺夎銈呪攽閿涘嫬浜奸柛濠冪墵瀵濡搁埡浣叫曢柣搴秵閸犳牕效閺屻儳鍙撻柛銉ｅ妿閳洟鏌嶉柨瀣诞闁哄本绋撴禒锕傚箲閹邦剦妫熼梻渚€鈧偛鑻晶浼存煕韫囨棑鑰挎鐐诧工铻栭柛娑卞弮閸炲爼姊洪崫鍕窛闁稿鍠栭幃鍧楀炊椤掍讲鎷洪柣鐔哥懃鐎氼剛绮堥崘鈹夸簻闁哄洤妫楀ú銈囨喆閿旂偓鍠愰柣妤€鐗嗙粭姘舵煟閹惧銆掗柍褜鍓欑粻宥夊磿鏉堫煈娈介柟闂磋兌瀹撲線鏌″搴′簽缁炬儳銈搁弻锝呪枎鐏炴垝澹曢梻浣规偠閸斿矂鎮ラ悡搴殨濠电姵鑹炬儫闂佸啿鎼崐鍛婄閻愮儤鈷戠紒瀣濠€鎵磼鐎ｎ偄鐏存い銏℃閺佹捇鏁撻敓锟�
    u32_t carry;
    int val;

    S = data&0x80000000 ?  -1 : 1;
    E = ((data>>23) & 0xFF) - 127;
    F = data &0x7FFFFF;
    
   
    for (val = F, carry = 1; val > 0; val /= 10 )
    {
        carry *= 10;
    }

    if (E >= 0 && E < 32)
    {
        val = (F + carry)/((carry/10)>>E);
        val = (val+5)/10;
    }
    else if (E == -1)
    {
        val = (F + carry)/(carry/5);
        val = (val+5)/10;
    }
    else
    {
        val = 0;
    }

    return val*S;
#elif  1 //闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁炬儳缍婇弻鐔兼⒒鐎靛壊妲紒鐐劤缂嶅﹪寮婚悢鍏尖拻閻庨潧澹婂Σ顔剧磼閻愵剙鍔ょ紓宥咃躬瀵鎮㈤崗灏栨嫽闁诲酣娼ф竟濠偽ｉ鍓х＜闁绘劦鍓欓崝銈囩磽瀹ュ拑韬€殿喖顭烽幃銏ゅ礂鐏忔牗瀚介梺璇查叄濞佳勭珶婵犲伣锝夘敊閸撗咃紲闂佺粯鍔﹂崜娆撳礉閵堝洨纾界€广儱鎷戦煬顒傗偓娈垮枛椤兘骞冮姀銈呯閻忓繑鐗楃€氫粙姊虹拠鏌ュ弰婵炰匠鍕彾濠电姴浼ｉ敐澶樻晩闁告挆鍜冪床闂備胶绮崝锕傚礈濞嗘挸绀夐柕鍫濇川绾剧晫鈧箍鍎遍幏鎴︾叕椤掑倵鍋撳▓鍨灈妞ゎ厾鍏橀獮鍐閵堝懐顦ч柣蹇撶箲閻楁鈧矮绮欏铏规嫚閺屻儱寮板┑鐐板尃閸曨厾褰炬繝鐢靛Т娴硷綁鏁愭径妯绘櫓闂佸憡鎸嗛崪鍐簥闂傚倷娴囬鏍垂鎼淬劌绀冮柨婵嗘閻﹂亶姊婚崒娆掑厡妞ゃ垹锕ら埢宥夊即閵忕姷顔夐梺鎼炲労閸撴瑩鎮橀幎鑺ョ厸闁告劑鍔庢晶鏇犵磼閳ь剟宕橀埞澶哥盎闂婎偄娲ゅù鐑剿囬敃鈧湁婵犲﹤鐗忛悾娲煛鐏炶濡奸柍瑙勫灴瀹曞崬鈻庤箛鎾寸槗缂傚倸鍊烽梽宥夊礉瀹€鍕ч柟闂寸閽冪喖鏌ｉ弬鍨倯闁稿骸鐭傞弻娑樷攽閸曨偄濮㈤悶姘剧畵濮婄粯鎷呴崨濠冨創闂佹椿鍘奸ˇ杈╂閻愬鐟归柍褜鍓熸俊瀛樻媴閸撳弶寤洪梺閫炲苯澧存鐐插暙閳诲酣骞樺畷鍥跺晣婵＄偑鍊栭幐楣冨闯閵夈儙娑滎樄婵﹤顭峰畷鎺戔枎閹寸姷宕叉繝鐢靛仒閸栫娀宕楅悙顒傗槈闁宠閰ｉ獮瀣倷鐎涙﹩鍞堕梻鍌欑濠€閬嶅磿閵堝鈧啴骞囬鍓ь槸闂佸搫绉查崝搴ｅ姬閳ь剟姊婚崒姘卞濞撴碍顨婂畷鏇㈠箛閻楀牏鍘搁梺鍛婁緱閸犳岸宕ｉ埀顒勬⒑閸濆嫭婀扮紒瀣灴閸┿儲寰勯幇顒傤攨闂佺粯鍔曞Ο濠傤焽缂佹ü绻嗛柣鎰典簻閳ь剚鍨垮畷鏇㈠蓟閵夛箑娈炴俊銈忕到閸燁偊鎮″鈧弻鐔衡偓鐢登规禒婊呯磼閻橀潧鈻堟慨濠呮缁瑩宕犻埄鍐╂毎婵＄偑鍊戦崝灞轿涘┑瀣祦闁割偁鍎辨儫闂佸啿鎼崐鎼佸焵椤掆偓椤兘寮婚敃鈧灒濞撴凹鍨辨闂備焦瀵х粙鎺楁儎椤栨凹娼栭柧蹇撴贡绾惧吋淇婇姘儓妞ゎ偄閰ｅ铏圭矙鐠恒劍妲€闂佺ǹ锕ョ换鍌炴偩閻戣棄绠ｉ柣姗嗗亜娴滈箖鏌ㄥ┑鍡涱€楅柡瀣枛閺岋綁骞樼捄鐑樼€炬繛锝呮搐閿曨亪銆佸☉妯锋斀闁糕剝顨嗛崕顏呯節閻㈤潧袥闁稿鎸搁湁闁绘ê妯婇崕鎰版煟閹惧啿鏆熼柟鑼归オ浼村醇濠靛牜妲繝鐢靛仦閸ㄥ墎鍠婂澶樻晝闁兼亽鍎查崣蹇旀叏濡も偓濡鏅舵繝姘厱闁靛牆妫欑粈瀣煛瀹€鈧崰鎾舵閹烘顫呴柣妯虹－娴滎亝淇婇悙顏勨偓銈夊磻閸曨垰绠犳慨妞诲亾鐎殿喛顕ч鍏煎緞婵犲嫬骞愬┑鐐舵彧缁蹭粙骞夐垾鏂ユ灁闁哄被鍎查埛鎴犵磽娴ｈ鐒界紒鐘崇墵閺岋絽螖閸愩剱銏°亜椤愩垻绠崇紒杈ㄥ笒铻ｉ柤娴嬫櫆閸ゅ矂姊绘笟鈧埀顒傚仜閼活垱鏅堕幘顔界厱闁宠鍎虫禍鐐繆閻愵亜鈧牜鏁幒妤€纾归柛娑橈功椤╅攱绻濇繝鍌滃闁绘挾濮电换娑㈡嚑妫版繂娈梺璇查獜缁绘繈寮婚敓鐘插窛妞ゆ挾濮撮悡鐔兼倵濞堝灝鏋︽繛澶嬬洴閸┿垺鎯旈妸銉ь槶閻熸粌绉瑰顐﹀箹娴ｅ厜鎷洪梺鐓庮潟閸婃洟寮搁幋锔界厽闁绘梹娼欓崝銈夋煃瑜滈崜姘跺礄瑜版帒鍌ㄩ柛鎾楀啫鐏婇梺鍓插亐閹冲洭宕戦幘缁樻櫜閹肩补鍓濋悘宥夋⒑缂佹ɑ灏伴柣鐕傜畵婵＄敻宕熼姘辩潉闂侀€炲苯澧寸€规洘娲熼獮搴ㄦ寠婢跺﹤浜堕梺璇插缁嬫帡鏁冮埡浣叉灁濞寸姴顑嗛悡鐔兼煙闁箑鐏遍柛銈咁儔閺岋繝鍩€椤掑嫭鍤掗柕鍫濇川閿涙粎绱撻崒娆戝妽妞ゎ厼娲ㄧ划濠氭倷绾版ê浜鹃悷娆忓缁€鍐偨椤栨稑娴柕鍫簼鐎靛ジ寮堕幋婵堢崺闂備礁鎲℃笟妤呭磻閸曨剚鍙忛柛灞剧⊕閸欏繐鈹戦悩鍙夊櫤妞ゅ繒濞€閺岀喐顦版惔鈾€鏋呴梺鎼炲姂缁犳牠骞栬ぐ鎺濇晝闁靛牆瀚悥閬嶆⒒閸屾艾鈧绮堟笟鈧獮鏍敃閿曗偓缁犵娀鐓崶銊р姇闁稿骸瀛╅妵鍕冀椤愵澀鏉梺閫炲苯鍘哥紒鈧笟鈧崺銏℃償閵娿儳顔婇梺鍝勫暙閸婄懓顭块幋鐐电瘈闁汇垽娼ф禒锕傛煕閵娿儱鎮戦柕鍥ㄦ楠炴牗鎷呴崫銉︾叄闂備礁鍟块幖顐﹀箠韫囨稑鐓曢柟瀵稿Х绾捐棄霉閿濆牆浜楅柟瀵稿С閻掑﹥銇勯幘璺衡偓锝夊籍閸喎浜归悗瑙勬礀濞诧箓骞夊▎鎾粹拺閻犲洩灏欑粻鐗堢箾鐏炲倸濡挎俊鍙夊姍楠炴鎷犻懠顒婄床婵犳鍠楅敃鈺呭礂濮椻偓瀹曟垿骞樼拠鑼啇婵炶揪绲介幗婊堟晬濞嗘挻鈷戠憸鐗堝笚閿涚喓绱掗埀顒佹媴閸濆嫷妫滈悷婊呭鐢鎮″▎鎾粹拻闁稿本鍑归崵鐔搞亜閿旂厧顩柣銉邯楠炲棜顦寸紒澶嬫そ閺岋紕浠﹂崜褉妲堥梺瀹狀潐閸ㄥ灝鐣烽悢纰辨晝闁靛繒濮岄幋锔解拻濞达綀顫夐妵鐔兼煕濡湱鐭欐鐐村灴瀹曞爼顢楅埀顒勬嫅閻斿吋鐓ユ繝闈涙－濡插憡銇勯銏″殗闁哄矉绲借灒闁告繂瀚В鎰版⒑閸濆嫭顥滈柣妤佹尭椤繘鎼归崷顓犵厯濠电偛妫欓崕鎶藉礈閺夋娓婚柕鍫濇閻忋儲銇勯敃鍌涙锭妞ゆ洩绲剧换婵嗩潩椤撶喐顏熼梻浣虹帛鏋悘蹇旂懇瀹曟劙鎮欓悜妯锋嫼闂佸湱枪濞撮绮婚幘缈犵箚妞ゆ劧缍嗗▓鏃堟煃鐠囪尙孝妞ゎ偅绻堥幊婊呭枈濡顏归梻鍌氬€风欢锟犲磻閸℃稑纾绘繛鎴欏灪閸ゆ劖銇勯弽銊р姇婵炲懐濞€閺岀喖顢涢崱蹇撲壕闂佽　鍋撳ù鐘差儐閻撳啴鏌曟径鍫濆闁绘繍浜弻娑㈡偐閹存劖鍨块妴鍐Ψ閳哄倸鈧兘鏌℃径瀣仼濞寸厧鐭傞幃妤冩喆閸曨剛顦梺鍝ュУ閻楃娀濡存担绯曟婵☆垳鍋炵敮鐐寸閹间礁鍐€闁靛⿵濡囪ぐ瀣⒒娴ｅ憡鎯堥悶姘煎亰瀹曟繈骞嬪┑鎰闂佸搫顦伴崵锕傚籍閸繄鍔﹀銈嗗笂閼冲爼銆呴弻銉︾厱闁圭偓顨呴幊鎰版晬濠婂牊鈷戦柛娑橈攻鐎垫瑩鏌涢埄鍐夸緵闁逞屽墯椤ㄥ﹤顫忓ú顏勭闁绘劖褰冮～鍛攽閻愬樊妲归柣鈺婂灦閺佹劙鎮欓崜浣烘澑濠电偞鍨堕悷锕傚磿椤忓牊鈷戦梻鍫氭櫅閻︽粓鏌涘鈧粻鏍极瀹ュ應鍫柛鎰剁稻閺傗偓闂備礁鐤囧Λ鍕涘Δ鍛€堕柕澶涘缁犻箖鏌涘⿰鍐ㄦ殶缂佸宕电槐鎺楀磼濞戞ɑ璇炲Δ鐘靛仦閻楁骞忛崨鏉戞嵍妞ゆ挾鍋涚猾宥夋⒒閸屾瑧顦﹂柟璇х節瀹曟繈鏁冮崒姘辩崶闂佸搫娲㈤崹鍦不閻旇偤鏃堟晲閸涱厽娈查梺缁樻尰缁嬫捇鍩€椤掆偓閸樻粓宕戦幘缁樼厓鐟滄粓宕滈悢椋庢殾濞村吋娼欓崘鈧銈嗘尵閸嬬喖鎮鹃崫鍕ㄦ斀闁绘ǹ顕滃銉╂煟濡も偓濡稓鍒掓繝姘櫜濠㈣泛顑囬崢鐢告⒑缂佹ê鐏﹂拑閬嶆倶韫囷絽寮柡宀嬬磿閳ь剨绲婚崝宀勫焵椤掍胶澧遍柟骞垮灩閳规垿宕辫箛鏃備簴闂備礁澹婇悡鍫ュ窗濡ゅ懏鍊堕柛顐犲劜閳锋垿鏌熺粙鍨劉缁剧偓鎮傞弻娑㈠棘鐠恒劎鍔梺绯曟杺閸ㄥ綊顢橀崗鐓庣窞閻庯綆鍋呴悵鎶芥⒒娴ｈ鍋犻柛搴㈢矒瀹曟﹢顢旈崘銊︾€冲┑鐘垫暩婵兘寮幖浣哥；婵炴垶顭傚☉妯锋瀻闁规儳鍟块悗顓㈡煟閻樿崵绱版繛鍜冪秮瀵娊鏁冮埀顒勨€﹂崸妤佸殝闂傚牊绋戦～宥夋⒑缂佹ɑ灏紒缁樺姍閸╃偤骞嬮敂钘夆偓鐑芥煙鐎涙绠撻柡鍡愬灲閹顫濋銏犵ギ闂佸搫澶囬崜婵嬪箯閸涘瓨瀵犲璺侯槹閻繒绱撻崒娆愮グ濡炲瓨鎮傞獮鎴﹀炊瑜忛弳锕傛煙閻戞ê鐒炬繛灏栨櫆閵囧嫰骞嬮敐鍡╂婵炲瓨绮嶉崕鎶解€旈崘顏佸亾閿濆簼绨绘い鎺嬪灪閵囧嫰骞囬鍡欑厯闂佸搫琚崝鎴﹀箖閵忋倕浼犻柛鏇熷灟閸ㄨ崵妲愰幒妤€绠涙い鎾楀嫮鏆﹀┑鐑囩到濞层倝鏁冮鍛箚闁割偅娲栧婵囥亜閺傚灝鎮戞い蹇曞Х缁辨捇宕掑▎鎺戝帯婵犳鍠氶弫濠氬箖閿熺姵鏅搁柣妯垮蔼閹芥洖鈹戦悙鏉戠仧闁搞劎鎳撻弫顕€姊绘担鐑樺殌闁宦板妿閹广垽宕卞▎灞戒壕婵ê宕。鑲╃磼缂佹娲寸€规洜鍘ч埥澶娢熸笟顖溾偓瀵哥磽閸屾瑨鍏岀紒顕呭灣閹广垽宕奸妷銉х暫婵炲濮撮鍡浰夐崼鐔虹缁炬儳顑愰崯鍥╃磽瀹ュ嫮绐旂€殿喖顭锋俊鑸靛緞婵犲啫绁舵俊鐐€栭幐楣冨磻濡崵鐝堕柡鍥ュ灪閳锋垹绱掔€ｎ亞浠㈤柣锔哄姂閺屾稓鈧綆浜峰銉︺亜椤愩垻绠崇紒杈ㄥ笒铻ｉ悹鍥ф▕閳ь剚鎸剧槐鎾存媴閸撴彃鍓遍柣搴ｇ懗閸愬啯甯￠獮鍥偋閸碍瀚奸梻渚€娼荤€靛矂宕㈤幖浣哥闁跨喓濮甸悡鏇㈡倵閿濆簼鎮嶇€规悶鍎甸弻锝夋晲閸パ冨箣濡ょ姷鍋涘ú顓烆嚕閸洖鍨傛い鏂垮⒔瀹曠儤绻濋悽闈浶ラ柡浣告啞閹便劎鈧數纭堕崑鎾愁潩椤掆偓濡插鎮￠妶澶嬬厵闂傚倸顕崝宥夋煃闁垮鐏╃紒杈ㄦ尰閹峰懏鎱ㄩ幋顓濈凹闁逛究鍔嶅鍕箛椤撶姴骞堥梺鍦帶閻°劎绮欓幋锕€鐒垫い鎺嶈兌缁犵偟鈧娲栭幖顐﹀煡婢舵劕顫呴柣妯活問閸氬懘姊绘担铏瑰笡妞ゎ厼娲顐﹀箹娴ｈ娅栧┑鐘诧工閻楀﹪鎮￠悢鐓庣闁圭⒈鍘奸悘锝囩磼婢跺本鏆柡灞剧〒閳ь剨缍嗘禍婊堫敂椤撶喆浜滈柕寰涖倕顥濆Δ妤婁簷閸楀啿鐣烽悢纰辨晣闁绘ê鐏氶～宀勬⒒閸屾瑧绐旈柍褜鍓涢崑娑㈡嚐椤栨稒娅犻悗娑欙供濞堜粙鏌ｉ幇顖氱毢閺佸牆顪冮妶鍐ㄧ仾闁荤啿鏅涢悾宄扳堪閸♀晜顎夌紓鍌欐祰妞存悂鎮￠垾鎰佹綎闁惧繗顫夌€氭岸鏌熺紒妯虹瑨婵絾鍔楃槐鎾诲磼濮樻瘷銏′繆椤愶絿绠撻柣锝囧厴楠炲鏁冮埀顒傜矆鐎ｎ偁浜滈柡宥冨妿閳藉鏌嶈閸撴瑩鎮ユ總绋跨畺婵°倐鍋撻柍钘夘槸閳诲秵娼忛妸褏鐓佺紓浣稿€哥粔鎾偑娴兼潙閱囬柣鏂挎惈鐢箖姊绘繝搴′簻婵炲眰鍊濋弫鍐Χ閸℃ɑ鐝烽梺鍛婄懃椤︻厽绂嶅⿰鍫熺厪濠㈣泛鐗嗛崝銈咁熆瑜濈粻鎾诲蓟閿涘嫪娌紒瀣仢閳峰姊洪悷鏉挎Щ闁硅櫕鍔欓獮澶愬箻椤旇偐顦板銈嗗姂閸娧呮閿曞倹鈷掗柛灞剧懄缁佺増淇婂鐓庡闁诡喚鍋ら弫鍐磼濮橀硸鍞归梻浣规偠閸庢椽宕滃▎鎾冲嚑濞撴埃鍋撻柡宀€鍠栧畷婊嗩槾閻㈩垱鐩弻锟犲川椤旇棄鈧劙鏌＄仦璇插闁诡喓鍊濆畷鎺戔槈濮楀棔绱� 婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柛娑橈攻閸欏繘鏌ｉ幋锝嗩棄闁哄绶氶弻娑樷槈濮楀牊鏁鹃梺鍛婄懃缁绘﹢寮婚敐澶婄闁挎繂妫Λ鍕⒑閸濆嫷鍎庣紒鑸靛哺瀵鈽夊Ο閿嬵潔濠殿喗顨呴悧濠囧极妤ｅ啯鈷戦柛娑橈功閹冲啰绱掔紒姗堣€跨€殿喖顭烽弫鎰緞婵犲嫷鍚呴梻浣瑰缁诲倸螞椤撶倣娑㈠礋椤栨稈鎷洪梺鍛婄箓鐎氱兘宕曟惔锝囩＜闁兼悂娼ч崫铏光偓娈垮枦椤曆囧煡婢跺á鐔兼煥鐎ｅ灚缍屽┑鐘愁問閸犳銆冮崨瀛樺亱濠电姴娲ら弸浣肝旈敐鍛殲闁抽攱鍨块弻娑樷槈濮楀牆濮涢梺鐟板暱閸熸壆妲愰幒鏃傜＜婵鐗愰埀顒冩硶閳ь剚顔栭崰鏍€﹂悜钘夋瀬闁归偊鍘肩欢鐐测攽閻樻彃顏撮柛姘嚇濮婄粯鎷呴悷閭﹀殝缂備浇顕ч崐姝岀亱濡炪倖鎸鹃崐锝呪槈閵忕姷顦板銈嗙墬缁嬪牓骞忓ú顏呪拺闁告稑锕︾粻鎾绘倵濮樺崬鍘寸€规洘娲橀幆鏃堟晲閸モ晪绱查梻浣稿悑閹倸顭囪瀹曨偊鎼归崗澶婁壕婵炲牆鐏濋弸娑欍亜椤撶姴鍘存鐐插暣婵偓闁靛牆鎳愰ˇ褔鏌ｈ箛鎾剁闁绘顨堥埀顒佺煯缁瑥顫忛搹瑙勫珰闁哄被鍎卞鏉库攽閻愭澘灏冮柛鏇ㄥ幘瑜扮偓绻濋悽闈浶㈠ù纭风秮閺佹劖寰勫Ο缁樻珦闂備礁鎲￠幐鍡涘椽閸愵亜绨ラ梻鍌氬€峰ù鍥敋閺嶎厼鍨傞幖娣妼缁€鍐煥濠靛棙顥滈柣锕佷含缁辨捇宕掑顑藉亾妞嬪孩顐介柨鐔哄Т闂傤垱銇勯弴妤€浜鹃悗瑙勬礀缂嶅﹪鐛惔銊﹀癄濠㈣泛鐭堥崬褰掓⒒娓氣偓濞佳呮崲閹烘挻鍙忔い鎾跺€ｉ敐澶婇唶闁靛濡囬崢顏堟椤愩垺澶勬繛鍙夌墪閺嗏晜淇婇悙顏勨偓鏍箰閹间礁绠规い鎰剁畱閻撴﹢鏌熸潏楣冩闁稿﹦鍏橀弻娑樷枎韫囷絾鈻撳┑鈽嗗亞閸嬬喓妲愰幘瀛樺闁惧繒鎳撶粭锟犳煟閵忊晛鐏℃い銊ョ墢閸掓帞鈧綆鍠栫粻鎶芥煙閹冭埞濞存粍绻堝娲川婵犲倸顫呴梺鍝勫€风欢姘剁嵁韫囨稒鎯為柛锔诲幘閿涙繃绻涙潏鍓у埌濠㈢懓锕畷鏇㈠箛椤撴粈绨婚梺鐟邦嚟閸嬬喖骞婇崶鈹惧亾鐟欏嫭绀冩繛鍙夌墵椤㈡﹢宕楅悡搴ｇ獮闁诲函缍嗛崜娆撶嵁閸績鏀介柣妯虹仛閺嗏晛鈹戦鑺ュ唉鐎规洦鍨堕獮宥夘敊閸欍儳鐟濋梻浣虹帛閸旀銆傛禒瀣；闁圭偓鏋奸弸鏃堟煕椤垵鏋熼柣蹇撶墕椤啴濡舵惔鈥崇闂佹悶鍨洪悡锟犮€佸鑸垫櫜濠㈣泛锕﹂鎺戭渻閵堝棙顥嗘俊顐㈠缁傚秴饪伴崼鐔叉嫼闂佽鍨庨崨顖ｅ晥婵＄偑鍊栧ú姗€鎮ч悩鑼殾妞ゆ牗绋掗崕鐔兼煏婵犲繐顩柛妯圭矙濮婅櫣绱掑Ο鑽ゅ弳闂佺濮ょ划鎾诲箚鐏炲墽绡€闁告洦鍘鹃敍婊勭節閵忥絾纭鹃柡鍫墴瀹曠敻鍩€椤掑嫭鈷戝ù鍏肩懅閹ジ鏌涜箛鏃撹€块柕鍡曠閳藉濮€閳ユ枼鍋撴繝姘厱闁斥晛鍙愰幋婵冩瀺闁搞儺鍓氶埛鎺懨归敐鍥ㄥ殌妞ゆ洘绮嶆穱濠囶敃閿涘嫷妲柧鑽ゅ仱閺屾盯寮撮妸銉т哗闂佺粯甯掗悘姘跺Φ閸曨垰绠抽柟瀛樼箖濞堣尙绱掔紒銏犲籍缂佺姵鐗犲璇差吋閸ャ劌鏋傞梺鍛婃处閸嬪棙瀵煎畝鍕拺閻犲洠鈧櫕鐏€闂佸搫鎳愭慨鎾偩閻戣姤鏅查柛鈩冾殘缁愮偞绻濋悽闈浶㈤悗娑掓櫈閳悂姊婚崒姘偓鎼佸磹閻戣姤鍊块柨鏃傛櫕缁犳儳鈹戦悩鍙夋悙缂備讲鏅犲娲敆閳ь剛绮旈幘顔煎瀭闁稿瞼鍋為悡鏇犳喐鎼淬劊鈧啴宕ㄧ€涙ê鐝旈梺缁樻煥閸氬鎮￠悢鍏肩厸闁告劑鍔嶆径鍕亜韫囨洖鈻堥柡宀嬬秮椤㈡﹢鎮㈤悜妯烘珰闂備礁鎼惉濂稿窗閹捐泛鍨濇繛鍡樻尭閸ㄥ倹銇勯弴鐐村櫣濠碉紕鍏橀弻锝嗘償閵堝孩缍堝┑鐐插级閻楁粍绔熼弴銏╂晣闁绘ɑ鍓氬鐔兼⒑鐟欏嫬鍔ら柣掳鍔嶉崚濠囧箻椤旂晫鍘卞┑鐘绘涧濡鎮甸弮鍫熺叆婵犻潧妫Σ褰掓煟閹惧鎳呯紒杈ㄥ笧閳ь剨缍嗛崑鎺楀磿閵夆晜鐓熼柟鎹愭硾鐢爼鏌嶇憴鍕伌闁轰礁绉瑰畷鐔碱敆娴ｅ湱妲楅梺璇叉唉椤煤濠婂牆绐楅柡宥庡幑閳ь兛绀侀埥澶娢熼柨瀣垫綌婵犵數鍋涘Λ娆撳礉濡ゅ嫨浜归柛鈩冪⊕閳锋帒霉閿濆牊顥夐柛姘辨嚀閳规垿顢欓懞銉х▏闁绘挶鍊濋弻宥夊传閸曨偅娈ㄩ梺缁樺笒閿曘儳鎹㈠☉銏犲耿婵☆垰鎼～搴☆渻閵堝倹娅婇柡鈧柆宥呂﹂柛鏇ㄥ灠閸愨偓闂侀潧臎閸涱垰甯撶紓鍌欒兌閸嬫挸鐣峰Ο浣曟盯宕熼姣笺儵鏌熼悜妯虹劸婵炲皷鏅滈妵鍕箳瀹ュ洤濡介梺璇″枟閻熲晛顫忓ú顏勪紶闁告洟娼ч崜杈╃磽娴ｅ壊鍎愰悽顖楀墲娣囧﹪鎮界粙璺槹濡炪倖鐗徊楣冨疾閿濆鈷戠紓浣广€為幋锝冧汗闁告劦鍠氬畵渚€鎮楅敐搴℃灍闁抽攱鍨垮濠氬醇閻旇　濮囧銈冨劜閻熝呮閹烘鐒垫い鎺嶈兌閻熷綊鏌嶈閸撶喎鐣峰ú顏勎ㄩ柨鏇楀亾缂佸墎鍋ら弻鐔兼焽閿曗偓婢х粯绻涢悡搴含婵﹥妞介幃娆撴寠婢跺﹤顫氶梻浣告惈椤戝懘濡剁粙璺ㄦ殾闁硅揪绠戠粻鑽ょ磽娴ｅ顏堝焵椤掆偓椤兘寮婚妶澶婄畳闁圭儤鍨垫慨搴ㄦ⒑闁偛鑻晶浼存煛娴ｅ壊鐓肩€殿喖顭烽弫鎰緞婵犲孩缍傞梻渚€娼х换鍡椢ｉ崨顔绢浄妞ゆ洍鍋撴慨濠冩そ閹筹繝濡堕崨顔句邯闂備胶枪椤戝懘鏁冮鍕殾闁汇垻枪閸楁娊鏌曡箛銉х？闁告鏁诲铏规嫚閳ュ磭浠┑鐘灪鏋い锝呮健濮婄粯鎷呴悷鎵虫灆闂佽　鍋撻弶鍫氭櫆閺嗘粓鏌熼悜姗嗘畷缂佺姵甯″缁樻媴閻熼偊鍤嬬紓浣筋嚙閸婂潡骞冭缁绘繈宕堕懜鍨珕闂備胶绮…鍥╁垝椤栫偛纾婚柕濠忚礋娴滄粓鏌″鍐ㄥ闁靛棙甯￠弻宥夘敍濞戞瑧顦紓浣介哺鐢偟妲愰幒鎳崇喖宕楅悡搴＄仭闂佽姘﹂～澶娒洪埡鍐ㄧ筏闁诡垎灞芥闂佸憡娲﹂崢鍝勨柦椤忓牊鍋℃繛鍡樼懅缁嬪鎮楀顓犲弨婵﹨娅ｉ幏鐘诲矗婢跺﹥鏁俊鐐€ら崑鍕囬婊冨疾婵犳鍠楅妵娑㈠磻閹惧灈鍋撶憴鍕缂佽鍊块崺銏℃償閵堝洨鏉搁梺鍝勬川閸犳劙顢欓弴銏♀拻濞达綀娅ｇ敮娑㈡煕閵娿儳绉洪柟顔芥そ瀵噣宕煎┑鍥┾偓顒勬⒑閹肩偛鍔橀柛鏂挎捣缁粯銈ｉ崘鈺冨幍闁诲海鏁婚弲鑼閹惰姤鐓曢煫鍥ㄨ壘娴滃綊鏌ｅ┑鍡欏煟闁哄矉绻濆畷鍫曞煛娴ｉ攱鐫忛梻浣姐€€閸嬫捇鏌ら幁鎺戝姌濞存粍绮撻弻锟犲礃閵娿儮鍋撴繝姘闁稿瞼鍋為悡鐔兼煙閸濆嫮肖闁活厽鐟╅弻锛勪沪閸撗佲偓鎺楁煃瑜滈崜銊х礊閸℃稑纾婚柛娑卞灟閻掑﹪鏌ｉ姀鐘冲暈闁绘挸鍟伴幉绋库堪閸繄顦┑顔角归崺鏍磻閸曨兙浜滈柟鐑樺灥椤忊晝绱掗悪鈧崹鍫曞蓟閵娾晜鍋嗛柛灞剧☉椤忥拷

    int val;
    float f;

    r_memcpy(&f, &data, sizeof(f));

    val = f + 0.5;

    return val;
#else
    int val;
    float *pF;

    pF = (float *)&data;

    val = *pF + 0.5;

    return val;
#endif
}


/******************************************************************************/


           